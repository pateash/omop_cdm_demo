{
  "metainfo" : {
    "migrationVersions" : {
      "gemBuilderVersion" : "v1"
    },
    "functions" : { },
    "codeGenConfiguration" : {
      "editableConfig" : true,
      "plibVersion" : {
        "mavenVersion" : "8.4.0",
        "pyPiVersion" : "1.9.24"
      }
    },
    "id" : "1",
    "uri" : "pipelines/L4-2_omop531-etl-synthea",
    "pipelineSettingsInfo" : {
      "hasApplication" : false
    },
    "language" : "python",
    "fabricId" : "14560",
    "frontEndLanguage" : "sql",
    "mode" : "batch",
    "udfs" : {
      "language" : "python",
      "udfs" : [ ],
      "functionPackageName" : "nathandemoprophecyioteam.sampleomop.functions",
      "sharedFunctionPackageNames" : [ "prophecy.spark_basic.functions", "prophecy.warehouse.functions" ]
    },
    "udafs" : {
      "language" : "python",
      "code" : ""
    },
    "configuration" : {
      "common" : {
        "type" : "record",
        "fields" : [ {
          "name" : "catalog_name",
          "kind" : {
            "type" : "string",
            "value" : "omop"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "database_name",
          "kind" : {
            "type" : "string",
            "value" : "l1_silver_omop531"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "cteConditionTarget",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "omop"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "database_name",
              "kind" : {
                "type" : "string",
                "value" : "l1_silver_omop531"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "cteConditionEnds",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "omop"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "database_name",
              "kind" : {
                "type" : "string",
                "value" : "l1_silver_omop531"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "cteEndDates1",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "omop"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "database_name",
              "kind" : {
                "type" : "string",
                "value" : "l1_silver_omop531"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "ctePreDrugTarget",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "omop"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "database_name",
              "kind" : {
                "type" : "string",
                "value" : "l1_silver_omop531"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "cteEndDates2",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "omop"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "database_name",
              "kind" : {
                "type" : "string",
                "value" : "l1_silver_omop531"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "cteSubExposureEndDates",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "omop"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "database_name",
              "kind" : {
                "type" : "string",
                "value" : "l1_silver_omop531"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "cteDrugExposureEnds",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "omop"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "database_name",
              "kind" : {
                "type" : "string",
                "value" : "l1_silver_omop531"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "cteSubExposures",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "omop"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "database_name",
              "kind" : {
                "type" : "string",
                "value" : "l1_silver_omop531"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "cteFinalTarget",
          "kind" : {
            "type" : "record",
            "fields" : [ ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "cteDrugEraEnds",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "omop"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "database_name",
              "kind" : {
                "type" : "string",
                "value" : "l1_silver_omop531"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        } ]
      },
      "oldCommon" : {
        "type" : "record",
        "fields" : [ ]
      },
      "fabrics" : { },
      "instances" : { },
      "selected" : "default",
      "nonEditable" : [ ],
      "isSubscribedPipelineWithPipelineConfigs" : false
    },
    "sparkConf" : [ ],
    "hadoopConf" : [ ],
    "codeMode" : "sparse",
    "buildSystem" : "maven",
    "externalDependencies" : [ ],
    "dependentProjectExternalDependencies" : [ {
      "projectUID" : "12654",
      "projectName" : "ProphecySparkBasicsPython",
      "externalDependencies" : [ ]
    }, {
      "projectUID" : "12655",
      "projectName" : "ProphecyWarehousePython",
      "externalDependencies" : [ ]
    } ],
    "isImported" : false,
    "interimMode" : "Full",
    "interimModeEnabled" : true,
    "visualCodeInterimMode" : "Disabled",
    "recordsLimit" : {
      "enabled" : false,
      "value" : 1000
    },
    "topLevelPackage" : "l42_omop531etlsynthea",
    "configurationVersion" : "v2"
  },
  "connections" : [ {
    "id" : "vNFFPVqBX6o8R8tyUFwsb",
    "source" : "W7tQL5TNzxqPieX7runbU$$YO2dYS596Xzd2FdoP2lQv",
    "sourcePort" : "5LlhXxsxfdIlq5qlchnpH$$5UGtrYgzRb3aTPcEm2dGg",
    "target" : "Pg_229JeG7d1q-UxC2zy1$$5xlf3L7Dv5XHPS04AVgcy",
    "targetPort" : "kGcOe1_P0jXDy7CIR-Ozm$$4j5WmhB6RBJt_WY6VN-d_"
  }, {
    "id" : "Enbx04zGocVVVNAZYN0vX",
    "source" : "W7tQL5TNzxqPieX7runbU$$YO2dYS596Xzd2FdoP2lQv",
    "sourcePort" : "5LlhXxsxfdIlq5qlchnpH$$5UGtrYgzRb3aTPcEm2dGg",
    "target" : "QpImT9I3HYF_5aQnr8s8T$$wvjdbHGUDrKU3aQ_KrokM",
    "targetPort" : "S8sR_fxfm980FN-mTjkwv$$QWNvXOyoqaHUkP_cENnS3"
  }, {
    "id" : "l6NhAMNJflus4DBqjW04p",
    "source" : "Pg_229JeG7d1q-UxC2zy1$$5xlf3L7Dv5XHPS04AVgcy",
    "sourcePort" : "7t4Pl6AfTHoul9kGEEI9s$$Bz_TF1etZhMG9ephg43VL",
    "target" : "QpImT9I3HYF_5aQnr8s8T$$wvjdbHGUDrKU3aQ_KrokM",
    "targetPort" : "VdgKPsv_nugbfJV1XmoiY$$nBboNkm6s_kqeK3QJmhut"
  }, {
    "id" : "dVcN3kuxPFGQzU9JcS45_",
    "source" : "QpImT9I3HYF_5aQnr8s8T$$wvjdbHGUDrKU3aQ_KrokM",
    "sourcePort" : "McJS24PjzfagsvAF9ANGp$$Zh_pJPLSSfBm97QXxtvzT",
    "target" : "fj-wDnQi1dXV4dDDEBc4F$$sonfGdwL7nHJwcPnxLvmp",
    "targetPort" : "90PXO3C6es4nKwDbpLPGv$$1KSeJBeoAAtZwk1yjzamR"
  }, {
    "id" : "VqtSoBPBcxoIPp-Qhi12I",
    "source" : "fj-wDnQi1dXV4dDDEBc4F$$sonfGdwL7nHJwcPnxLvmp",
    "sourcePort" : "6DN9pSN0JOfnB7rtHylCS$$mqj241ARhR0cg3UW_3hwn",
    "target" : "_NsKt4YKAswwQNGUUuO7-$$UQiGqUZuqGn2U7FBN-8jU",
    "targetPort" : "iC_6mGoMYZoe2b4xbsS8H$$mbWHweBTpKxBCz8PT5M4A"
  }, {
    "id" : "9FNxssGy5RQRe2jOxpnTq",
    "source" : "_NsKt4YKAswwQNGUUuO7-$$UQiGqUZuqGn2U7FBN-8jU",
    "sourcePort" : "wX57BsWt8LoVgD4ATXT33$$1vw3ilZNxloSCcTgd8_DJ",
    "target" : "lENYIVmO_7u8Xn0ukUPa7$$Wri5yMOZtQ6qDLqUjOnV8",
    "targetPort" : "xTOW_aGy6mC04VPBW1E4p$$Vjmhqlt71XpfxNwBQX2Ub"
  }, {
    "id" : "T6fyPi_EsyHHuHhWGzbCo$$IFTseClihoEw34vZXAgvV",
    "source" : "OIPqW0uKupnbT87uLNtQK$$D-bqT91clu_hnaQ8WTsXH",
    "sourcePort" : "HYYvykla2NBt_SpKijuNc$$ALk9ptp3ie4s5kZV7ZDl2",
    "target" : "lz17ZzxOpvs-i6K6WqX5h$$o7cy13OOq_SDKaJvlfXNJ",
    "targetPort" : "KoWSQ-CPgX7fx25HLXuCB$$ZB02Qn_f4zgv1mXRzt5i3"
  }, {
    "id" : "U1-LUYbDL4EIoEXBnCSCt$$gzXv0jcElyY0nlxNqtFL1",
    "source" : "lz17ZzxOpvs-i6K6WqX5h$$o7cy13OOq_SDKaJvlfXNJ",
    "sourcePort" : "JsphnXK_itqlxTQll5eRU$$mlTbyRgphykghiRzBHTm9",
    "target" : "WVI0LfzUY9bp5AASNXkqv$$2ExnyDXyRxn2O93fXNwYO",
    "targetPort" : "yBIZnBRX1pirm5UzpoxLk$$5dckQcVsjY-HEEtEG8Fxu"
  }, {
    "id" : "vfkrLHMSaYiG2yUCvl8JW",
    "source" : "OIPqW0uKupnbT87uLNtQK$$D-bqT91clu_hnaQ8WTsXH",
    "sourcePort" : "HYYvykla2NBt_SpKijuNc$$ALk9ptp3ie4s5kZV7ZDl2",
    "target" : "WVI0LfzUY9bp5AASNXkqv$$2ExnyDXyRxn2O93fXNwYO",
    "targetPort" : "JfGHSjrPhlfhfFku3PimN$$cnsyT1jxIMwMwcOoynOId"
  }, {
    "id" : "_m9jeiP3fm-ezrcdZoPJ6$$Z5GNLPcu6K2qaq3P5aaiC",
    "source" : "WVI0LfzUY9bp5AASNXkqv$$2ExnyDXyRxn2O93fXNwYO",
    "sourcePort" : "XwoUws3LSBm29xSPbi4fY$$0aFqkvaZkJCjRagbRtzE6",
    "target" : "W9YcCVxRV2wupO8rFkw1c$$ke-1YvjhCzmpz0wkDHvV3",
    "targetPort" : "Z24a34rS_ibUZvy3Lcd--$$EN7Tn-NPtVxqXMjIvBxHK"
  }, {
    "id" : "zg1Bky_R2aPFz-Y8LCjpc$$ZyvvuqFiwh8TBHZmyoJDN",
    "source" : "W9YcCVxRV2wupO8rFkw1c$$ke-1YvjhCzmpz0wkDHvV3",
    "sourcePort" : "JoKlCL-nM6vv5S0KQ4gCp$$_Ufpjo2UEv7nv3p4Rb9RU",
    "target" : "Uo4HQ24BN7us1fntgPsyU$$zzEWp8Nr0PF0_UEpBDdt1",
    "targetPort" : "Br1-_kGI4r6BeO2mXzgYX$$0PS93GgQF3eOPL3SBmUp5"
  }, {
    "id" : "5Fzk9xAqW2WXpN348C2X3$$bt4nQnx0NZNhl4vZYLMmE",
    "source" : "Uo4HQ24BN7us1fntgPsyU$$zzEWp8Nr0PF0_UEpBDdt1",
    "sourcePort" : "wYVCJ4tF9BbYj0IKaiR0g$$c0zDxQ1JVQfXEhB_Uj5zj",
    "target" : "D4nxyD1G7edIkaHGvW7-3$$OxCv1kCSo6vF46H8gxNUx",
    "targetPort" : "zu2mh4GMCAu8D7C1_J-nM$$LCPNrNIApy-zUX7T_BZyW"
  }, {
    "id" : "qVJ_WqJmoToq5ZGvJkVeY",
    "source" : "Uo4HQ24BN7us1fntgPsyU$$zzEWp8Nr0PF0_UEpBDdt1",
    "sourcePort" : "wYVCJ4tF9BbYj0IKaiR0g$$c0zDxQ1JVQfXEhB_Uj5zj",
    "target" : "SWqzXf6stiMchrKt1g2Qz$$GgpbVBwPYbxqciCsZbOe8",
    "targetPort" : "z-FiSeRBVHPezr6f5snEZ$$qy5PrvDmxL72DyL8jW8AP"
  }, {
    "id" : "eLewv3Pw0gLiF6tgRGr01",
    "source" : "D4nxyD1G7edIkaHGvW7-3$$OxCv1kCSo6vF46H8gxNUx",
    "sourcePort" : "3HJV_fTOKnoFx2awl3cCB$$vhIqYTPLsib71HAe8r5HT",
    "target" : "SWqzXf6stiMchrKt1g2Qz$$GgpbVBwPYbxqciCsZbOe8",
    "targetPort" : "dFTkB71yQ13oy63KJfeNv$$Bg-iz1rl5bcT2d6oO7thg"
  }, {
    "id" : "BKWmuIPr8uQxjQ4RVRi1u$$Wl72F0IVs8He7h5r5lNmS",
    "source" : "SWqzXf6stiMchrKt1g2Qz$$GgpbVBwPYbxqciCsZbOe8",
    "sourcePort" : "fRBtTCUFUKD-MqiQOkhJB$$NFn_JyqVlGL94nV2eFWlO",
    "target" : "C7hriH0jlz3C3JD7no_sE$$sqjojOqaED1zxGNDBw42S",
    "targetPort" : "ED77B5IYMVr3GFv9ZHjVU$$EvsMFH_OW-ii0XBtuJAs7"
  }, {
    "id" : "BJP5QEVM3wkEJ36OysB4v",
    "source" : "UDd4eJ2ODFTAkZ6vdVY3o$$tCDTnLQfcRw7TtSqWjlP0",
    "sourcePort" : "V2Txu04kxwgrmKYF4szGV$$HIZw8WaL0z8yHtPrAlWJ6",
    "target" : "g7x1ya3_S50HCAqWxnRu-$$Hn8FafnjmSJXxV5fXzfa1",
    "targetPort" : "X8OSIWCRMY2ihzdOzBrJw$$1Rs9rJe_xXdRr4ScsYiZQ"
  }, {
    "id" : "C1a8hHxLE4txxE-oDdvbd",
    "source" : "C7hriH0jlz3C3JD7no_sE$$sqjojOqaED1zxGNDBw42S",
    "sourcePort" : "aOwj7S_141AFBKNbTJXAK$$ZX4yMrnN1DJCdfVKya28e",
    "target" : "UDd4eJ2ODFTAkZ6vdVY3o$$tCDTnLQfcRw7TtSqWjlP0",
    "targetPort" : "5y7oKYiCP6wQbp1uIPSTQ$$ySWI3fY49DaAD0eYB-cQq"
  } ],
  "processes" : {
    "g7x1ya3_S50HCAqWxnRu-$$Hn8FafnjmSJXxV5fXzfa1" : {
      "id" : "g7x1ya3_S50HCAqWxnRu-$$Hn8FafnjmSJXxV5fXzfa1",
      "component" : "Target",
      "metadata" : {
        "label" : "drug_era",
        "slug" : "drug_era",
        "x" : 260,
        "y" : -300,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "X8OSIWCRMY2ihzdOzBrJw$$1Rs9rJe_xXdRr4ScsYiZQ",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "drug_era_id",
              "type" : "integer",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "person_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_concept_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_era_start_datetime",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_era_end_datetime",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_exposure_count",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "gap_days",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/drug_era"
      }
    },
    "lENYIVmO_7u8Xn0ukUPa7$$Wri5yMOZtQ6qDLqUjOnV8" : {
      "id" : "lENYIVmO_7u8Xn0ukUPa7$$Wri5yMOZtQ6qDLqUjOnV8",
      "component" : "Target",
      "metadata" : {
        "label" : "condition_era",
        "slug" : "condition_era",
        "x" : -440,
        "y" : -680,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "xTOW_aGy6mC04VPBW1E4p$$Vjmhqlt71XpfxNwBQX2Ub",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "condition_era_id",
              "type" : "integer",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "person_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "CONDITION_CONCEPT_ID",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "condition_era_start_datetime",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "condition_era_end_datetime",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "condition_occurrence_count",
              "type" : "long",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/condition_era"
      }
    },
    "W7tQL5TNzxqPieX7runbU$$YO2dYS596Xzd2FdoP2lQv" : {
      "id" : "W7tQL5TNzxqPieX7runbU$$YO2dYS596Xzd2FdoP2lQv",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "cteConditionTarget",
        "slug" : "cteConditionTarget",
        "x" : -1240,
        "y" : -700,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "5LlhXxsxfdIlq5qlchnpH$$5UGtrYgzRb3aTPcEm2dGg",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "packageName" : "cteConditionTarget",
        "externalId" : "subgraphs/cteConditionTarget",
        "name" : "cteConditionTarget"
      },
      "connections" : [ {
        "id" : "VLIJMJz-i_jwzH-ymoAg0",
        "source" : "qTzVZVZCJUsr7n2hXifFo$$x1-icSI11AJwlSn8_q3mA",
        "sourcePort" : "7ymNj-pCtE1b68RIsKfUf$$rO-bKDSJJymVD6EKrZyj_",
        "target" : "Yl5lacjCRrlL0kgXXl-92$$nK40mVzWLM9tdnG3DFvAS",
        "targetPort" : "KXxJH9_VSrN2OlT-3FhpQ$$nNFmZiR7n1QWlhi9nzaZ2"
      }, {
        "id" : "5dj6DLpuPkdQ2tAzTqlLK",
        "source" : "Yl5lacjCRrlL0kgXXl-92$$nK40mVzWLM9tdnG3DFvAS",
        "sourcePort" : "hlmx_ivrJJBKMu60o1QoI$$gJMS_nw_ci3G4TUl5N_4l",
        "target" : "W7tQL5TNzxqPieX7runbU$$YO2dYS596Xzd2FdoP2lQv",
        "targetPort" : "5LlhXxsxfdIlq5qlchnpH$$5UGtrYgzRb3aTPcEm2dGg"
      } ],
      "processes" : {
        "qTzVZVZCJUsr7n2hXifFo$$x1-icSI11AJwlSn8_q3mA" : {
          "id" : "qTzVZVZCJUsr7n2hXifFo$$x1-icSI11AJwlSn8_q3mA",
          "component" : "Source",
          "metadata" : {
            "label" : "condition_occurence_1",
            "slug" : "condition_occurence_1",
            "x" : -240,
            "y" : 1680,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "7ymNj-pCtE1b68RIsKfUf$$rO-bKDSJJymVD6EKrZyj_",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/condition_occurence"
          }
        },
        "Yl5lacjCRrlL0kgXXl-92$$nK40mVzWLM9tdnG3DFvAS" : {
          "id" : "Yl5lacjCRrlL0kgXXl-92$$nK40mVzWLM9tdnG3DFvAS",
          "component" : "Reformat",
          "metadata" : {
            "label" : "reformat",
            "slug" : "reformat",
            "x" : -100,
            "y" : 1680,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "KXxJH9_VSrN2OlT-3FhpQ$$nNFmZiR7n1QWlhi9nzaZ2",
              "slug" : "condition_occurence_1",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "CONDITION_OCCURRENCE_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PERSON_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_START_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_START_DATETIME",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_END_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_END_DATETIME",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_TYPE_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "STOP_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROVIDER_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_DETAIL_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_SOURCE_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_STATUS_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_STATUS_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "hlmx_ivrJJBKMu60o1QoI$$gJMS_nw_ci3G4TUl5N_4l",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "CONDITION_OCCURRENCE_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "CONDITION_OCCURRENCE_ID"
              },
              "description" : ""
            }, {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "CONDITION_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "CONDITION_CONCEPT_ID"
              },
              "description" : ""
            }, {
              "target" : "CONDITION_START_DATETIME",
              "expression" : {
                "format" : "sql",
                "expression" : "CONDITION_START_DATETIME"
              },
              "description" : ""
            }, {
              "target" : "CONDITION_END_DATETIME",
              "expression" : {
                "format" : "sql",
                "expression" : "coalesce(CONDITION_END_DATETIME, date_add(CONDITION_START_DATETIME, 1))"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "KXxJH9_VSrN2OlT-3FhpQ$$nNFmZiR7n1QWlhi9nzaZ2##CONDITION_START_DATETIME", "KXxJH9_VSrN2OlT-3FhpQ$$nNFmZiR7n1QWlhi9nzaZ2##CONDITION_OCCURRENCE_ID", "KXxJH9_VSrN2OlT-3FhpQ$$nNFmZiR7n1QWlhi9nzaZ2##PERSON_ID", "KXxJH9_VSrN2OlT-3FhpQ$$nNFmZiR7n1QWlhi9nzaZ2##CONDITION_CONCEPT_ID", "KXxJH9_VSrN2OlT-3FhpQ$$nNFmZiR7n1QWlhi9nzaZ2##CONDITION_END_DATETIME" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        }
      }
    },
    "Uo4HQ24BN7us1fntgPsyU$$zzEWp8Nr0PF0_UEpBDdt1" : {
      "id" : "Uo4HQ24BN7us1fntgPsyU$$zzEWp8Nr0PF0_UEpBDdt1",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "cteFinalTarget",
        "slug" : "cteFinalTarget",
        "x" : -640,
        "y" : -300,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Decide when each overall period of drug use ends, considering overlaps."
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Br1-_kGI4r6BeO2mXzgYX$$0PS93GgQF3eOPL3SBmUp5",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "row_number",
              "type" : "integer",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "person_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_concept_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_sub_exposure_start_datetime",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_sub_exposure_end_datetime",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_exposure_count",
              "type" : "long",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "wYVCJ4tF9BbYj0IKaiR0g$$c0zDxQ1JVQfXEhB_Uj5zj",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "packageName" : "cteFinalTarget",
        "externalId" : "subgraphs/cteFinalTarget",
        "name" : "cteFinalTarget"
      },
      "connections" : [ {
        "id" : "aLTW_jbllV0O9TM0C3I2Z",
        "source" : "Uo4HQ24BN7us1fntgPsyU$$zzEWp8Nr0PF0_UEpBDdt1",
        "sourcePort" : "Br1-_kGI4r6BeO2mXzgYX$$0PS93GgQF3eOPL3SBmUp5",
        "target" : "Adq9cKEgRCQJpN2PTlpqI$$mU9q0vN-lan6vFb0DdDih",
        "targetPort" : "i6eihyM8ihvidBe5XeGkO$$3DE1IPwaU6PhgfvRPmPoA"
      }, {
        "id" : "IMz87n-f_855FayLHdJfh",
        "source" : "Adq9cKEgRCQJpN2PTlpqI$$mU9q0vN-lan6vFb0DdDih",
        "sourcePort" : "GlCvHVh-54Ts9DOvaCMgI$$Xvw-ExalqdKI6e8HPG8JV",
        "target" : "Uo4HQ24BN7us1fntgPsyU$$zzEWp8Nr0PF0_UEpBDdt1",
        "targetPort" : "wYVCJ4tF9BbYj0IKaiR0g$$c0zDxQ1JVQfXEhB_Uj5zj"
      } ],
      "processes" : {
        "Adq9cKEgRCQJpN2PTlpqI$$mU9q0vN-lan6vFb0DdDih" : {
          "id" : "Adq9cKEgRCQJpN2PTlpqI$$mU9q0vN-lan6vFb0DdDih",
          "component" : "Reformat",
          "metadata" : {
            "label" : "drug_exposure_summary_1",
            "slug" : "drug_exposure_summary_1",
            "x" : 180,
            "y" : -160,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "i6eihyM8ihvidBe5XeGkO$$3DE1IPwaU6PhgfvRPmPoA",
              "slug" : "cteSubExposures",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "row_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_sub_exposure_start_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_sub_exposure_end_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_count",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "GlCvHVh-54Ts9DOvaCMgI$$Xvw-ExalqdKI6e8HPG8JV",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "row_number",
              "expression" : {
                "format" : "sql",
                "expression" : "row_number"
              },
              "description" : ""
            }, {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "drug_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_concept_id"
              },
              "description" : ""
            }, {
              "target" : "drug_sub_exposure_start_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_sub_exposure_start_datetime"
              },
              "description" : ""
            }, {
              "target" : "drug_sub_exposure_end_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_sub_exposure_end_datetime"
              },
              "description" : ""
            }, {
              "target" : "drug_exposure_count",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_exposure_count"
              },
              "description" : ""
            }, {
              "target" : "days_exposed",
              "expression" : {
                "format" : "sql",
                "expression" : "datediff(drug_sub_exposure_end_datetime, drug_sub_exposure_start_datetime)"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "i6eihyM8ihvidBe5XeGkO$$MBpTkEgcaiM1ex6Z7Y2kb$$3DE1IPwaU6PhgfvRPmPoA$$fK5G_zpAjrXT90191NKGR##drug_exposure_count", "i6eihyM8ihvidBe5XeGkO$$MBpTkEgcaiM1ex6Z7Y2kb$$3DE1IPwaU6PhgfvRPmPoA$$fK5G_zpAjrXT90191NKGR##drug_sub_exposure_end_datetime", "i6eihyM8ihvidBe5XeGkO$$MBpTkEgcaiM1ex6Z7Y2kb$$3DE1IPwaU6PhgfvRPmPoA$$fK5G_zpAjrXT90191NKGR##row_number", "i6eihyM8ihvidBe5XeGkO$$MBpTkEgcaiM1ex6Z7Y2kb$$3DE1IPwaU6PhgfvRPmPoA$$fK5G_zpAjrXT90191NKGR##drug_concept_id", "i6eihyM8ihvidBe5XeGkO$$MBpTkEgcaiM1ex6Z7Y2kb$$3DE1IPwaU6PhgfvRPmPoA$$fK5G_zpAjrXT90191NKGR##drug_sub_exposure_start_datetime", "i6eihyM8ihvidBe5XeGkO$$MBpTkEgcaiM1ex6Z7Y2kb$$3DE1IPwaU6PhgfvRPmPoA$$fK5G_zpAjrXT90191NKGR##person_id" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        }
      }
    },
    "lz17ZzxOpvs-i6K6WqX5h$$o7cy13OOq_SDKaJvlfXNJ" : {
      "id" : "lz17ZzxOpvs-i6K6WqX5h$$o7cy13OOq_SDKaJvlfXNJ",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "cteSubExposureEndDates",
        "slug" : "cteSubExposureEndDates",
        "x" : -1120,
        "y" : -140,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Group Overlapping Exposures. Combine periods when someone takes more than one drug at the same time, so we don't count them twice"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "KoWSQ-CPgX7fx25HLXuCB$$ZB02Qn_f4zgv1mXRzt5i3",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "drug_exposure_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "person_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ingredient_concept_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_exposure_start_datetime",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "days_supply",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_exposure_end_datetime",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "JsphnXK_itqlxTQll5eRU$$mlTbyRgphykghiRzBHTm9",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "packageName" : "cteSubExposureEndDates",
        "externalId" : "subgraphs/cteSubExposureEndDates",
        "name" : "cteSubExposureEndDates"
      },
      "connections" : [ {
        "id" : "K0HzwFEmbQ-xb6WOoM9ms",
        "source" : "xH5j892t4ahOrLc_9C3PX$$bRHAeF0tTS6TAI0Qv1awo",
        "sourcePort" : "nxTauGyb1MyU5wSXWfD-A$$OY8tE7M_wnj-FOrZRD7RL",
        "target" : "v9M9dImZOHAdTfOV1TLhj$$SIZgQjCpVT0ZlGw30iq3s",
        "targetPort" : "LstDBQmeD4TH-tPe2NUiP$$Ii17G1nGF2a0luFCkoXjv"
      }, {
        "id" : "mVqp0niwEA3tmFW3fMuUx",
        "source" : "4zuWVVFoPTSB7cmrxI78g$$F3oKrtg8EFwzzjtVUmohI",
        "sourcePort" : "GTxX13nJNV5EoI9vRfMZQ$$Ks-dfEJaRQXubWzw8NZWi",
        "target" : "v9M9dImZOHAdTfOV1TLhj$$SIZgQjCpVT0ZlGw30iq3s",
        "targetPort" : "y83ZmPcSYeEGNb_GU1E-M$$uo_FSwfbM40zL7EHUzgJy"
      }, {
        "id" : "QSBGm5iv3dDaY9JFxwcEp",
        "source" : "v9M9dImZOHAdTfOV1TLhj$$SIZgQjCpVT0ZlGw30iq3s",
        "sourcePort" : "pc3ZEbVamalpsyNQZDEAM$$KCsvwVqP3WEND7nRwtkJg",
        "target" : "sMu1Q3-30EuiHNsrpe1_w$$6FZQZGIozE6QA5Ld_3TD5",
        "targetPort" : "Id-pLuxNTDLxxE2oTMGaI$$UpWm6WcE034WXWoLc4XBO"
      }, {
        "id" : "UDrI60vxTEznWo69-FttT",
        "source" : "sMu1Q3-30EuiHNsrpe1_w$$6FZQZGIozE6QA5Ld_3TD5",
        "sourcePort" : "ir2PnPzuBtFgz84i9v9A-$$sMZwPBIwDSmgUxWzDTcPm",
        "target" : "ddTa7Q9nEslqYslV5DScp$$SyOCS1O9-DEfkJzatW_R4",
        "targetPort" : "W73DjVzy7ax074Tik8L1Z$$JSDhNslucWhNPOQ9HQgDe"
      }, {
        "id" : "N5nqk3KN6OTlyQOCYFkED",
        "source" : "ddTa7Q9nEslqYslV5DScp$$SyOCS1O9-DEfkJzatW_R4",
        "sourcePort" : "8FjKe3m3AY-Y-GJ1TnrmF$$Bw8HjX4qroAQrpbVso2EW",
        "target" : "cOiqqNeMHCdX6X7FC_f37$$uc7VhBgPY92-aii24U8rT",
        "targetPort" : "rLClW_MmxUCGCHOWCmi3V$$nwYi5P9YBv5_FiwPzGFo2"
      }, {
        "id" : "BMD9pkvUegXKDcH6Dja-f",
        "source" : "lz17ZzxOpvs-i6K6WqX5h$$o7cy13OOq_SDKaJvlfXNJ",
        "sourcePort" : "KoWSQ-CPgX7fx25HLXuCB$$ZB02Qn_f4zgv1mXRzt5i3",
        "target" : "xH5j892t4ahOrLc_9C3PX$$bRHAeF0tTS6TAI0Qv1awo",
        "targetPort" : "TBPx-_V2WLRtBkSUaqtla$$NL6scccbXeBWer2Pl-zJE"
      }, {
        "id" : "_dO4yqstkwW-gvwFVN0up",
        "source" : "cOiqqNeMHCdX6X7FC_f37$$uc7VhBgPY92-aii24U8rT",
        "sourcePort" : "yEAl_CC4sVF0WNDuldEyv$$XQNdd_Lkimu1BigZiYn3X",
        "target" : "lz17ZzxOpvs-i6K6WqX5h$$o7cy13OOq_SDKaJvlfXNJ",
        "targetPort" : "JsphnXK_itqlxTQll5eRU$$mlTbyRgphykghiRzBHTm9"
      }, {
        "id" : "lIWsYg7CJW0aFUz3x02MH",
        "source" : "lz17ZzxOpvs-i6K6WqX5h$$o7cy13OOq_SDKaJvlfXNJ",
        "sourcePort" : "KoWSQ-CPgX7fx25HLXuCB$$ZB02Qn_f4zgv1mXRzt5i3",
        "target" : "4zuWVVFoPTSB7cmrxI78g$$F3oKrtg8EFwzzjtVUmohI",
        "targetPort" : "8m602Ab0S9W5ZkEPGdqJ6$$5URHGTsPyHa5BHgwgXGMz"
      } ],
      "processes" : {
        "v9M9dImZOHAdTfOV1TLhj$$SIZgQjCpVT0ZlGw30iq3s" : {
          "id" : "v9M9dImZOHAdTfOV1TLhj$$SIZgQjCpVT0ZlGw30iq3s",
          "component" : "SetOperation",
          "metadata" : {
            "label" : "SetOperation_4",
            "slug" : "SetOperation_4",
            "x" : 440,
            "y" : 2180,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "LstDBQmeD4TH-tPe2NUiP$$Ii17G1nGF2a0luFCkoXjv",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ingredient_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_date",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_type",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_ordinal",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "y83ZmPcSYeEGNb_GU1E-M$$uo_FSwfbM40zL7EHUzgJy",
              "slug" : "in1",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ingredient_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_date",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_type",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_ordinal",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "pc3ZEbVamalpsyNQZDEAM$$KCsvwVqP3WEND7nRwtkJg",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "operationType" : "unionAll",
            "allowMissingColumns" : false
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/SetOperation",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "4zuWVVFoPTSB7cmrxI78g$$F3oKrtg8EFwzzjtVUmohI" : {
          "id" : "4zuWVVFoPTSB7cmrxI78g$$F3oKrtg8EFwzzjtVUmohI",
          "component" : "Reformat",
          "metadata" : {
            "label" : "format_drug_exposure_data",
            "slug" : "format_drug_exposure_data",
            "x" : 260,
            "y" : 2280,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "8m602Ab0S9W5ZkEPGdqJ6$$5URHGTsPyHa5BHgwgXGMz",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "drug_exposure_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ingredient_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_start_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "days_supply",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_end_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "GTxX13nJNV5EoI9vRfMZQ$$Ks-dfEJaRQXubWzw8NZWi",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "ingredient_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "ingredient_concept_id"
              },
              "description" : ""
            }, {
              "target" : "event_date",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_exposure_start_datetime"
              },
              "description" : ""
            }, {
              "target" : "event_type",
              "expression" : {
                "format" : "sql",
                "expression" : "1"
              },
              "description" : ""
            }, {
              "target" : "start_ordinal",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(null as integer)"
              },
              "description" : ""
            } ],
            "importString" : "person_id,person_id\ningredient_concept_id,ingredient_concept_id\ndrug_exposure_start_datetime,drug_exposure_start_datetime\nevent_type,1\nstart_ordinal,cast(null as integer)",
            "activeTab" : "expressions",
            "columnsSelector" : [ "8m602Ab0S9W5ZkEPGdqJ6$$qNhfqDe8Yv7sgEvQHsGfi$$5URHGTsPyHa5BHgwgXGMz$$080ZJ4ZNH7HMUEXcQt-ow##person_id", "8m602Ab0S9W5ZkEPGdqJ6$$qNhfqDe8Yv7sgEvQHsGfi$$5URHGTsPyHa5BHgwgXGMz$$080ZJ4ZNH7HMUEXcQt-ow##ingredient_concept_id", "8m602Ab0S9W5ZkEPGdqJ6$$qNhfqDe8Yv7sgEvQHsGfi$$5URHGTsPyHa5BHgwgXGMz$$080ZJ4ZNH7HMUEXcQt-ow##drug_exposure_start_datetime" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "sMu1Q3-30EuiHNsrpe1_w$$6FZQZGIozE6QA5Ld_3TD5" : {
          "id" : "sMu1Q3-30EuiHNsrpe1_w$$6FZQZGIozE6QA5Ld_3TD5",
          "component" : "Reformat",
          "metadata" : {
            "label" : "latest_ingredient_events",
            "slug" : "latest_ingredient_events",
            "x" : 580,
            "y" : 2180,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Id-pLuxNTDLxxE2oTMGaI$$UpWm6WcE034WXWoLc4XBO",
              "slug" : "SetOperation_4",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ingredient_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_date",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_type",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_ordinal",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "ir2PnPzuBtFgz84i9v9A-$$sMZwPBIwDSmgUxWzDTcPm",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "ingredient_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "ingredient_concept_id"
              },
              "description" : ""
            }, {
              "target" : "event_date",
              "expression" : {
                "format" : "sql",
                "expression" : "event_date"
              },
              "description" : ""
            }, {
              "target" : "event_type",
              "expression" : {
                "format" : "sql",
                "expression" : "event_type"
              },
              "description" : ""
            }, {
              "target" : "start_ordinal",
              "expression" : {
                "format" : "sql",
                "expression" : "max(start_ordinal) over (partition by person_id, ingredient_concept_id order by event_date, event_type ROWS UNBOUNDED PRECEDING)"
              },
              "description" : ""
            }, {
              "target" : "overall_ord",
              "expression" : {
                "format" : "sql",
                "expression" : "row_number() OVER (PARTITION BY person_id, ingredient_concept_id ORDER BY event_date, event_type)"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "Id-pLuxNTDLxxE2oTMGaI$$FBWeq-fxSqzjaXCSQpJ39$$UpWm6WcE034WXWoLc4XBO$$52AjjNo311SzTWk7abZYy##event_type", "Id-pLuxNTDLxxE2oTMGaI$$FBWeq-fxSqzjaXCSQpJ39$$UpWm6WcE034WXWoLc4XBO$$52AjjNo311SzTWk7abZYy##event_date", "Id-pLuxNTDLxxE2oTMGaI$$FBWeq-fxSqzjaXCSQpJ39$$UpWm6WcE034WXWoLc4XBO$$52AjjNo311SzTWk7abZYy##person_id", "Id-pLuxNTDLxxE2oTMGaI$$FBWeq-fxSqzjaXCSQpJ39$$UpWm6WcE034WXWoLc4XBO$$52AjjNo311SzTWk7abZYy##ingredient_concept_id" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "ddTa7Q9nEslqYslV5DScp$$SyOCS1O9-DEfkJzatW_R4" : {
          "id" : "ddTa7Q9nEslqYslV5DScp$$SyOCS1O9-DEfkJzatW_R4",
          "component" : "Filter",
          "metadata" : {
            "label" : "filter_by_person_ingredient_ord",
            "slug" : "filter_by_person_ingredient_ord",
            "x" : 700,
            "y" : 2180,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "W73DjVzy7ax074Tik8L1Z$$JSDhNslucWhNPOQ9HQgDe",
              "slug" : "by_person_and_ingredient",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ingredient_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_date",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_type",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_ordinal",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "overall_ord",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "8FjKe3m3AY-Y-GJ1TnrmF$$Bw8HjX4qroAQrpbVso2EW",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ "W73DjVzy7ax074Tik8L1Z$$QBYtkvnuBNbj2uDlhxBQT$$JSDhNslucWhNPOQ9HQgDe$$RDjbmF3tqeS4TXg_LmOcG##overall_ord", "W73DjVzy7ax074Tik8L1Z$$QBYtkvnuBNbj2uDlhxBQT$$JSDhNslucWhNPOQ9HQgDe$$RDjbmF3tqeS4TXg_LmOcG##start_ordinal" ],
            "condition" : {
              "format" : "sql",
              "expression" : "(2*start_ordinal) - overall_ord = 0"
            }
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Filter",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "cOiqqNeMHCdX6X7FC_f37$$uc7VhBgPY92-aii24U8rT" : {
          "id" : "cOiqqNeMHCdX6X7FC_f37$$uc7VhBgPY92-aii24U8rT",
          "component" : "Reformat",
          "metadata" : {
            "label" : "by_person_and_ingredient",
            "slug" : "by_person_and_ingredient",
            "x" : 840,
            "y" : 2180,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "rLClW_MmxUCGCHOWCmi3V$$nwYi5P9YBv5_FiwPzGFo2",
              "slug" : "filter_by_ordinal_difference",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ingredient_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_date",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_type",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_ordinal",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "overall_ord",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "yEAl_CC4sVF0WNDuldEyv$$XQNdd_Lkimu1BigZiYn3X",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "ingredient_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "ingredient_concept_id"
              },
              "description" : ""
            }, {
              "target" : "end_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "event_date"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "rLClW_MmxUCGCHOWCmi3V$$IyqKyvn4ebR1mTppWTXZ1$$nwYi5P9YBv5_FiwPzGFo2$$gNyiruAaAMcwBjp-CJRaO##person_id", "rLClW_MmxUCGCHOWCmi3V$$IyqKyvn4ebR1mTppWTXZ1$$nwYi5P9YBv5_FiwPzGFo2$$gNyiruAaAMcwBjp-CJRaO##ingredient_concept_id", "rLClW_MmxUCGCHOWCmi3V$$IyqKyvn4ebR1mTppWTXZ1$$nwYi5P9YBv5_FiwPzGFo2$$gNyiruAaAMcwBjp-CJRaO##event_date" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "xH5j892t4ahOrLc_9C3PX$$bRHAeF0tTS6TAI0Qv1awo" : {
          "id" : "xH5j892t4ahOrLc_9C3PX$$bRHAeF0tTS6TAI0Qv1awo",
          "component" : "Reformat",
          "metadata" : {
            "label" : "by_person_and_ingredient_start_date",
            "slug" : "by_person_and_ingredient_start_date",
            "x" : 260,
            "y" : 2100,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TBPx-_V2WLRtBkSUaqtla$$NL6scccbXeBWer2Pl-zJE",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "drug_exposure_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ingredient_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_start_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "days_supply",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_end_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "nxTauGyb1MyU5wSXWfD-A$$OY8tE7M_wnj-FOrZRD7RL",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "ingredient_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "ingredient_concept_id"
              },
              "description" : ""
            }, {
              "target" : "event_date",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_exposure_start_datetime"
              },
              "description" : ""
            }, {
              "target" : "event_type",
              "expression" : {
                "format" : "sql",
                "expression" : "-1"
              },
              "description" : ""
            }, {
              "target" : "start_ordinal",
              "expression" : {
                "format" : "sql",
                "expression" : "row_number() OVER (PARTITION BY person_id, ingredient_concept_id ORDER BY drug_exposure_start_datetime)"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "TBPx-_V2WLRtBkSUaqtla$$gbXWXN9Y9QTn8CJvvmxkj$$NL6scccbXeBWer2Pl-zJE$$FlVN5rC9EotD2lGB8PDap##person_id", "TBPx-_V2WLRtBkSUaqtla$$gbXWXN9Y9QTn8CJvvmxkj$$NL6scccbXeBWer2Pl-zJE$$FlVN5rC9EotD2lGB8PDap##drug_exposure_start_datetime", "TBPx-_V2WLRtBkSUaqtla$$gbXWXN9Y9QTn8CJvvmxkj$$NL6scccbXeBWer2Pl-zJE$$FlVN5rC9EotD2lGB8PDap##ingredient_concept_id" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        }
      }
    },
    "C7hriH0jlz3C3JD7no_sE$$sqjojOqaED1zxGNDBw42S" : {
      "id" : "C7hriH0jlz3C3JD7no_sE$$sqjojOqaED1zxGNDBw42S",
      "component" : "Aggregate",
      "metadata" : {
        "label" : "drug_era_summary",
        "slug" : "drug_era_summary",
        "x" : -120,
        "y" : -300,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "ED77B5IYMVr3GFv9ZHjVU$$EvsMFH_OW-ii0XBtuJAs7",
          "slug" : "cteDrugEraEnds",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "person_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_concept_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_sub_exposure_start_datetime",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "era_end_datetime",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_exposure_count",
              "type" : "long",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "days_exposed",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "aOwj7S_141AFBKNbTJXAK$$ZX4yMrnN1DJCdfVKya28e",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "allIns" : false,
        "doPivot" : false,
        "aggregate" : [ {
          "target" : "drug_era_start_datetime",
          "expression" : {
            "format" : "sql",
            "expression" : "min(drug_sub_exposure_start_datetime)"
          },
          "description" : "",
          "_row_id" : "c_221"
        }, {
          "target" : "drug_exposure_count",
          "expression" : {
            "format" : "sql",
            "expression" : "sum(drug_exposure_count)"
          },
          "description" : "",
          "_row_id" : "c_222"
        }, {
          "target" : "gap_days",
          "expression" : {
            "format" : "sql",
            "expression" : "datediff(date_add(era_end_datetime, cast(-(datediff(era_end_datetime, min(drug_sub_exposure_start_datetime))-sum(days_exposed)) as int)), '1970-01-01')"
          },
          "description" : "",
          "_row_id" : "c_327"
        } ],
        "allowSelection" : true,
        "pivotColumn" : null,
        "pivotValues" : [ ],
        "activeTab" : "aggregate",
        "columnsSelector" : [ "ED77B5IYMVr3GFv9ZHjVU$$EvsMFH_OW-ii0XBtuJAs7##drug_exposure_count", "ED77B5IYMVr3GFv9ZHjVU$$EvsMFH_OW-ii0XBtuJAs7##days_exposed", "ED77B5IYMVr3GFv9ZHjVU$$EvsMFH_OW-ii0XBtuJAs7##era_end_datetime", "ED77B5IYMVr3GFv9ZHjVU$$EvsMFH_OW-ii0XBtuJAs7##person_id", "ED77B5IYMVr3GFv9ZHjVU$$EvsMFH_OW-ii0XBtuJAs7##drug_sub_exposure_start_datetime", "ED77B5IYMVr3GFv9ZHjVU$$EvsMFH_OW-ii0XBtuJAs7##drug_concept_id" ],
        "groupBy" : [ {
          "target" : "person_id",
          "expression" : {
            "format" : "sql",
            "expression" : "person_id"
          },
          "description" : "",
          "_row_id" : null
        }, {
          "target" : "drug_concept_id",
          "expression" : {
            "format" : "sql",
            "expression" : "drug_concept_id"
          },
          "description" : "",
          "_row_id" : null
        }, {
          "target" : "era_end_datetime",
          "expression" : {
            "format" : "sql",
            "expression" : "era_end_datetime"
          },
          "description" : "",
          "_row_id" : null
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Aggregate",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "OIPqW0uKupnbT87uLNtQK$$D-bqT91clu_hnaQ8WTsXH" : {
      "id" : "OIPqW0uKupnbT87uLNtQK$$D-bqT91clu_hnaQ8WTsXH",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "ctePreDrugTarget",
        "slug" : "ctePreDrugTarget",
        "x" : -1300,
        "y" : -300,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Start with datasets of when people were exposed to different drugs.\n\nFix any issues with the end dates of drug exposures, like missing or inconsistent data. Also, gather necessary information about drugs from different tables."
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "HYYvykla2NBt_SpKijuNc$$ALk9ptp3ie4s5kZV7ZDl2",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "packageName" : "ctePreDrugTarget",
        "externalId" : "subgraphs/ctePreDrugTarget",
        "name" : "ctePreDrugTarget"
      },
      "connections" : [ {
        "id" : "TQiADXtJYWoEL5-GzpLEV",
        "source" : "mX2UxsPD-qsqz9xLd1wY8$$wbSI7NJobKUov9LythKtR",
        "sourcePort" : "dLIxW7Ha8XujJiHCVpa1p$$yDZl4w-PJCcfTsv7EYQ0Y",
        "target" : "uoFh1TCg0X6xAW6N0FtN1$$E45EyVK8kxD2dppq2dbp8",
        "targetPort" : "MT4pGjGeNt1ZxhnWyLM1l$$eDMEck3syjHdDxH-hsmkt"
      }, {
        "id" : "oxoOrUzqvP8_pAS2FngDj",
        "source" : "N-bQ63blaJJTPB3rcckFV$$q7gisreAwkcnblYmuSNWI",
        "sourcePort" : "elClpaMxH8oUXmeNTQjny$$vW2aPhwu7MxH5m0C5lPut",
        "target" : "uoFh1TCg0X6xAW6N0FtN1$$E45EyVK8kxD2dppq2dbp8",
        "targetPort" : "vwOaJqzo-cHKlnqkYMiq0$$cuwPSxTQftPT1Lvu53uSA"
      }, {
        "id" : "hoRubGfBC6Y-mWnp5H8jC",
        "source" : "dxP_ptlAFPGB7svayUAk1$$xDl4a9NV76-tY0EucyLle",
        "sourcePort" : "eG6U0xccFL3Rt8q_uyRm5$$P31E4GAYkf52ptDpFdXB6",
        "target" : "uoFh1TCg0X6xAW6N0FtN1$$E45EyVK8kxD2dppq2dbp8",
        "targetPort" : "3BMowdJKiIGG-9HWT-D9h$$s3e6AZGyB1yvrTlUt9nS1"
      }, {
        "id" : "FEeBZF2v_jx5xDNghblrF",
        "source" : "uoFh1TCg0X6xAW6N0FtN1$$E45EyVK8kxD2dppq2dbp8",
        "sourcePort" : "zOoRcGBHMTbh9f99GZw1F$$y-ODUneiBCYrKtQEqWiPL",
        "target" : "OIPqW0uKupnbT87uLNtQK$$D-bqT91clu_hnaQ8WTsXH",
        "targetPort" : "HYYvykla2NBt_SpKijuNc$$ALk9ptp3ie4s5kZV7ZDl2"
      } ],
      "processes" : {
        "N-bQ63blaJJTPB3rcckFV$$q7gisreAwkcnblYmuSNWI" : {
          "id" : "N-bQ63blaJJTPB3rcckFV$$q7gisreAwkcnblYmuSNWI",
          "component" : "Source",
          "metadata" : {
            "label" : "concept_ancestor",
            "slug" : "concept_ancestor",
            "x" : 0,
            "y" : 2200,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "elClpaMxH8oUXmeNTQjny$$vW2aPhwu7MxH5m0C5lPut",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/concept_ancestor"
          }
        },
        "uoFh1TCg0X6xAW6N0FtN1$$E45EyVK8kxD2dppq2dbp8" : {
          "id" : "uoFh1TCg0X6xAW6N0FtN1$$E45EyVK8kxD2dppq2dbp8",
          "component" : "Join",
          "metadata" : {
            "label" : "join_multiple_inputs",
            "slug" : "join_multiple_inputs",
            "x" : 240,
            "y" : 2200,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "MT4pGjGeNt1ZxhnWyLM1l$$eDMEck3syjHdDxH-hsmkt",
              "slug" : "d",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "DRUG_EXPOSURE_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PERSON_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DRUG_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DRUG_EXPOSURE_START_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DRUG_EXPOSURE_START_DATETIME",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DRUG_EXPOSURE_END_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DRUG_EXPOSURE_END_DATETIME",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VERBATIM_END_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DRUG_TYPE_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "STOP_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "REFILLS",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "QUANTITY",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DAYS_SUPPLY",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SIG",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ROUTE_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "LOT_NUMBER",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROVIDER_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_DETAIL_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DRUG_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DRUG_SOURCE_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ROUTE_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DOSE_UNIT_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "vwOaJqzo-cHKlnqkYMiq0$$cuwPSxTQftPT1Lvu53uSA",
              "slug" : "ca",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "ANCESTOR_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DESCENDANT_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "MIN_LEVELS_OF_SEPARATION",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "MAX_LEVELS_OF_SEPARATION",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "3BMowdJKiIGG-9HWT-D9h$$s3e6AZGyB1yvrTlUt9nS1",
              "slug" : "c",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONCEPT_NAME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "STANDARD_CONCEPT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONCEPT_CODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VALID_START_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VALID_END_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "zOoRcGBHMTbh9f99GZw1F$$y-ODUneiBCYrKtQEqWiPL",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "conditions" : [ {
              "alias" : "ca",
              "expression" : {
                "format" : "sql",
                "expression" : "ca.DESCENDANT_CONCEPT_ID = d.drug_concept_id"
              },
              "joinType" : "inner"
            }, {
              "alias" : "c",
              "expression" : {
                "format" : "sql",
                "expression" : "ca.ANCESTOR_CONCEPT_ID = c.CONCEPT_ID"
              },
              "joinType" : "inner"
            } ],
            "expressions" : [ {
              "target" : "drug_exposure_id",
              "expression" : {
                "format" : "sql",
                "expression" : "d.drug_exposure_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "d.person_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "_row_id" : "c_357",
              "target" : "ingredient_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "c.CONCEPT_ID"
              },
              "description" : ""
            }, {
              "_row_id" : "c_358",
              "target" : "drug_exposure_start_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "d.drug_exposure_start_datetime"
              },
              "description" : ""
            }, {
              "_row_id" : "c_359",
              "target" : "days_supply",
              "expression" : {
                "format" : "sql",
                "expression" : "d.days_supply"
              },
              "description" : ""
            }, {
              "_row_id" : "c_360",
              "target" : "drug_exposure_end_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "coalesce(\n    ifnull(d.drug_exposure_end_datetime, NULL),\n    ifnull(date_add(d.drug_exposure_start_datetime, cast(d.days_supply as int)), d.drug_exposure_start_datetime),\n    date_add(d.drug_exposure_start_datetime, 1)\n    )"
              },
              "description" : ""
            } ],
            "hints" : [ {
              "id" : "MT4pGjGeNt1ZxhnWyLM1l$$eDMEck3syjHdDxH-hsmkt$$J-9KPvi4ebrBppMb2RmuF",
              "alias" : "d",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "vwOaJqzo-cHKlnqkYMiq0$$cuwPSxTQftPT1Lvu53uSA$$eJJCd-Ln05evVD1uWfGFs",
              "alias" : "ca",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "3BMowdJKiIGG-9HWT-D9h$$s3e6AZGyB1yvrTlUt9nS1$$gZpx2n3aSO0auauSEUxWL",
              "alias" : "c",
              "hintType" : "none",
              "propagateColumns" : false
            } ],
            "allIn1" : null,
            "activeTab" : "expressions",
            "columnsSelector" : [ "MT4pGjGeNt1ZxhnWyLM1l$$eDMEck3syjHdDxH-hsmkt$$J-9KPvi4ebrBppMb2RmuF##drug_concept_id", "vwOaJqzo-cHKlnqkYMiq0$$cuwPSxTQftPT1Lvu53uSA$$eJJCd-Ln05evVD1uWfGFs##ANCESTOR_CONCEPT_ID", "vwOaJqzo-cHKlnqkYMiq0$$cuwPSxTQftPT1Lvu53uSA$$eJJCd-Ln05evVD1uWfGFs##DESCENDANT_CONCEPT_ID", "3BMowdJKiIGG-9HWT-D9h$$s3e6AZGyB1yvrTlUt9nS1$$gZpx2n3aSO0auauSEUxWL##CONCEPT_ID", "MT4pGjGeNt1ZxhnWyLM1l$$eDMEck3syjHdDxH-hsmkt$$J-9KPvi4ebrBppMb2RmuF##drug_exposure_id", "MT4pGjGeNt1ZxhnWyLM1l$$eDMEck3syjHdDxH-hsmkt$$J-9KPvi4ebrBppMb2RmuF##days_supply", "MT4pGjGeNt1ZxhnWyLM1l$$eDMEck3syjHdDxH-hsmkt$$J-9KPvi4ebrBppMb2RmuF##drug_exposure_start_datetime", "MT4pGjGeNt1ZxhnWyLM1l$$eDMEck3syjHdDxH-hsmkt$$J-9KPvi4ebrBppMb2RmuF##person_id", "3BMowdJKiIGG-9HWT-D9h$$s3e6AZGyB1yvrTlUt9nS1$$gZpx2n3aSO0auauSEUxWL##CONCEPT_ID" ],
            "allIn0" : null,
            "whereClause" : {
              "format" : "sql",
              "expression" : "c.VOCABULARY_ID = 'RxNorm'\nAND c.CONCEPT_CLASS_ID = 'Ingredient'\nAND d.drug_concept_id != 0\nAND coalesce(d.days_supply, 0) >= 0"
            },
            "headAlias" : "d"
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Join",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "dxP_ptlAFPGB7svayUAk1$$xDl4a9NV76-tY0EucyLle" : {
          "id" : "dxP_ptlAFPGB7svayUAk1$$xDl4a9NV76-tY0EucyLle",
          "component" : "Source",
          "metadata" : {
            "label" : "concept",
            "slug" : "concept",
            "x" : 0,
            "y" : 2340,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "eG6U0xccFL3Rt8q_uyRm5$$P31E4GAYkf52ptDpFdXB6",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/concept"
          }
        },
        "mX2UxsPD-qsqz9xLd1wY8$$wbSI7NJobKUov9LythKtR" : {
          "id" : "mX2UxsPD-qsqz9xLd1wY8$$wbSI7NJobKUov9LythKtR",
          "component" : "Source",
          "metadata" : {
            "label" : "drug_exposure_1",
            "slug" : "drug_exposure_1",
            "x" : 0,
            "y" : 2060,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "dLIxW7Ha8XujJiHCVpa1p$$yDZl4w-PJCcfTsv7EYQ0Y",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/drug_exposure"
          }
        }
      }
    },
    "QpImT9I3HYF_5aQnr8s8T$$wvjdbHGUDrKU3aQ_KrokM" : {
      "id" : "QpImT9I3HYF_5aQnr8s8T$$wvjdbHGUDrKU3aQ_KrokM",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "cteConditionEnds",
        "slug" : "cteConditionEnds",
        "x" : -960,
        "y" : -680,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "S8sR_fxfm980FN-mTjkwv$$QWNvXOyoqaHUkP_cENnS3",
          "slug" : "c",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "CONDITION_OCCURRENCE_ID",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "person_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "CONDITION_CONCEPT_ID",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "CONDITION_START_DATETIME",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "CONDITION_END_DATETIME",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "VdgKPsv_nugbfJV1XmoiY$$nBboNkm6s_kqeK3QJmhut",
          "slug" : "e0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "person_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "CONDITION_CONCEPT_ID",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "end_date",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "McJS24PjzfagsvAF9ANGp$$Zh_pJPLSSfBm97QXxtvzT",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "packageName" : "cteConditionEnds",
        "externalId" : "subgraphs/cteConditionEnds",
        "name" : "cteConditionEnds"
      },
      "connections" : [ {
        "id" : "oXMdfCJEPsChB7Dpzr5jn",
        "source" : "wOER3TkNFHg2H5TLFd-xO$$RGCCd-xcR0x3bH_3YjX9k",
        "sourcePort" : "NeSh2o5mrWEiDkBCQk2Av$$gMooqQDAbdozJxxt0a92F",
        "target" : "p-C-_kN8KcPlrtaguNEIu$$1WouRjd6TUfOVlwdTOKyk",
        "targetPort" : "vpW1RNiiL4IE9fnZB8uES$$u9a3Ho8iuS8jFO3ItgSwt"
      }, {
        "id" : "44bxY9OsMljtwx8dbjysO",
        "source" : "p-C-_kN8KcPlrtaguNEIu$$1WouRjd6TUfOVlwdTOKyk",
        "sourcePort" : "sXIy573thx8xlXAHRr9n5$$yjSFnZrYQewdDRcRmbDQ7",
        "target" : "IdKBjk453Ri0q0tXVeJUA$$6Qdqus7q4RDnKO3vXskQi",
        "targetPort" : "HMr4X1SNHtYUsh4c8s5iJ$$ylDWVDZZU9A8YsV-Le8gk"
      }, {
        "id" : "kjy1XbOme5kX8ZktwIGaB",
        "source" : "QpImT9I3HYF_5aQnr8s8T$$wvjdbHGUDrKU3aQ_KrokM",
        "sourcePort" : "S8sR_fxfm980FN-mTjkwv$$QWNvXOyoqaHUkP_cENnS3",
        "target" : "wOER3TkNFHg2H5TLFd-xO$$RGCCd-xcR0x3bH_3YjX9k",
        "targetPort" : "CaFiH8gnIx8knds3MFKTS$$W1f_dLMI3SQL6Tm_0M61W"
      }, {
        "id" : "p_SuDFHW4GqN7TT1NpaW_",
        "source" : "QpImT9I3HYF_5aQnr8s8T$$wvjdbHGUDrKU3aQ_KrokM",
        "sourcePort" : "VdgKPsv_nugbfJV1XmoiY$$nBboNkm6s_kqeK3QJmhut",
        "target" : "wOER3TkNFHg2H5TLFd-xO$$RGCCd-xcR0x3bH_3YjX9k",
        "targetPort" : "5v8fkfp1wv3T8SWeBfb_4$$K9QPDkfMlspuFNtKQS9eZ"
      }, {
        "id" : "9xBjqeFDeT2H7xIP84EvK",
        "source" : "IdKBjk453Ri0q0tXVeJUA$$6Qdqus7q4RDnKO3vXskQi",
        "sourcePort" : "lypXhVeEvRTHcvqbhEc_9$$PAd7AQAr6lfNT40lFCXwv",
        "target" : "QpImT9I3HYF_5aQnr8s8T$$wvjdbHGUDrKU3aQ_KrokM",
        "targetPort" : "McJS24PjzfagsvAF9ANGp$$Zh_pJPLSSfBm97QXxtvzT"
      } ],
      "processes" : {
        "wOER3TkNFHg2H5TLFd-xO$$RGCCd-xcR0x3bH_3YjX9k" : {
          "id" : "wOER3TkNFHg2H5TLFd-xO$$RGCCd-xcR0x3bH_3YjX9k",
          "component" : "Join",
          "metadata" : {
            "label" : "by_person_id_and_condition_concept_id",
            "slug" : "by_person_id_and_condition_concept_id",
            "x" : 240,
            "y" : 1780,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "CaFiH8gnIx8knds3MFKTS$$W1f_dLMI3SQL6Tm_0M61W",
              "slug" : "c",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "CONDITION_OCCURRENCE_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_START_DATETIME",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_END_DATETIME",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "5v8fkfp1wv3T8SWeBfb_4$$K9QPDkfMlspuFNtKQS9eZ",
              "slug" : "e",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "end_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "NeSh2o5mrWEiDkBCQk2Av$$gMooqQDAbdozJxxt0a92F",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "conditions" : [ {
              "alias" : "e",
              "expression" : {
                "format" : "sql",
                "expression" : "c.person_id = e.person_id\nAND c.CONDITION_CONCEPT_ID = e.CONDITION_CONCEPT_ID\nAND e.end_date >= c.CONDITION_START_DATETIME"
              },
              "joinType" : "inner"
            } ],
            "expressions" : [ {
              "target" : "CONDITION_OCCURRENCE_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "c.CONDITION_OCCURRENCE_ID"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "c.person_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "CONDITION_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "c.CONDITION_CONCEPT_ID"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "CONDITION_START_DATETIME",
              "expression" : {
                "format" : "sql",
                "expression" : "c.CONDITION_START_DATETIME"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "CONDITION_END_DATETIME",
              "expression" : {
                "format" : "sql",
                "expression" : "c.CONDITION_END_DATETIME"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "end_date",
              "expression" : {
                "format" : "sql",
                "expression" : "e.end_date"
              },
              "description" : "",
              "_row_id" : null
            } ],
            "hints" : [ {
              "id" : "CaFiH8gnIx8knds3MFKTS$$Xo1HyhaPEpJDUK8jy-me8$$W1f_dLMI3SQL6Tm_0M61W",
              "alias" : "c",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "5v8fkfp1wv3T8SWeBfb_4$$wjMPUnFbhA9fzMsiyDwNt$$K9QPDkfMlspuFNtKQS9eZ",
              "alias" : "e",
              "hintType" : "none",
              "propagateColumns" : false
            } ],
            "allIn1" : null,
            "activeTab" : "expressions",
            "columnsSelector" : [ "CaFiH8gnIx8knds3MFKTS$$Xo1HyhaPEpJDUK8jy-me8$$W1f_dLMI3SQL6Tm_0M61W##person_id", "CaFiH8gnIx8knds3MFKTS$$Xo1HyhaPEpJDUK8jy-me8$$W1f_dLMI3SQL6Tm_0M61W##CONDITION_CONCEPT_ID", "5v8fkfp1wv3T8SWeBfb_4$$wjMPUnFbhA9fzMsiyDwNt$$K9QPDkfMlspuFNtKQS9eZ##CONDITION_CONCEPT_ID", "5v8fkfp1wv3T8SWeBfb_4$$wjMPUnFbhA9fzMsiyDwNt$$K9QPDkfMlspuFNtKQS9eZ##end_date", "5v8fkfp1wv3T8SWeBfb_4$$wjMPUnFbhA9fzMsiyDwNt$$K9QPDkfMlspuFNtKQS9eZ##person_id", "CaFiH8gnIx8knds3MFKTS$$Xo1HyhaPEpJDUK8jy-me8$$W1f_dLMI3SQL6Tm_0M61W##CONDITION_START_DATETIME", "CaFiH8gnIx8knds3MFKTS$$Xo1HyhaPEpJDUK8jy-me8$$W1f_dLMI3SQL6Tm_0M61W##CONDITION_OCCURRENCE_ID", "CaFiH8gnIx8knds3MFKTS$$Xo1HyhaPEpJDUK8jy-me8$$W1f_dLMI3SQL6Tm_0M61W##person_id", "CaFiH8gnIx8knds3MFKTS$$Xo1HyhaPEpJDUK8jy-me8$$W1f_dLMI3SQL6Tm_0M61W##CONDITION_CONCEPT_ID", "5v8fkfp1wv3T8SWeBfb_4$$wjMPUnFbhA9fzMsiyDwNt$$K9QPDkfMlspuFNtKQS9eZ##end_date", "CaFiH8gnIx8knds3MFKTS$$Xo1HyhaPEpJDUK8jy-me8$$W1f_dLMI3SQL6Tm_0M61W##CONDITION_START_DATETIME", "CaFiH8gnIx8knds3MFKTS$$Xo1HyhaPEpJDUK8jy-me8$$W1f_dLMI3SQL6Tm_0M61W##CONDITION_END_DATETIME" ],
            "allIn0" : null,
            "whereClause" : null,
            "headAlias" : "c"
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Join",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "p-C-_kN8KcPlrtaguNEIu$$1WouRjd6TUfOVlwdTOKyk" : {
          "id" : "p-C-_kN8KcPlrtaguNEIu$$1WouRjd6TUfOVlwdTOKyk",
          "component" : "Aggregate",
          "metadata" : {
            "label" : "Aggregate_1",
            "slug" : "Aggregate_1",
            "x" : 400,
            "y" : 1780,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "vpW1RNiiL4IE9fnZB8uES$$u9a3Ho8iuS8jFO3ItgSwt",
              "slug" : "by_person_id_and_condition_concept_id",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "CONDITION_OCCURRENCE_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_START_DATETIME",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_END_DATETIME",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "end_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "sXIy573thx8xlXAHRr9n5$$yjSFnZrYQewdDRcRmbDQ7",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "allIns" : false,
            "doPivot" : false,
            "aggregate" : [ {
              "target" : "era_end_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "min(end_date)"
              },
              "description" : "",
              "_row_id" : "c_285"
            } ],
            "allowSelection" : true,
            "pivotColumn" : null,
            "pivotValues" : [ ],
            "activeTab" : "aggregate",
            "columnsSelector" : [ "vpW1RNiiL4IE9fnZB8uES$$hkc77Wi73GrypW7uu8kdk$$u9a3Ho8iuS8jFO3ItgSwt##end_date", "vpW1RNiiL4IE9fnZB8uES$$hkc77Wi73GrypW7uu8kdk$$u9a3Ho8iuS8jFO3ItgSwt##CONDITION_OCCURRENCE_ID", "vpW1RNiiL4IE9fnZB8uES$$hkc77Wi73GrypW7uu8kdk$$u9a3Ho8iuS8jFO3ItgSwt##CONDITION_CONCEPT_ID", "vpW1RNiiL4IE9fnZB8uES$$hkc77Wi73GrypW7uu8kdk$$u9a3Ho8iuS8jFO3ItgSwt##CONDITION_START_DATETIME", "vpW1RNiiL4IE9fnZB8uES$$hkc77Wi73GrypW7uu8kdk$$u9a3Ho8iuS8jFO3ItgSwt##person_id" ],
            "groupBy" : [ {
              "target" : "CONDITION_OCCURRENCE_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "CONDITION_OCCURRENCE_ID"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "CONDITION_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "CONDITION_CONCEPT_ID"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "CONDITION_START_DATETIME",
              "expression" : {
                "format" : "sql",
                "expression" : "CONDITION_START_DATETIME"
              },
              "description" : "",
              "_row_id" : null
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Aggregate",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "IdKBjk453Ri0q0tXVeJUA$$6Qdqus7q4RDnKO3vXskQi" : {
          "id" : "IdKBjk453Ri0q0tXVeJUA$$6Qdqus7q4RDnKO3vXskQi",
          "component" : "Reformat",
          "metadata" : {
            "label" : "condition_era_projection",
            "slug" : "condition_era_projection",
            "x" : 580,
            "y" : 1780,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "HMr4X1SNHtYUsh4c8s5iJ$$ylDWVDZZU9A8YsV-Le8gk",
              "slug" : "Aggregate_1",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "CONDITION_OCCURRENCE_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_START_DATETIME",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "era_end_datetime",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "lypXhVeEvRTHcvqbhEc_9$$PAd7AQAr6lfNT40lFCXwv",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "CONDITION_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "CONDITION_CONCEPT_ID"
              },
              "description" : ""
            }, {
              "target" : "CONDITION_START_DATETIME",
              "expression" : {
                "format" : "sql",
                "expression" : "CONDITION_START_DATETIME"
              },
              "description" : ""
            }, {
              "target" : "era_end_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "era_end_datetime"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "HMr4X1SNHtYUsh4c8s5iJ$$985E24vU1SwTx7pE8LMQ9$$ylDWVDZZU9A8YsV-Le8gk##CONDITION_START_DATETIME", "HMr4X1SNHtYUsh4c8s5iJ$$985E24vU1SwTx7pE8LMQ9$$ylDWVDZZU9A8YsV-Le8gk##CONDITION_CONCEPT_ID", "HMr4X1SNHtYUsh4c8s5iJ$$985E24vU1SwTx7pE8LMQ9$$ylDWVDZZU9A8YsV-Le8gk##person_id", "HMr4X1SNHtYUsh4c8s5iJ$$985E24vU1SwTx7pE8LMQ9$$ylDWVDZZU9A8YsV-Le8gk##era_end_datetime" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        }
      }
    },
    "UDd4eJ2ODFTAkZ6vdVY3o$$tCDTnLQfcRw7TtSqWjlP0" : {
      "id" : "UDd4eJ2ODFTAkZ6vdVY3o$$tCDTnLQfcRw7TtSqWjlP0",
      "component" : "Reformat",
      "metadata" : {
        "label" : "drug_era_summary_reformat",
        "slug" : "drug_era_summary_reformat",
        "x" : 80,
        "y" : -300,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Combine all the data to create clear, defined periods of drug use. Each period gets its own ID.\n\nCalculate any gaps between periods of drug use to understand if there were breaks in taking the drug."
      },
      "ports" : {
        "inputs" : [ {
          "id" : "5y7oKYiCP6wQbp1uIPSTQ$$ySWI3fY49DaAD0eYB-cQq",
          "slug" : "drug_era_summary",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "person_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_concept_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "era_end_datetime",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_era_start_datetime",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_exposure_count",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "gap_days",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "V2Txu04kxwgrmKYF4szGV$$HIZw8WaL0z8yHtPrAlWJ6",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
        "expressions" : [ {
          "target" : "drug_era_id",
          "expression" : {
            "format" : "sql",
            "expression" : "row_number() OVER (PARTITION BY 1 ORDER BY person_id)"
          },
          "description" : ""
        }, {
          "target" : "person_id",
          "expression" : {
            "format" : "sql",
            "expression" : "person_id"
          },
          "description" : ""
        }, {
          "target" : "drug_concept_id",
          "expression" : {
            "format" : "sql",
            "expression" : "drug_concept_id"
          },
          "description" : ""
        }, {
          "target" : "drug_era_start_datetime",
          "expression" : {
            "format" : "sql",
            "expression" : "drug_era_start_datetime"
          },
          "description" : ""
        }, {
          "target" : "drug_era_end_datetime",
          "expression" : {
            "format" : "sql",
            "expression" : "era_end_datetime"
          },
          "description" : ""
        }, {
          "target" : "drug_exposure_count",
          "expression" : {
            "format" : "sql",
            "expression" : "drug_exposure_count"
          },
          "description" : ""
        }, {
          "target" : "gap_days",
          "expression" : {
            "format" : "sql",
            "expression" : "gap_days"
          },
          "description" : ""
        } ],
        "importString" : "drug_era_id,row_number() OVER (PARTITION BY 1 ORDER BY person_id)\nperson_id,person_id\ndrug_concept_id,drug_concept_id\ndrug_era_start_datetime,drug_era_start_datetime\ndrug_era_end_datetime,era_end_datetime\ndrug_exposure_count,drug_exposure_count\ngap_days,``datediff(date_add(era_end_datetime, cast(-(datediff(era_end_datetime, min(drug_era_start_datetime))-sum(days_exposed)) as integer)), '1970-01-01')``",
        "activeTab" : "expressions",
        "columnsSelector" : [ "5y7oKYiCP6wQbp1uIPSTQ$$ySWI3fY49DaAD0eYB-cQq##gap_days", "5y7oKYiCP6wQbp1uIPSTQ$$ySWI3fY49DaAD0eYB-cQq##drug_exposure_count", "5y7oKYiCP6wQbp1uIPSTQ$$ySWI3fY49DaAD0eYB-cQq##drug_concept_id", "5y7oKYiCP6wQbp1uIPSTQ$$ySWI3fY49DaAD0eYB-cQq##drug_era_start_datetime", "5y7oKYiCP6wQbp1uIPSTQ$$ySWI3fY49DaAD0eYB-cQq##era_end_datetime", "5y7oKYiCP6wQbp1uIPSTQ$$ySWI3fY49DaAD0eYB-cQq##person_id" ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "WVI0LfzUY9bp5AASNXkqv$$2ExnyDXyRxn2O93fXNwYO" : {
      "id" : "WVI0LfzUY9bp5AASNXkqv$$2ExnyDXyRxn2O93fXNwYO",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "cteDrugExposureEnds",
        "slug" : "cteDrugExposureEnds",
        "x" : -960,
        "y" : -300,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Figure out when each time someone stops taking a drug, based on when they started and the type of event (like the end of a prescription)."
      },
      "ports" : {
        "inputs" : [ {
          "id" : "JfGHSjrPhlfhfFku3PimN$$cnsyT1jxIMwMwcOoynOId",
          "slug" : "dt",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "drug_exposure_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "person_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ingredient_concept_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_exposure_start_datetime",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "days_supply",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_exposure_end_datetime",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "yBIZnBRX1pirm5UzpoxLk$$5dckQcVsjY-HEEtEG8Fxu",
          "slug" : "e0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "person_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ingredient_concept_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "end_datetime",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "XwoUws3LSBm29xSPbi4fY$$0aFqkvaZkJCjRagbRtzE6",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "packageName" : "cteDrugExposureEnds",
        "externalId" : "subgraphs/cteDrugExposureEnds",
        "name" : "cteDrugExposureEnds"
      },
      "connections" : [ {
        "id" : "iA0MkLTFkZboMT3b79q95",
        "source" : "OfNKEZh_TAWfJS_Pb3vLF$$yvDnLeybFwrsZwCE9_vhs",
        "sourcePort" : "TxHViD-6IWEeLhmJCtXNQ$$eyPOqUihqKOgfvVVbRL3A",
        "target" : "ei5KM-OdRfj0Vi-__2zQu$$Zme__0Sibxw_RA1so2tYJ",
        "targetPort" : "YlpSMtBbtHs7sU3FWWaJf$$p-VA-_T-l-gkAeyXJgP00"
      }, {
        "id" : "e9WxSq99FWduzG8XxdvCD",
        "source" : "ei5KM-OdRfj0Vi-__2zQu$$Zme__0Sibxw_RA1so2tYJ",
        "sourcePort" : "HoNmg9s42NGzf6yvhLWwS$$brhdE66VB4XWhRwIJCkT1",
        "target" : "KaTBMZy-SPtX8-SWKA0s0$$6nnsgjZZLNuuHI-mrwVU_",
        "targetPort" : "RL8KxzvNpGU1zB0My3ZNp$$TfTEG1cI-s6vpmCjLgv94"
      }, {
        "id" : "Q3ArhkkBJEH15i-ho1FLT",
        "source" : "WVI0LfzUY9bp5AASNXkqv$$2ExnyDXyRxn2O93fXNwYO",
        "sourcePort" : "JfGHSjrPhlfhfFku3PimN$$cnsyT1jxIMwMwcOoynOId",
        "target" : "OfNKEZh_TAWfJS_Pb3vLF$$yvDnLeybFwrsZwCE9_vhs",
        "targetPort" : "ZHoNX-PEIGYcAoxTWl7pW$$zrfA6yQH9WOY_hearWgjJ"
      }, {
        "id" : "xWRl95GBpuqA5SeutcErv",
        "source" : "WVI0LfzUY9bp5AASNXkqv$$2ExnyDXyRxn2O93fXNwYO",
        "sourcePort" : "yBIZnBRX1pirm5UzpoxLk$$5dckQcVsjY-HEEtEG8Fxu",
        "target" : "OfNKEZh_TAWfJS_Pb3vLF$$yvDnLeybFwrsZwCE9_vhs",
        "targetPort" : "kUI_SUBX1QSCCaLXYEGkV$$klRaCXgI81QOybyX6EjEk"
      }, {
        "id" : "5YYqJeqWTbh2hfZlAGK5R",
        "source" : "KaTBMZy-SPtX8-SWKA0s0$$6nnsgjZZLNuuHI-mrwVU_",
        "sourcePort" : "9oZw8doqQPj9NtGpbospE$$zAbdL-PnnoBeFjdizOyUW",
        "target" : "WVI0LfzUY9bp5AASNXkqv$$2ExnyDXyRxn2O93fXNwYO",
        "targetPort" : "XwoUws3LSBm29xSPbi4fY$$0aFqkvaZkJCjRagbRtzE6"
      } ],
      "processes" : {
        "OfNKEZh_TAWfJS_Pb3vLF$$yvDnLeybFwrsZwCE9_vhs" : {
          "id" : "OfNKEZh_TAWfJS_Pb3vLF$$yvDnLeybFwrsZwCE9_vhs",
          "component" : "Join",
          "metadata" : {
            "label" : "by_person_and_ingredient_concept_id",
            "slug" : "by_person_and_ingredient_concept_id",
            "x" : 360,
            "y" : 2200,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "ZHoNX-PEIGYcAoxTWl7pW$$zrfA6yQH9WOY_hearWgjJ",
              "slug" : "dt",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "drug_exposure_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ingredient_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_start_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "days_supply",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_end_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "kUI_SUBX1QSCCaLXYEGkV$$klRaCXgI81QOybyX6EjEk",
              "slug" : "e",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ingredient_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "end_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "TxHViD-6IWEeLhmJCtXNQ$$eyPOqUihqKOgfvVVbRL3A",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "conditions" : [ {
              "alias" : "e",
              "expression" : {
                "format" : "sql",
                "expression" : "e.person_id = dt.person_id\nAND dt.ingredient_concept_id = e.ingredient_concept_id\nAND e.end_datetime >= dt.drug_exposure_start_datetime"
              },
              "joinType" : "inner"
            } ],
            "expressions" : [ {
              "target" : "drug_exposure_id",
              "expression" : {
                "format" : "sql",
                "expression" : "dt.drug_exposure_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "dt.person_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "ingredient_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "dt.ingredient_concept_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "drug_exposure_start_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "dt.drug_exposure_start_datetime"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "days_supply",
              "expression" : {
                "format" : "sql",
                "expression" : "dt.days_supply"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "drug_exposure_end_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "dt.drug_exposure_end_datetime"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "end_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "e.end_datetime"
              },
              "description" : "",
              "_row_id" : null
            } ],
            "hints" : [ {
              "id" : "ZHoNX-PEIGYcAoxTWl7pW$$zrfA6yQH9WOY_hearWgjJ$$ctlj79BUwR4QSx8hQ9Iic",
              "alias" : "dt",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "kUI_SUBX1QSCCaLXYEGkV$$klRaCXgI81QOybyX6EjEk$$HKUv8ycczGw9AXr7S5UMO",
              "alias" : "e",
              "hintType" : "none",
              "propagateColumns" : false
            } ],
            "allIn1" : null,
            "activeTab" : "expressions",
            "columnsSelector" : [ "ZHoNX-PEIGYcAoxTWl7pW$$zrfA6yQH9WOY_hearWgjJ$$ctlj79BUwR4QSx8hQ9Iic##drug_exposure_start_datetime", "ZHoNX-PEIGYcAoxTWl7pW$$zrfA6yQH9WOY_hearWgjJ$$ctlj79BUwR4QSx8hQ9Iic##person_id", "kUI_SUBX1QSCCaLXYEGkV$$klRaCXgI81QOybyX6EjEk$$HKUv8ycczGw9AXr7S5UMO##person_id", "kUI_SUBX1QSCCaLXYEGkV$$klRaCXgI81QOybyX6EjEk$$HKUv8ycczGw9AXr7S5UMO##end_datetime", "kUI_SUBX1QSCCaLXYEGkV$$klRaCXgI81QOybyX6EjEk$$HKUv8ycczGw9AXr7S5UMO##ingredient_concept_id", "ZHoNX-PEIGYcAoxTWl7pW$$zrfA6yQH9WOY_hearWgjJ$$ctlj79BUwR4QSx8hQ9Iic##ingredient_concept_id", "ZHoNX-PEIGYcAoxTWl7pW$$zrfA6yQH9WOY_hearWgjJ$$ctlj79BUwR4QSx8hQ9Iic##drug_exposure_start_datetime", "ZHoNX-PEIGYcAoxTWl7pW$$zrfA6yQH9WOY_hearWgjJ$$ctlj79BUwR4QSx8hQ9Iic##drug_exposure_end_datetime", "ZHoNX-PEIGYcAoxTWl7pW$$zrfA6yQH9WOY_hearWgjJ$$ctlj79BUwR4QSx8hQ9Iic##person_id", "kUI_SUBX1QSCCaLXYEGkV$$klRaCXgI81QOybyX6EjEk$$HKUv8ycczGw9AXr7S5UMO##end_datetime", "ZHoNX-PEIGYcAoxTWl7pW$$zrfA6yQH9WOY_hearWgjJ$$ctlj79BUwR4QSx8hQ9Iic##ingredient_concept_id", "ZHoNX-PEIGYcAoxTWl7pW$$zrfA6yQH9WOY_hearWgjJ$$ctlj79BUwR4QSx8hQ9Iic##days_supply", "ZHoNX-PEIGYcAoxTWl7pW$$zrfA6yQH9WOY_hearWgjJ$$ctlj79BUwR4QSx8hQ9Iic##drug_exposure_id" ],
            "allIn0" : null,
            "whereClause" : null,
            "headAlias" : "dt"
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Join",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "ei5KM-OdRfj0Vi-__2zQu$$Zme__0Sibxw_RA1so2tYJ" : {
          "id" : "ei5KM-OdRfj0Vi-__2zQu$$Zme__0Sibxw_RA1so2tYJ",
          "component" : "Aggregate",
          "metadata" : {
            "label" : "sub_exposure_end_by_person_and_ingredient",
            "slug" : "sub_exposure_end_by_person_and_ingredient",
            "x" : 520,
            "y" : 2200,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "YlpSMtBbtHs7sU3FWWaJf$$p-VA-_T-l-gkAeyXJgP00",
              "slug" : "by_person_and_ingredient_concept_id",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "drug_exposure_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ingredient_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_start_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "days_supply",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_end_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "end_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "HoNmg9s42NGzf6yvhLWwS$$brhdE66VB4XWhRwIJCkT1",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "allIns" : false,
            "doPivot" : false,
            "aggregate" : [ {
              "_row_id" : "c_453",
              "target" : "drug_sub_exposure_end_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "min(end_datetime)"
              },
              "description" : ""
            } ],
            "allowSelection" : true,
            "pivotColumn" : null,
            "pivotValues" : [ ],
            "activeTab" : "aggregate",
            "columnsSelector" : [ "YlpSMtBbtHs7sU3FWWaJf$$p-VA-_T-l-gkAeyXJgP00$$hiXHHHwv3zumkmxZ1BTrF##drug_exposure_start_datetime", "YlpSMtBbtHs7sU3FWWaJf$$p-VA-_T-l-gkAeyXJgP00$$hiXHHHwv3zumkmxZ1BTrF##end_datetime", "YlpSMtBbtHs7sU3FWWaJf$$p-VA-_T-l-gkAeyXJgP00$$hiXHHHwv3zumkmxZ1BTrF##person_id", "YlpSMtBbtHs7sU3FWWaJf$$p-VA-_T-l-gkAeyXJgP00$$hiXHHHwv3zumkmxZ1BTrF##ingredient_concept_id", "YlpSMtBbtHs7sU3FWWaJf$$p-VA-_T-l-gkAeyXJgP00$$hiXHHHwv3zumkmxZ1BTrF##drug_exposure_id" ],
            "groupBy" : [ {
              "target" : "drug_exposure_id",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_exposure_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "ingredient_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "ingredient_concept_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "drug_exposure_start_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_exposure_start_datetime"
              },
              "description" : "",
              "_row_id" : null
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Aggregate",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "KaTBMZy-SPtX8-SWKA0s0$$6nnsgjZZLNuuHI-mrwVU_" : {
          "id" : "KaTBMZy-SPtX8-SWKA0s0$$6nnsgjZZLNuuHI-mrwVU_",
          "component" : "Reformat",
          "metadata" : {
            "label" : "drug_exposure_details",
            "slug" : "drug_exposure_details",
            "x" : 660,
            "y" : 2200,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "RL8KxzvNpGU1zB0My3ZNp$$TfTEG1cI-s6vpmCjLgv94",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "drug_exposure_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ingredient_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_start_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_sub_exposure_end_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "9oZw8doqQPj9NtGpbospE$$zAbdL-PnnoBeFjdizOyUW",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "drug_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "ingredient_concept_id"
              },
              "description" : ""
            }, {
              "target" : "drug_exposure_start_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_exposure_start_datetime"
              },
              "description" : ""
            }, {
              "target" : "drug_sub_exposure_end_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_sub_exposure_end_datetime"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "RL8KxzvNpGU1zB0My3ZNp$$TfTEG1cI-s6vpmCjLgv94$$2uNWCkM7pILyy1lc9Ha6H##drug_sub_exposure_end_datetime", "RL8KxzvNpGU1zB0My3ZNp$$TfTEG1cI-s6vpmCjLgv94$$2uNWCkM7pILyy1lc9Ha6H##ingredient_concept_id", "RL8KxzvNpGU1zB0My3ZNp$$TfTEG1cI-s6vpmCjLgv94$$2uNWCkM7pILyy1lc9Ha6H##drug_exposure_start_datetime", "RL8KxzvNpGU1zB0My3ZNp$$TfTEG1cI-s6vpmCjLgv94$$2uNWCkM7pILyy1lc9Ha6H##person_id" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        }
      }
    },
    "D4nxyD1G7edIkaHGvW7-3$$OxCv1kCSo6vF46H8gxNUx" : {
      "id" : "D4nxyD1G7edIkaHGvW7-3$$OxCv1kCSo6vF46H8gxNUx",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "cteEndDates2",
        "slug" : "cteEndDates2",
        "x" : -440,
        "y" : -180,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Find out how long each period of drug use lasted overall.\n"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "zu2mh4GMCAu8D7C1_J-nM$$LCPNrNIApy-zUX7T_BZyW",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "row_number",
              "type" : "integer",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "person_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_concept_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_sub_exposure_start_datetime",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_sub_exposure_end_datetime",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_exposure_count",
              "type" : "long",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "days_exposed",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "3HJV_fTOKnoFx2awl3cCB$$vhIqYTPLsib71HAe8r5HT",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "packageName" : "cteEndDates2",
        "externalId" : "subgraphs/cteEndDates2",
        "name" : "cteEndDates2"
      },
      "connections" : [ {
        "id" : "QXp5uPCMrDfgshO0aTyjE",
        "source" : "YfA7UzLBanOjYKUtAfEh-$$EBpQeF7SClBcQojyipW6l",
        "sourcePort" : "28ILQwDqBEVmV-5WA2GXZ$$ZZaYa3zyCnCIES4gXCsbG",
        "target" : "hJ60sjSqg2GRRZgBYxQ1_$$rBaw-t6pADmRdYPbZ4sqD",
        "targetPort" : "HEFkgaIcgCsh28hciLS8F$$H9YTbXH5RRRTSPONcIhHy"
      }, {
        "id" : "EV2vVLdbpd3DiafoIEB8W",
        "source" : "gxcqJ8-W_lqE1dpQMet2y$$DMoyX7kl3jvKGd79xWkql",
        "sourcePort" : "meHMdXTZU1CQXW2o1j1Pj$$s-2oAT83IrycI94fIv4vK",
        "target" : "hJ60sjSqg2GRRZgBYxQ1_$$rBaw-t6pADmRdYPbZ4sqD",
        "targetPort" : "y1QXdXOG7c9J3oZRP-PzZ$$Utw-HEQ9vPaILu5ehlhHB"
      }, {
        "id" : "2abn9P9vQ1buB0lHJZ8Ok",
        "source" : "hJ60sjSqg2GRRZgBYxQ1_$$rBaw-t6pADmRdYPbZ4sqD",
        "sourcePort" : "XVZqxX7sTheuPEESpSexj$$xmbF6aJD7jZWey_NW3Hta",
        "target" : "a2GLe7Cyek5uODgokR69N$$HqBUQHTxBnlGx5509tEdO",
        "targetPort" : "GYKI9LPeL1ZndiGGFyN5_$$ZbGjEY1dVgXid8m_g1Qeu"
      }, {
        "id" : "5ujecbX_lRhlDSeiRUhUf",
        "source" : "a2GLe7Cyek5uODgokR69N$$HqBUQHTxBnlGx5509tEdO",
        "sourcePort" : "k_wuvYf6dZmUXMi5VtH1x$$l6eurYuLX0bTkwAyJRUop",
        "target" : "jGCq0w6KTppRdxC9TD2tj$$Tlc7_rV75MNgyUUTL6eQ7",
        "targetPort" : "eLh9ROlAVHx2h4VqZu3th$$A_rudJqZHFhoc9lcqg792"
      }, {
        "id" : "QgNKQ48VtAzCVRgqLE91p",
        "source" : "jGCq0w6KTppRdxC9TD2tj$$Tlc7_rV75MNgyUUTL6eQ7",
        "sourcePort" : "w76dtKqlu_AJCI1TCubMd$$Zac_MeBMNwaYtgIdms1gu",
        "target" : "ncEnxU-1SXC7DWzx61D_4$$PRkURTiFI1kqhzpwakG9p",
        "targetPort" : "FML_Y9A4aA5WxHUlDdz4r$$fV1MVBBPmqjiybv51tHmM"
      }, {
        "id" : "DeO13IdvqFJAnp8mrYdQk",
        "source" : "D4nxyD1G7edIkaHGvW7-3$$OxCv1kCSo6vF46H8gxNUx",
        "sourcePort" : "zu2mh4GMCAu8D7C1_J-nM$$LCPNrNIApy-zUX7T_BZyW",
        "target" : "YfA7UzLBanOjYKUtAfEh-$$EBpQeF7SClBcQojyipW6l",
        "targetPort" : "p_JcQ4DnCM3F3yQ8T-4LS$$QxtAe70VstVx3HUU8gMtn"
      }, {
        "id" : "fg9AebzbdHoCp4D3kEaHY",
        "source" : "D4nxyD1G7edIkaHGvW7-3$$OxCv1kCSo6vF46H8gxNUx",
        "sourcePort" : "zu2mh4GMCAu8D7C1_J-nM$$LCPNrNIApy-zUX7T_BZyW",
        "target" : "gxcqJ8-W_lqE1dpQMet2y$$DMoyX7kl3jvKGd79xWkql",
        "targetPort" : "79rSr4VI6NcG1OY6RQ96K$$DPp9NvS2WyeuOpihSx9_n"
      }, {
        "id" : "A_O7CDakg8JJTNSdVTrSw",
        "source" : "ncEnxU-1SXC7DWzx61D_4$$PRkURTiFI1kqhzpwakG9p",
        "sourcePort" : "BzOch8sAo8_HR5JHmP-4e$$uXM4jaPhW2kjqntDXTWW5",
        "target" : "D4nxyD1G7edIkaHGvW7-3$$OxCv1kCSo6vF46H8gxNUx",
        "targetPort" : "3HJV_fTOKnoFx2awl3cCB$$vhIqYTPLsib71HAe8r5HT"
      } ],
      "processes" : {
        "YfA7UzLBanOjYKUtAfEh-$$EBpQeF7SClBcQojyipW6l" : {
          "id" : "YfA7UzLBanOjYKUtAfEh-$$EBpQeF7SClBcQojyipW6l",
          "component" : "Reformat",
          "metadata" : {
            "label" : "condition_start_ordinal",
            "slug" : "condition_start_ordinal",
            "x" : -1020,
            "y" : -260,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "p_JcQ4DnCM3F3yQ8T-4LS$$QxtAe70VstVx3HUU8gMtn",
              "slug" : "cteConditionTarget",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "row_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_sub_exposure_start_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_sub_exposure_end_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_count",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "days_exposed",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "28ILQwDqBEVmV-5WA2GXZ$$ZZaYa3zyCnCIES4gXCsbG",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "drug_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_concept_id"
              },
              "description" : ""
            }, {
              "target" : "event_date",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_sub_exposure_start_datetime"
              },
              "description" : ""
            }, {
              "target" : "event_type",
              "expression" : {
                "format" : "sql",
                "expression" : "-1"
              },
              "description" : ""
            }, {
              "target" : "start_ordinal",
              "expression" : {
                "format" : "sql",
                "expression" : "row_number() OVER (PARTITION BY person_id, drug_concept_id ORDER BY drug_sub_exposure_start_datetime)"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "p_JcQ4DnCM3F3yQ8T-4LS$$QxtAe70VstVx3HUU8gMtn##drug_concept_id", "p_JcQ4DnCM3F3yQ8T-4LS$$QxtAe70VstVx3HUU8gMtn##drug_sub_exposure_start_datetime", "p_JcQ4DnCM3F3yQ8T-4LS$$QxtAe70VstVx3HUU8gMtn##person_id" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "ncEnxU-1SXC7DWzx61D_4$$PRkURTiFI1kqhzpwakG9p" : {
          "id" : "ncEnxU-1SXC7DWzx61D_4$$PRkURTiFI1kqhzpwakG9p",
          "component" : "Reformat",
          "metadata" : {
            "label" : "by_person_condition_date",
            "slug" : "by_person_condition_date",
            "x" : -300,
            "y" : -180,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "FML_Y9A4aA5WxHUlDdz4r$$fV1MVBBPmqjiybv51tHmM",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_date",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_type",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_ordinal",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "overall_ord",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "BzOch8sAo8_HR5JHmP-4e$$uXM4jaPhW2kjqntDXTWW5",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "DRUG_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_concept_id"
              },
              "description" : ""
            }, {
              "target" : "end_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "date_add(event_date, -30)"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "FML_Y9A4aA5WxHUlDdz4r$$fV1MVBBPmqjiybv51tHmM##drug_concept_id", "FML_Y9A4aA5WxHUlDdz4r$$fV1MVBBPmqjiybv51tHmM##person_id", "FML_Y9A4aA5WxHUlDdz4r$$fV1MVBBPmqjiybv51tHmM##event_date" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "a2GLe7Cyek5uODgokR69N$$HqBUQHTxBnlGx5509tEdO" : {
          "id" : "a2GLe7Cyek5uODgokR69N$$HqBUQHTxBnlGx5509tEdO",
          "component" : "Reformat",
          "metadata" : {
            "label" : "e",
            "slug" : "e",
            "x" : -680,
            "y" : -180,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "GYKI9LPeL1ZndiGGFyN5_$$ZbGjEY1dVgXid8m_g1Qeu",
              "slug" : "RAWDATA_1",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_date",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_type",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_ordinal",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "k_wuvYf6dZmUXMi5VtH1x$$l6eurYuLX0bTkwAyJRUop",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "drug_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_concept_id"
              },
              "description" : ""
            }, {
              "target" : "event_date",
              "expression" : {
                "format" : "sql",
                "expression" : "event_date"
              },
              "description" : ""
            }, {
              "target" : "event_type",
              "expression" : {
                "format" : "sql",
                "expression" : "event_type"
              },
              "description" : ""
            }, {
              "target" : "start_ordinal",
              "expression" : {
                "format" : "sql",
                "expression" : "max(start_ordinal) over (partition by person_id, drug_concept_id ORDER BY event_date, event_type ROWS UNBOUNDED PRECEDING)"
              },
              "description" : ""
            }, {
              "target" : "overall_ord",
              "expression" : {
                "format" : "sql",
                "expression" : "row_number() OVER (PARTITION BY person_id, drug_concept_id ORDER BY event_date, event_type)"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "GYKI9LPeL1ZndiGGFyN5_$$ZbGjEY1dVgXid8m_g1Qeu##drug_concept_id", "GYKI9LPeL1ZndiGGFyN5_$$ZbGjEY1dVgXid8m_g1Qeu##event_type", "GYKI9LPeL1ZndiGGFyN5_$$ZbGjEY1dVgXid8m_g1Qeu##event_date", "GYKI9LPeL1ZndiGGFyN5_$$ZbGjEY1dVgXid8m_g1Qeu##person_id" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "hJ60sjSqg2GRRZgBYxQ1_$$rBaw-t6pADmRdYPbZ4sqD" : {
          "id" : "hJ60sjSqg2GRRZgBYxQ1_$$rBaw-t6pADmRdYPbZ4sqD",
          "component" : "SetOperation",
          "metadata" : {
            "label" : "RAWDATA_1",
            "slug" : "RAWDATA_1",
            "x" : -840,
            "y" : -180,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "HEFkgaIcgCsh28hciLS8F$$H9YTbXH5RRRTSPONcIhHy",
              "slug" : "condition_start_ordinal",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_date",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_type",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_ordinal",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "y1QXdXOG7c9J3oZRP-PzZ$$Utw-HEQ9vPaILu5ehlhHB",
              "slug" : "condition_events_projection",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_type",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_ordinal",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "XVZqxX7sTheuPEESpSexj$$xmbF6aJD7jZWey_NW3Hta",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "operationType" : "unionAll",
            "allowMissingColumns" : false
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/SetOperation",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "jGCq0w6KTppRdxC9TD2tj$$Tlc7_rV75MNgyUUTL6eQ7" : {
          "id" : "jGCq0w6KTppRdxC9TD2tj$$Tlc7_rV75MNgyUUTL6eQ7",
          "component" : "Filter",
          "metadata" : {
            "label" : "filter_by_start_ordinal",
            "slug" : "filter_by_start_ordinal",
            "x" : -520,
            "y" : -180,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "eLh9ROlAVHx2h4VqZu3th$$A_rudJqZHFhoc9lcqg792",
              "slug" : "e",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_date",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_type",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_ordinal",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "overall_ord",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "w76dtKqlu_AJCI1TCubMd$$Zac_MeBMNwaYtgIdms1gu",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "condition" : {
              "format" : "sql",
              "expression" : "(2*start_ordinal) - overall_ord = 0"
            }
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Filter",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "gxcqJ8-W_lqE1dpQMet2y$$DMoyX7kl3jvKGd79xWkql" : {
          "id" : "gxcqJ8-W_lqE1dpQMet2y$$DMoyX7kl3jvKGd79xWkql",
          "component" : "Reformat",
          "metadata" : {
            "label" : "condition_events_projection",
            "slug" : "condition_events_projection",
            "x" : -1020,
            "y" : -100,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "79rSr4VI6NcG1OY6RQ96K$$DPp9NvS2WyeuOpihSx9_n",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "row_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_sub_exposure_start_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_sub_exposure_end_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_count",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "days_exposed",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "meHMdXTZU1CQXW2o1j1Pj$$s-2oAT83IrycI94fIv4vK",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "drug_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_concept_id"
              },
              "description" : ""
            }, {
              "target" : "event_date",
              "expression" : {
                "format" : "sql",
                "expression" : "date_add(drug_sub_exposure_end_datetime, 30)"
              },
              "description" : ""
            }, {
              "target" : "event_type",
              "expression" : {
                "format" : "sql",
                "expression" : "1"
              },
              "description" : ""
            }, {
              "target" : "start_ordinal",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(NULL as integer)"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "79rSr4VI6NcG1OY6RQ96K$$DPp9NvS2WyeuOpihSx9_n##drug_sub_exposure_end_datetime", "79rSr4VI6NcG1OY6RQ96K$$DPp9NvS2WyeuOpihSx9_n##drug_concept_id", "79rSr4VI6NcG1OY6RQ96K$$DPp9NvS2WyeuOpihSx9_n##person_id" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        }
      }
    },
    "Pg_229JeG7d1q-UxC2zy1$$5xlf3L7Dv5XHPS04AVgcy" : {
      "id" : "Pg_229JeG7d1q-UxC2zy1$$5xlf3L7Dv5XHPS04AVgcy",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "cteEndDates1",
        "slug" : "cteEndDates1",
        "x" : -1100,
        "y" : -580,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "kGcOe1_P0jXDy7CIR-Ozm$$4j5WmhB6RBJt_WY6VN-d_",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "CONDITION_OCCURRENCE_ID",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "person_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "CONDITION_CONCEPT_ID",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "CONDITION_START_DATETIME",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "CONDITION_END_DATETIME",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "7t4Pl6AfTHoul9kGEEI9s$$Bz_TF1etZhMG9ephg43VL",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "packageName" : "cteEndDates",
        "externalId" : "subgraphs/cteEndDates",
        "name" : "cteEndDates1"
      },
      "connections" : [ {
        "id" : "ZF0YDpxhAAdTVRZm7DVkL",
        "source" : "QYYsEJRqVJ4D1cPYqu82g$$23OW8Dihi_X9_rFfzEAwk",
        "sourcePort" : "JctuL6RbvwAh0GUcJNaxU$$uPcGcAcj6ib4UDiSJhdr8",
        "target" : "jSL__XEnbCM3VrULSq1Vo$$ZvKWmy966kCzS7XS0C-3C",
        "targetPort" : "vDmFBy-oJCkakBlntO_w4$$-t6oOUhgnsH2oWeFncmAf"
      }, {
        "id" : "gQHgfvd2po2B2FMSnYTTF",
        "source" : "PUmS7wD3bnw-4a59l1x--$$xAEIowHT9bi1eGEvbAfLf",
        "sourcePort" : "TFNb-jfMLsHc1vyhGSjdl$$vUoe9YUhUZHVz0RRY6Uc9",
        "target" : "jSL__XEnbCM3VrULSq1Vo$$ZvKWmy966kCzS7XS0C-3C",
        "targetPort" : "eh5KV4CyFGoc8R5qkVriv$$BARLkdbSxoL2wgEQMqsyX"
      }, {
        "id" : "VjodSPHTN04D2l0QSlR2B",
        "source" : "jSL__XEnbCM3VrULSq1Vo$$ZvKWmy966kCzS7XS0C-3C",
        "sourcePort" : "bsUp3D5NGnTKVW-i-hBs3$$YoTfD65lsf4swIW4I8Wm0",
        "target" : "ob6een3C__EMbzAtURGa-$$4hl10NnYLZ3SCNm4X5oy8",
        "targetPort" : "zAImrHndTkC6uVAZagnQR$$mHCvNdz6XIUoJP_t-U3bh"
      }, {
        "id" : "wmAnCw7ikSYa1-ZJ5hQIO",
        "source" : "ob6een3C__EMbzAtURGa-$$4hl10NnYLZ3SCNm4X5oy8",
        "sourcePort" : "6gGCaIXCtzL9pwx9EXPci$$U-1btivfyWGDFgb4xC5Ti",
        "target" : "_AtjB5DIntpJbnp2mGXGU$$giTTnXAbJXZH7YbKpz-n1",
        "targetPort" : "SDOo7twtrqzUcHm2uJOhy$$HBQL2Yt1-jo18j87tYXGA"
      }, {
        "id" : "eqINvHK5LQsTuQbHbLFGP",
        "source" : "Pg_229JeG7d1q-UxC2zy1$$5xlf3L7Dv5XHPS04AVgcy",
        "sourcePort" : "kGcOe1_P0jXDy7CIR-Ozm$$4j5WmhB6RBJt_WY6VN-d_",
        "target" : "QYYsEJRqVJ4D1cPYqu82g$$23OW8Dihi_X9_rFfzEAwk",
        "targetPort" : "Cc0cmmwYAEqT80tNc8QA-$$nRUMeDXWyvSGYn16s5iUT"
      }, {
        "id" : "bGDRvbWgSIuqiZUin-AhI",
        "source" : "Pg_229JeG7d1q-UxC2zy1$$5xlf3L7Dv5XHPS04AVgcy",
        "sourcePort" : "kGcOe1_P0jXDy7CIR-Ozm$$4j5WmhB6RBJt_WY6VN-d_",
        "target" : "PUmS7wD3bnw-4a59l1x--$$xAEIowHT9bi1eGEvbAfLf",
        "targetPort" : "TQZowgx7XVzuPcqKGfJYu$$ia6hSyp0PFQYgZE5DeKsC"
      }, {
        "id" : "cjnU_saXlamSJCKN8RXM5",
        "source" : "_AtjB5DIntpJbnp2mGXGU$$giTTnXAbJXZH7YbKpz-n1",
        "sourcePort" : "jpo-sJ7NCspgTAJoGgh7O$$1572kOHWlNrb5cKqJ32I0",
        "target" : "-VFo_HevXTTnR98VRGdgv$$XV7ZriVRP1avBwCL24GQK",
        "targetPort" : "9Y7xI-e6xePiny6zCEfkT$$vaWcKa0LE2xYrlq4EKy7-"
      }, {
        "id" : "BaSpBdNM1BGkjy88_8waG",
        "source" : "-VFo_HevXTTnR98VRGdgv$$XV7ZriVRP1avBwCL24GQK",
        "sourcePort" : "F-njNOQm9l6fz-gJjDPbI$$Ah-c19KSniDOOaoNm8JaH",
        "target" : "Pg_229JeG7d1q-UxC2zy1$$5xlf3L7Dv5XHPS04AVgcy",
        "targetPort" : "7t4Pl6AfTHoul9kGEEI9s$$Bz_TF1etZhMG9ephg43VL"
      } ],
      "processes" : {
        "QYYsEJRqVJ4D1cPYqu82g$$23OW8Dihi_X9_rFfzEAwk" : {
          "id" : "QYYsEJRqVJ4D1cPYqu82g$$23OW8Dihi_X9_rFfzEAwk",
          "component" : "Reformat",
          "metadata" : {
            "label" : "condition_start_ordinal",
            "slug" : "condition_start_ordinal",
            "x" : 80,
            "y" : 1840,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Cc0cmmwYAEqT80tNc8QA-$$nRUMeDXWyvSGYn16s5iUT",
              "slug" : "cteConditionTarget",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "CONDITION_OCCURRENCE_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_START_DATETIME",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_END_DATETIME",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "JctuL6RbvwAh0GUcJNaxU$$uPcGcAcj6ib4UDiSJhdr8",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "CONDITION_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "CONDITION_CONCEPT_ID"
              },
              "description" : ""
            }, {
              "target" : "event_date",
              "expression" : {
                "format" : "sql",
                "expression" : "CONDITION_START_DATETIME"
              },
              "description" : ""
            }, {
              "target" : "event_type",
              "expression" : {
                "format" : "sql",
                "expression" : "-1"
              },
              "description" : ""
            }, {
              "target" : "start_ordinal",
              "expression" : {
                "format" : "sql",
                "expression" : "row_number() OVER (PARTITION BY person_id, CONDITION_CONCEPT_ID ORDER BY CONDITION_START_DATETIME)"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "Cc0cmmwYAEqT80tNc8QA-$$hgD1T-2WIn85snb3q09Vt$$T3JHDqNyAR4av9ZxQM310$$nRUMeDXWyvSGYn16s5iUT##CONDITION_CONCEPT_ID", "Cc0cmmwYAEqT80tNc8QA-$$hgD1T-2WIn85snb3q09Vt$$T3JHDqNyAR4av9ZxQM310$$nRUMeDXWyvSGYn16s5iUT##person_id", "Cc0cmmwYAEqT80tNc8QA-$$hgD1T-2WIn85snb3q09Vt$$T3JHDqNyAR4av9ZxQM310$$nRUMeDXWyvSGYn16s5iUT##CONDITION_START_DATETIME" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "jSL__XEnbCM3VrULSq1Vo$$ZvKWmy966kCzS7XS0C-3C" : {
          "id" : "jSL__XEnbCM3VrULSq1Vo$$ZvKWmy966kCzS7XS0C-3C",
          "component" : "SetOperation",
          "metadata" : {
            "label" : "RAWDATA_1",
            "slug" : "RAWDATA_1",
            "x" : 260,
            "y" : 1920,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "vDmFBy-oJCkakBlntO_w4$$-t6oOUhgnsH2oWeFncmAf",
              "slug" : "condition_start_ordinal",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_date",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_type",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_ordinal",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "eh5KV4CyFGoc8R5qkVriv$$BARLkdbSxoL2wgEQMqsyX",
              "slug" : "condition_events_projection",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_type",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_ordinal",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "bsUp3D5NGnTKVW-i-hBs3$$YoTfD65lsf4swIW4I8Wm0",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "operationType" : "unionAll",
            "allowMissingColumns" : false
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/SetOperation",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "ob6een3C__EMbzAtURGa-$$4hl10NnYLZ3SCNm4X5oy8" : {
          "id" : "ob6een3C__EMbzAtURGa-$$4hl10NnYLZ3SCNm4X5oy8",
          "component" : "Reformat",
          "metadata" : {
            "label" : "e",
            "slug" : "e",
            "x" : 420,
            "y" : 1920,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "zAImrHndTkC6uVAZagnQR$$mHCvNdz6XIUoJP_t-U3bh",
              "slug" : "RAWDATA_1",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_date",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_type",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_ordinal",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "6gGCaIXCtzL9pwx9EXPci$$U-1btivfyWGDFgb4xC5Ti",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "CONDITION_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "CONDITION_CONCEPT_ID"
              },
              "description" : ""
            }, {
              "target" : "event_date",
              "expression" : {
                "format" : "sql",
                "expression" : "event_date"
              },
              "description" : ""
            }, {
              "target" : "event_type",
              "expression" : {
                "format" : "sql",
                "expression" : "event_type"
              },
              "description" : ""
            }, {
              "target" : "start_ordinal",
              "expression" : {
                "format" : "sql",
                "expression" : "max(start_ordinal) over (partition by person_id, CONDITION_CONCEPT_ID ORDER BY event_date, event_type ROWS UNBOUNDED PRECEDING)"
              },
              "description" : ""
            }, {
              "target" : "overall_ord",
              "expression" : {
                "format" : "sql",
                "expression" : "row_number() OVER (PARTITION BY person_id, CONDITION_CONCEPT_ID ORDER BY event_date, event_type)"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "zAImrHndTkC6uVAZagnQR$$5KI9i-cNE24On6WBXkF-C$$WgSoDSSS-fKjJB89Bb916$$mHCvNdz6XIUoJP_t-U3bh##event_date", "zAImrHndTkC6uVAZagnQR$$5KI9i-cNE24On6WBXkF-C$$WgSoDSSS-fKjJB89Bb916$$mHCvNdz6XIUoJP_t-U3bh##event_type", "zAImrHndTkC6uVAZagnQR$$5KI9i-cNE24On6WBXkF-C$$WgSoDSSS-fKjJB89Bb916$$mHCvNdz6XIUoJP_t-U3bh##person_id", "zAImrHndTkC6uVAZagnQR$$5KI9i-cNE24On6WBXkF-C$$WgSoDSSS-fKjJB89Bb916$$mHCvNdz6XIUoJP_t-U3bh##CONDITION_CONCEPT_ID" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "PUmS7wD3bnw-4a59l1x--$$xAEIowHT9bi1eGEvbAfLf" : {
          "id" : "PUmS7wD3bnw-4a59l1x--$$xAEIowHT9bi1eGEvbAfLf",
          "component" : "Reformat",
          "metadata" : {
            "label" : "condition_events_projection",
            "slug" : "condition_events_projection",
            "x" : 80,
            "y" : 2000,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TQZowgx7XVzuPcqKGfJYu$$ia6hSyp0PFQYgZE5DeKsC",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "CONDITION_OCCURRENCE_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_START_DATETIME",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_END_DATETIME",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "TFNb-jfMLsHc1vyhGSjdl$$vUoe9YUhUZHVz0RRY6Uc9",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "CONDITION_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "CONDITION_CONCEPT_ID"
              },
              "description" : ""
            }, {
              "target" : "event_date",
              "expression" : {
                "format" : "sql",
                "expression" : "date_add(CONDITION_END_DATETIME, 30)"
              },
              "description" : ""
            }, {
              "target" : "event_type",
              "expression" : {
                "format" : "sql",
                "expression" : "1"
              },
              "description" : ""
            }, {
              "target" : "start_ordinal",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(NULL as integer)"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "TQZowgx7XVzuPcqKGfJYu$$WTHuHhF3lcDx8roKbG8t5$$-CFdbr3A9mUdMo1jVJhCR$$ia6hSyp0PFQYgZE5DeKsC##CONDITION_CONCEPT_ID", "TQZowgx7XVzuPcqKGfJYu$$WTHuHhF3lcDx8roKbG8t5$$-CFdbr3A9mUdMo1jVJhCR$$ia6hSyp0PFQYgZE5DeKsC##CONDITION_END_DATETIME", "TQZowgx7XVzuPcqKGfJYu$$WTHuHhF3lcDx8roKbG8t5$$-CFdbr3A9mUdMo1jVJhCR$$ia6hSyp0PFQYgZE5DeKsC##person_id" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "-VFo_HevXTTnR98VRGdgv$$XV7ZriVRP1avBwCL24GQK" : {
          "id" : "-VFo_HevXTTnR98VRGdgv$$XV7ZriVRP1avBwCL24GQK",
          "component" : "Reformat",
          "metadata" : {
            "label" : "by_person_condition_date",
            "slug" : "by_person_condition_date",
            "x" : 800,
            "y" : 1920,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "9Y7xI-e6xePiny6zCEfkT$$vaWcKa0LE2xYrlq4EKy7-",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_date",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_type",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_ordinal",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "overall_ord",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "F-njNOQm9l6fz-gJjDPbI$$Ah-c19KSniDOOaoNm8JaH",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "CONDITION_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "CONDITION_CONCEPT_ID"
              },
              "description" : ""
            }, {
              "target" : "end_date",
              "expression" : {
                "format" : "sql",
                "expression" : "date_add(event_date, -30)"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "9Y7xI-e6xePiny6zCEfkT$$GSftf1jsyve-b_e_08tyF$$HFVIictXr9fCyTSX8fGcy$$vaWcKa0LE2xYrlq4EKy7-##person_id", "9Y7xI-e6xePiny6zCEfkT$$GSftf1jsyve-b_e_08tyF$$HFVIictXr9fCyTSX8fGcy$$vaWcKa0LE2xYrlq4EKy7-##event_date", "9Y7xI-e6xePiny6zCEfkT$$GSftf1jsyve-b_e_08tyF$$HFVIictXr9fCyTSX8fGcy$$vaWcKa0LE2xYrlq4EKy7-##CONDITION_CONCEPT_ID" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "_AtjB5DIntpJbnp2mGXGU$$giTTnXAbJXZH7YbKpz-n1" : {
          "id" : "_AtjB5DIntpJbnp2mGXGU$$giTTnXAbJXZH7YbKpz-n1",
          "component" : "Filter",
          "metadata" : {
            "label" : "filter_by_start_ordinal",
            "slug" : "filter_by_start_ordinal",
            "x" : 580,
            "y" : 1920,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "SDOo7twtrqzUcHm2uJOhy$$HBQL2Yt1-jo18j87tYXGA",
              "slug" : "e",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_date",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "event_type",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_ordinal",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "overall_ord",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "jpo-sJ7NCspgTAJoGgh7O$$1572kOHWlNrb5cKqJ32I0",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ "SDOo7twtrqzUcHm2uJOhy$$AFovUfnjas6mCT2WrhidN$$0O4ox-X_tA8_oQiuv3cJ6$$HBQL2Yt1-jo18j87tYXGA##overall_ord", "SDOo7twtrqzUcHm2uJOhy$$AFovUfnjas6mCT2WrhidN$$0O4ox-X_tA8_oQiuv3cJ6$$HBQL2Yt1-jo18j87tYXGA##start_ordinal" ],
            "condition" : {
              "format" : "sql",
              "expression" : "(2*start_ordinal) - overall_ord = 0"
            }
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Filter",
            "projectName" : "ProphecySparkBasicsPython"
          }
        }
      }
    },
    "W9YcCVxRV2wupO8rFkw1c$$ke-1YvjhCzmpz0wkDHvV3" : {
      "id" : "W9YcCVxRV2wupO8rFkw1c$$ke-1YvjhCzmpz0wkDHvV3",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "cteSubExposures",
        "slug" : "cteSubExposures",
        "x" : -800,
        "y" : -300,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Further refine the data to understand each period of drug use better, including how long each period lasted."
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Z24a34rS_ibUZvy3Lcd--$$EN7Tn-NPtVxqXMjIvBxHK",
          "slug" : "cteDrugExposureEnds",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "person_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_concept_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_exposure_start_datetime",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_sub_exposure_end_datetime",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "JoKlCL-nM6vv5S0KQ4gCp$$_Ufpjo2UEv7nv3p4Rb9RU",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "packageName" : "cteSubExposures",
        "externalId" : "subgraphs/cteSubExposures",
        "name" : "cteSubExposures"
      },
      "connections" : [ {
        "id" : "Dd7Fh78ov9qGvg3quNECM",
        "source" : "4y5yxzjnIpc-F8At_oZz5$$QAN_wkOmnJGHehRjTHUMU",
        "sourcePort" : "hYjz3jzY3cn56iawKVh_N$$QPmP-kUdvxHbtqPZCR5so",
        "target" : "B_CNa5MfV-wBu5DlDmj9e$$u-ZZla4bSBBf_ksEErBk-",
        "targetPort" : "WhZ9W0mK3T47E5hFycNin$$BIxXBMx1PAjvpDawOUesH"
      }, {
        "id" : "jlVvypHC58cWZOMF9oKRJ",
        "source" : "W9YcCVxRV2wupO8rFkw1c$$ke-1YvjhCzmpz0wkDHvV3",
        "sourcePort" : "Z24a34rS_ibUZvy3Lcd--$$EN7Tn-NPtVxqXMjIvBxHK",
        "target" : "4y5yxzjnIpc-F8At_oZz5$$QAN_wkOmnJGHehRjTHUMU",
        "targetPort" : "35vVu8cHpqxgM0mZdFm0n$$shuC5fSAGkxyBht1i_zGB"
      }, {
        "id" : "uU-EQpnwomL8tysYQoSCs",
        "source" : "B_CNa5MfV-wBu5DlDmj9e$$u-ZZla4bSBBf_ksEErBk-",
        "sourcePort" : "o7HBNSX75qbcuKAn5NCJV$$Z87KOenPzHMmrVdmMcoYg",
        "target" : "W9YcCVxRV2wupO8rFkw1c$$ke-1YvjhCzmpz0wkDHvV3",
        "targetPort" : "JoKlCL-nM6vv5S0KQ4gCp$$_Ufpjo2UEv7nv3p4Rb9RU"
      } ],
      "processes" : {
        "4y5yxzjnIpc-F8At_oZz5$$QAN_wkOmnJGHehRjTHUMU" : {
          "id" : "4y5yxzjnIpc-F8At_oZz5$$QAN_wkOmnJGHehRjTHUMU",
          "component" : "Aggregate",
          "metadata" : {
            "label" : "drug_exposure_summary",
            "slug" : "drug_exposure_summary",
            "x" : 640,
            "y" : 2220,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "35vVu8cHpqxgM0mZdFm0n$$shuC5fSAGkxyBht1i_zGB",
              "slug" : "cteDrugExposureEnds",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_start_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_sub_exposure_end_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "hYjz3jzY3cn56iawKVh_N$$QPmP-kUdvxHbtqPZCR5so",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "allIns" : false,
            "doPivot" : false,
            "aggregate" : [ {
              "_row_id" : "c_481",
              "target" : "drug_sub_exposure_start_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "min(drug_exposure_start_datetime)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_482",
              "target" : "drug_exposure_count",
              "expression" : {
                "format" : "sql",
                "expression" : "count(*)"
              },
              "description" : ""
            } ],
            "allowSelection" : true,
            "pivotColumn" : null,
            "pivotValues" : [ ],
            "activeTab" : "aggregate",
            "columnsSelector" : [ "35vVu8cHpqxgM0mZdFm0n$$shuC5fSAGkxyBht1i_zGB$$sofidxrXne1xkHU48aVp7##person_id", "35vVu8cHpqxgM0mZdFm0n$$shuC5fSAGkxyBht1i_zGB$$sofidxrXne1xkHU48aVp7##drug_sub_exposure_end_datetime", "35vVu8cHpqxgM0mZdFm0n$$shuC5fSAGkxyBht1i_zGB$$sofidxrXne1xkHU48aVp7##drug_exposure_start_datetime", "35vVu8cHpqxgM0mZdFm0n$$shuC5fSAGkxyBht1i_zGB$$sofidxrXne1xkHU48aVp7##drug_concept_id" ],
            "groupBy" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "drug_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_concept_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "drug_sub_exposure_end_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_sub_exposure_end_datetime"
              },
              "description" : "",
              "_row_id" : null
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Aggregate",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "B_CNa5MfV-wBu5DlDmj9e$$u-ZZla4bSBBf_ksEErBk-" : {
          "id" : "B_CNa5MfV-wBu5DlDmj9e$$u-ZZla4bSBBf_ksEErBk-",
          "component" : "Reformat",
          "metadata" : {
            "label" : "drug_exposure_summary_reformatted",
            "slug" : "drug_exposure_summary_reformatted",
            "x" : 800,
            "y" : 2220,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "WhZ9W0mK3T47E5hFycNin$$BIxXBMx1PAjvpDawOUesH",
              "slug" : "drug_exposure_summary",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_sub_exposure_end_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_sub_exposure_start_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_count",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "o7HBNSX75qbcuKAn5NCJV$$Z87KOenPzHMmrVdmMcoYg",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "row_number",
              "expression" : {
                "format" : "sql",
                "expression" : "row_number() OVER (PARTITION BY person_id, drug_concept_id, drug_sub_exposure_end_datetime ORDER BY person_id)"
              },
              "description" : ""
            }, {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "drug_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_concept_id"
              },
              "description" : ""
            }, {
              "target" : "drug_sub_exposure_start_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_sub_exposure_start_datetime"
              },
              "description" : ""
            }, {
              "target" : "drug_sub_exposure_end_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_sub_exposure_end_datetime"
              },
              "description" : ""
            }, {
              "target" : "drug_exposure_count",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_exposure_count"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "WhZ9W0mK3T47E5hFycNin$$BIxXBMx1PAjvpDawOUesH$$5VmAv0otjURE18Ujol3K-##drug_exposure_count", "WhZ9W0mK3T47E5hFycNin$$BIxXBMx1PAjvpDawOUesH$$5VmAv0otjURE18Ujol3K-##drug_sub_exposure_start_datetime", "WhZ9W0mK3T47E5hFycNin$$BIxXBMx1PAjvpDawOUesH$$5VmAv0otjURE18Ujol3K-##drug_concept_id", "WhZ9W0mK3T47E5hFycNin$$BIxXBMx1PAjvpDawOUesH$$5VmAv0otjURE18Ujol3K-##drug_sub_exposure_end_datetime", "WhZ9W0mK3T47E5hFycNin$$BIxXBMx1PAjvpDawOUesH$$5VmAv0otjURE18Ujol3K-##person_id" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        }
      }
    },
    "SWqzXf6stiMchrKt1g2Qz$$GgpbVBwPYbxqciCsZbOe8" : {
      "id" : "SWqzXf6stiMchrKt1g2Qz$$GgpbVBwPYbxqciCsZbOe8",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "cteDrugEraEnds",
        "slug" : "cteDrugEraEnds",
        "x" : -280,
        "y" : -300,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : ""
      },
      "ports" : {
        "inputs" : [ {
          "id" : "z-FiSeRBVHPezr6f5snEZ$$qy5PrvDmxL72DyL8jW8AP",
          "slug" : "ft",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "row_number",
              "type" : "integer",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "person_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_concept_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_sub_exposure_start_datetime",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_sub_exposure_end_datetime",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_exposure_count",
              "type" : "long",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "days_exposed",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "dFTkB71yQ13oy63KJfeNv$$Bg-iz1rl5bcT2d6oO7thg",
          "slug" : "e0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "person_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DRUG_CONCEPT_ID",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "end_datetime",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "fRBtTCUFUKD-MqiQOkhJB$$NFn_JyqVlGL94nV2eFWlO",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "packageName" : "cteDrugEraEnds",
        "externalId" : "subgraphs/cteDrugEraEnds",
        "name" : "cteDrugEraEnds"
      },
      "connections" : [ {
        "id" : "p7rxOon9DaUn0W7ngQ2Tn$$WDUdEY3uzAGDB7lDGV2K9",
        "source" : "hFMLw4OeM7V_v-uIalPDJ$$nqIvH2C7ylK7IiLDkPHaM",
        "sourcePort" : "bLDisA2c-Hanx-YxbQsvd$$XwAzG5Mef9pRYHlWeAxRv",
        "target" : "xU5NpnnAw8v1yBso6tcj5$$g4D400d83X34q63_cRzSY",
        "targetPort" : "ITzqMDVE_voigpylwjpRH$$6wOBwpwMMfGANzUEzFaz9"
      }, {
        "id" : "KFVbLlG4T-vJGZS1InegV$$CwOyWwZL_rroXuP8965G6",
        "source" : "xU5NpnnAw8v1yBso6tcj5$$g4D400d83X34q63_cRzSY",
        "sourcePort" : "NwoR9BczKZOQuQ4iFJSrb$$K8wYMkqxe3SrpCtl8L_VF",
        "target" : "43HHoZFz4nIhDTjqc6CZ7$$XNxI78ylW-yd3vISGy661",
        "targetPort" : "puicxe7j8Zdb2VoNskcYV$$4yyL7c6NGm9naepWzUPeQ"
      }, {
        "id" : "a7FgjYGOoBssg4Ku1YXJG",
        "source" : "SWqzXf6stiMchrKt1g2Qz$$GgpbVBwPYbxqciCsZbOe8",
        "sourcePort" : "z-FiSeRBVHPezr6f5snEZ$$qy5PrvDmxL72DyL8jW8AP",
        "target" : "hFMLw4OeM7V_v-uIalPDJ$$nqIvH2C7ylK7IiLDkPHaM",
        "targetPort" : "qybLwiEFKbbtcrcvE1pVI$$cYMAPXS8o5VAIe2U8veXz"
      }, {
        "id" : "DmjlGCerq72UtlCQH5Uia$$lKcGpX-GPjjCUVUfWkgUP",
        "source" : "SWqzXf6stiMchrKt1g2Qz$$GgpbVBwPYbxqciCsZbOe8",
        "sourcePort" : "dFTkB71yQ13oy63KJfeNv$$Bg-iz1rl5bcT2d6oO7thg",
        "target" : "hFMLw4OeM7V_v-uIalPDJ$$nqIvH2C7ylK7IiLDkPHaM",
        "targetPort" : "NGtsVRbFE_3g4qD63j1mB$$U3UcWKvDUIZG1e0x7zqJB"
      }, {
        "id" : "6uFcznSE2P-DY4_32nGE5",
        "source" : "43HHoZFz4nIhDTjqc6CZ7$$XNxI78ylW-yd3vISGy661",
        "sourcePort" : "kb_Lg_NnMoj2oUY-R84bh$$NORjlsm0q7z9sBsh4n1Mu",
        "target" : "SWqzXf6stiMchrKt1g2Qz$$GgpbVBwPYbxqciCsZbOe8",
        "targetPort" : "fRBtTCUFUKD-MqiQOkhJB$$NFn_JyqVlGL94nV2eFWlO"
      } ],
      "processes" : {
        "hFMLw4OeM7V_v-uIalPDJ$$nqIvH2C7ylK7IiLDkPHaM" : {
          "id" : "hFMLw4OeM7V_v-uIalPDJ$$nqIvH2C7ylK7IiLDkPHaM",
          "component" : "Join",
          "metadata" : {
            "label" : "by_person_id_and_drug_concept_id",
            "slug" : "by_person_id_and_drug_concept_id",
            "x" : -300,
            "y" : -280,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "qybLwiEFKbbtcrcvE1pVI$$cYMAPXS8o5VAIe2U8veXz",
              "slug" : "ft",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "row_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_sub_exposure_start_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_sub_exposure_end_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_count",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "days_exposed",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "NGtsVRbFE_3g4qD63j1mB$$U3UcWKvDUIZG1e0x7zqJB",
              "slug" : "e",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DRUG_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "end_datetime",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "bLDisA2c-Hanx-YxbQsvd$$XwAzG5Mef9pRYHlWeAxRv",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "conditions" : [ {
              "alias" : "e",
              "expression" : {
                "format" : "sql",
                "expression" : "e.person_id = ft.person_id\nand ft.drug_concept_id = e.DRUG_CONCEPT_ID\nand e.end_datetime >= ft.drug_sub_exposure_start_datetime"
              },
              "joinType" : "inner"
            } ],
            "expressions" : [ {
              "target" : "row_number",
              "expression" : {
                "format" : "sql",
                "expression" : "ft.row_number"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "ft.person_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "drug_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "ft.drug_concept_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "drug_sub_exposure_start_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "ft.drug_sub_exposure_start_datetime"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "drug_sub_exposure_end_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "ft.drug_sub_exposure_end_datetime"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "drug_exposure_count",
              "expression" : {
                "format" : "sql",
                "expression" : "ft.drug_exposure_count"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "days_exposed",
              "expression" : {
                "format" : "sql",
                "expression" : "ft.days_exposed"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "end_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "e.end_datetime"
              },
              "description" : "",
              "_row_id" : null
            } ],
            "hints" : [ {
              "id" : "qybLwiEFKbbtcrcvE1pVI$$cYMAPXS8o5VAIe2U8veXz",
              "alias" : "ft",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "NGtsVRbFE_3g4qD63j1mB$$U3UcWKvDUIZG1e0x7zqJB",
              "alias" : "e",
              "hintType" : "none",
              "propagateColumns" : false
            } ],
            "allIn1" : null,
            "activeTab" : "expressions",
            "columnsSelector" : [ "qybLwiEFKbbtcrcvE1pVI$$cYMAPXS8o5VAIe2U8veXz##drug_sub_exposure_start_datetime", "NGtsVRbFE_3g4qD63j1mB$$U3UcWKvDUIZG1e0x7zqJB##DRUG_CONCEPT_ID", "NGtsVRbFE_3g4qD63j1mB$$U3UcWKvDUIZG1e0x7zqJB##person_id", "NGtsVRbFE_3g4qD63j1mB$$U3UcWKvDUIZG1e0x7zqJB##end_datetime", "qybLwiEFKbbtcrcvE1pVI$$cYMAPXS8o5VAIe2U8veXz##person_id", "qybLwiEFKbbtcrcvE1pVI$$cYMAPXS8o5VAIe2U8veXz##drug_concept_id", "qybLwiEFKbbtcrcvE1pVI$$cYMAPXS8o5VAIe2U8veXz##person_id", "qybLwiEFKbbtcrcvE1pVI$$cYMAPXS8o5VAIe2U8veXz##drug_sub_exposure_start_datetime", "qybLwiEFKbbtcrcvE1pVI$$cYMAPXS8o5VAIe2U8veXz##drug_exposure_count", "NGtsVRbFE_3g4qD63j1mB$$U3UcWKvDUIZG1e0x7zqJB##end_datetime", "qybLwiEFKbbtcrcvE1pVI$$cYMAPXS8o5VAIe2U8veXz##drug_sub_exposure_end_datetime", "qybLwiEFKbbtcrcvE1pVI$$cYMAPXS8o5VAIe2U8veXz##days_exposed", "qybLwiEFKbbtcrcvE1pVI$$cYMAPXS8o5VAIe2U8veXz##row_number", "qybLwiEFKbbtcrcvE1pVI$$cYMAPXS8o5VAIe2U8veXz##drug_concept_id" ],
            "allIn0" : null,
            "whereClause" : null,
            "headAlias" : "ft"
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Join",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "xU5NpnnAw8v1yBso6tcj5$$g4D400d83X34q63_cRzSY" : {
          "id" : "xU5NpnnAw8v1yBso6tcj5$$g4D400d83X34q63_cRzSY",
          "component" : "Aggregate",
          "metadata" : {
            "label" : "era_end_datetime_by_person_and_drug",
            "slug" : "era_end_datetime_by_person_and_drug",
            "x" : -120,
            "y" : -280,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "ITzqMDVE_voigpylwjpRH$$6wOBwpwMMfGANzUEzFaz9",
              "slug" : "by_person_id_and_drug_concept_id",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "row_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_sub_exposure_start_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_sub_exposure_end_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_count",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "days_exposed",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "end_datetime",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "NwoR9BczKZOQuQ4iFJSrb$$K8wYMkqxe3SrpCtl8L_VF",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "allIns" : false,
            "doPivot" : false,
            "aggregate" : [ {
              "_row_id" : "c_191",
              "target" : "era_end_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "min(end_datetime)"
              },
              "description" : ""
            } ],
            "allowSelection" : true,
            "pivotColumn" : null,
            "pivotValues" : [ ],
            "activeTab" : "aggregate",
            "columnsSelector" : [ "ITzqMDVE_voigpylwjpRH$$6wOBwpwMMfGANzUEzFaz9##person_id", "ITzqMDVE_voigpylwjpRH$$6wOBwpwMMfGANzUEzFaz9##drug_exposure_count", "ITzqMDVE_voigpylwjpRH$$6wOBwpwMMfGANzUEzFaz9##days_exposed", "ITzqMDVE_voigpylwjpRH$$6wOBwpwMMfGANzUEzFaz9##end_datetime", "ITzqMDVE_voigpylwjpRH$$6wOBwpwMMfGANzUEzFaz9##drug_concept_id", "ITzqMDVE_voigpylwjpRH$$6wOBwpwMMfGANzUEzFaz9##drug_sub_exposure_start_datetime" ],
            "groupBy" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "drug_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_concept_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "drug_sub_exposure_start_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_sub_exposure_start_datetime"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "drug_exposure_count",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_exposure_count"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "days_exposed",
              "expression" : {
                "format" : "sql",
                "expression" : "days_exposed"
              },
              "description" : "",
              "_row_id" : null
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Aggregate",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "43HHoZFz4nIhDTjqc6CZ7$$XNxI78ylW-yd3vISGy661" : {
          "id" : "43HHoZFz4nIhDTjqc6CZ7$$XNxI78ylW-yd3vISGy661",
          "component" : "Reformat",
          "metadata" : {
            "label" : "drug_era_summary",
            "slug" : "drug_era_summary",
            "x" : 40,
            "y" : -280,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "puicxe7j8Zdb2VoNskcYV$$4yyL7c6NGm9naepWzUPeQ",
              "slug" : "era_end_datetime_by_person_and_drug",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_concept_id",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_sub_exposure_start_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_count",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "days_exposed",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "era_end_datetime",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "kb_Lg_NnMoj2oUY-R84bh$$NORjlsm0q7z9sBsh4n1Mu",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "drug_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_concept_id"
              },
              "description" : ""
            }, {
              "target" : "drug_sub_exposure_start_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_sub_exposure_start_datetime"
              },
              "description" : ""
            }, {
              "target" : "era_end_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "era_end_datetime"
              },
              "description" : ""
            }, {
              "target" : "drug_exposure_count",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_exposure_count"
              },
              "description" : ""
            }, {
              "target" : "days_exposed",
              "expression" : {
                "format" : "sql",
                "expression" : "days_exposed"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "puicxe7j8Zdb2VoNskcYV$$4yyL7c6NGm9naepWzUPeQ##era_end_datetime", "puicxe7j8Zdb2VoNskcYV$$4yyL7c6NGm9naepWzUPeQ##drug_concept_id", "puicxe7j8Zdb2VoNskcYV$$4yyL7c6NGm9naepWzUPeQ##drug_exposure_count", "puicxe7j8Zdb2VoNskcYV$$4yyL7c6NGm9naepWzUPeQ##drug_sub_exposure_start_datetime", "puicxe7j8Zdb2VoNskcYV$$4yyL7c6NGm9naepWzUPeQ##days_exposed", "puicxe7j8Zdb2VoNskcYV$$4yyL7c6NGm9naepWzUPeQ##person_id" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        }
      }
    },
    "_NsKt4YKAswwQNGUUuO7-$$UQiGqUZuqGn2U7FBN-8jU" : {
      "id" : "_NsKt4YKAswwQNGUUuO7-$$UQiGqUZuqGn2U7FBN-8jU",
      "component" : "Reformat",
      "metadata" : {
        "label" : "era_condition_occurrence_count_projection",
        "slug" : "era_condition_occurrence_count_projection",
        "x" : -620,
        "y" : -680,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "iC_6mGoMYZoe2b4xbsS8H$$mbWHweBTpKxBCz8PT5M4A",
          "slug" : "era_condition_occurrence_count",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "person_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "CONDITION_CONCEPT_ID",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "era_end_datetime",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "condition_era_start_datetime",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "condition_occurrence_count",
              "type" : "long",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "wX57BsWt8LoVgD4ATXT33$$1vw3ilZNxloSCcTgd8_DJ",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
        "expressions" : [ {
          "target" : "condition_era_id",
          "expression" : {
            "format" : "sql",
            "expression" : "row_number() OVER (PARTITION BY 1 ORDER BY person_id)"
          },
          "description" : ""
        }, {
          "target" : "person_id",
          "expression" : {
            "format" : "sql",
            "expression" : "person_id"
          },
          "description" : ""
        }, {
          "target" : "CONDITION_CONCEPT_ID",
          "expression" : {
            "format" : "sql",
            "expression" : "CONDITION_CONCEPT_ID"
          },
          "description" : ""
        }, {
          "target" : "condition_era_start_datetime",
          "expression" : {
            "format" : "sql",
            "expression" : "condition_era_start_datetime"
          },
          "description" : ""
        }, {
          "target" : "condition_era_end_datetime",
          "expression" : {
            "format" : "sql",
            "expression" : "era_end_datetime"
          },
          "description" : ""
        }, {
          "target" : "condition_occurrence_count",
          "expression" : {
            "format" : "sql",
            "expression" : "condition_occurrence_count"
          },
          "description" : ""
        } ],
        "importString" : "",
        "activeTab" : "expressions",
        "columnsSelector" : [ "iC_6mGoMYZoe2b4xbsS8H$$mbWHweBTpKxBCz8PT5M4A##person_id", "iC_6mGoMYZoe2b4xbsS8H$$mbWHweBTpKxBCz8PT5M4A##era_end_datetime", "iC_6mGoMYZoe2b4xbsS8H$$mbWHweBTpKxBCz8PT5M4A##condition_era_start_datetime", "iC_6mGoMYZoe2b4xbsS8H$$mbWHweBTpKxBCz8PT5M4A##CONDITION_CONCEPT_ID", "iC_6mGoMYZoe2b4xbsS8H$$mbWHweBTpKxBCz8PT5M4A##condition_occurrence_count" ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "fj-wDnQi1dXV4dDDEBc4F$$sonfGdwL7nHJwcPnxLvmp" : {
      "id" : "fj-wDnQi1dXV4dDDEBc4F$$sonfGdwL7nHJwcPnxLvmp",
      "component" : "Aggregate",
      "metadata" : {
        "label" : "era_condition_occurrence_count",
        "slug" : "era_condition_occurrence_count",
        "x" : -780,
        "y" : -680,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "90PXO3C6es4nKwDbpLPGv$$1KSeJBeoAAtZwk1yjzamR",
          "slug" : "cteConditionEnds",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "person_id",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "CONDITION_CONCEPT_ID",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "CONDITION_START_DATETIME",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "era_end_datetime",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "6DN9pSN0JOfnB7rtHylCS$$mqj241ARhR0cg3UW_3hwn",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "allIns" : false,
        "doPivot" : false,
        "aggregate" : [ {
          "target" : "condition_era_start_datetime",
          "expression" : {
            "format" : "sql",
            "expression" : "min(CONDITION_START_DATETIME)"
          },
          "description" : "",
          "_row_id" : "c_44"
        }, {
          "target" : "condition_occurrence_count",
          "expression" : {
            "format" : "sql",
            "expression" : "count(*)"
          },
          "description" : "",
          "_row_id" : "c_47"
        } ],
        "allowSelection" : true,
        "pivotColumn" : null,
        "pivotValues" : [ ],
        "activeTab" : "aggregate",
        "columnsSelector" : [ "90PXO3C6es4nKwDbpLPGv$$1KSeJBeoAAtZwk1yjzamR##person_id", "90PXO3C6es4nKwDbpLPGv$$1KSeJBeoAAtZwk1yjzamR##CONDITION_CONCEPT_ID", "90PXO3C6es4nKwDbpLPGv$$1KSeJBeoAAtZwk1yjzamR##era_end_datetime", "90PXO3C6es4nKwDbpLPGv$$1KSeJBeoAAtZwk1yjzamR##CONDITION_START_DATETIME" ],
        "groupBy" : [ {
          "target" : "person_id",
          "expression" : {
            "format" : "sql",
            "expression" : "person_id"
          },
          "description" : "",
          "_row_id" : null
        }, {
          "target" : "CONDITION_CONCEPT_ID",
          "expression" : {
            "format" : "sql",
            "expression" : "CONDITION_CONCEPT_ID"
          },
          "description" : "",
          "_row_id" : null
        }, {
          "target" : "era_end_datetime",
          "expression" : {
            "format" : "sql",
            "expression" : "era_end_datetime"
          },
          "description" : "",
          "_row_id" : null
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Aggregate",
        "projectName" : "ProphecySparkBasicsPython"
      }
    }
  },
  "ports" : {
    "inputs" : [ ],
    "outputs" : [ ],
    "selectedInputFields" : [ ],
    "isCustomOutputSchema" : false,
    "autoUpdateOnRun" : false
  }
}