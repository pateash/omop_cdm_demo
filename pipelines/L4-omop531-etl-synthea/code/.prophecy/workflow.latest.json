{
  "metainfo" : {
    "migrationVersions" : {
      "gemBuilderVersion" : "v1"
    },
    "functions" : { },
    "codeGenConfiguration" : {
      "editableConfig" : true,
      "plibVersion" : {
        "mavenVersion" : "8.4.0",
        "pyPiVersion" : "1.9.24"
      }
    },
    "id" : "1",
    "uri" : "pipelines/L4-omop531-etl-synthea",
    "language" : "python",
    "fabricId" : "647",
    "frontEndLanguage" : "sql",
    "mode" : "batch",
    "udfs" : {
      "language" : "python",
      "udfs" : [ ],
      "functionPackageName" : "nathandemoprophecyioteam.sampleomop.functions",
      "sharedFunctionPackageNames" : [ "prophecy.spark_basic.functions", "prophecy.warehouse.functions" ]
    },
    "udafs" : {
      "language" : "python",
      "code" : ""
    },
    "configuration" : {
      "common" : {
        "type" : "record",
        "fields" : [ {
          "name" : "catalog_name",
          "kind" : {
            "type" : "string",
            "value" : "omop"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "database_name",
          "kind" : {
            "type" : "string",
            "value" : "l1_silver_omop531"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "all_visits_table",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "IP_VISITS",
              "kind" : {
                "type" : "record",
                "fields" : [ {
                  "name" : "CTE_END_DATES",
                  "kind" : {
                    "type" : "record",
                    "fields" : [ ]
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : true,
                  "isReferenced" : false
                } ]
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : true,
              "isReferenced" : false
            }, {
              "name" : "ER_VISITS",
              "kind" : {
                "type" : "record",
                "fields" : [ ]
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : true,
              "isReferenced" : false
            }, {
              "name" : "OP_VISITS",
              "kind" : {
                "type" : "record",
                "fields" : [ ]
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : true,
              "isReferenced" : false
            }, {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "omop"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "database_name",
              "kind" : {
                "type" : "string",
                "value" : "l1_silver_omop531"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "assign_all_visit_ids_table",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "omop"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "database_name",
              "kind" : {
                "type" : "string",
                "value" : "l1_silver_omop531"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "final_visit_ids_table",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "omop"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "database_name",
              "kind" : {
                "type" : "string",
                "value" : "l1_silver_omop531"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "person_insert",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "omop"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "database_name",
              "kind" : {
                "type" : "string",
                "value" : "l1_silver_omop531"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "observation_period_insert",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "omop"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "database_name",
              "kind" : {
                "type" : "string",
                "value" : "l1_silver_omop531"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "visit_occurrence_insert",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "omop"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "database_name",
              "kind" : {
                "type" : "string",
                "value" : "l1_silver_omop531"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "condition_occurrence_insert",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "omop"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "database_name",
              "kind" : {
                "type" : "string",
                "value" : "l1_silver_omop531"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "measurement_insert",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "omop"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "database_name",
              "kind" : {
                "type" : "string",
                "value" : "l1_silver_omop531"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "tmp",
              "kind" : {
                "type" : "record",
                "fields" : [ {
                  "name" : "catalog_name",
                  "kind" : {
                    "type" : "string",
                    "value" : "omop"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : true
                }, {
                  "name" : "database_name",
                  "kind" : {
                    "type" : "string",
                    "value" : "l1_silver_omop531"
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : true
                } ]
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : true,
              "isReferenced" : false
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "procedure_occurrence_insert",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "omop"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "database_name",
              "kind" : {
                "type" : "string",
                "value" : "l1_silver_omop531"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "drug_exposure_insert",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "omop"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "database_name",
              "kind" : {
                "type" : "string",
                "value" : "l1_silver_omop531"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        } ]
      },
      "oldCommon" : {
        "type" : "record",
        "fields" : [ ]
      },
      "fabrics" : { },
      "instances" : { },
      "selected" : "default",
      "nonEditable" : [ ],
      "isSubscribedPipelineWithPipelineConfigs" : false
    },
    "sparkConf" : [ ],
    "hadoopConf" : [ ],
    "codeMode" : "sparse",
    "buildSystem" : "maven",
    "externalDependencies" : [ ],
    "dependentProjectExternalDependencies" : [ {
      "projectUID" : "12654",
      "projectName" : "ProphecySparkBasicsPython",
      "externalDependencies" : [ ]
    }, {
      "projectUID" : "12655",
      "projectName" : "ProphecyWarehousePython",
      "externalDependencies" : [ ]
    } ],
    "isImported" : false,
    "interimMode" : "Full",
    "interimModeEnabled" : true,
    "visualCodeInterimMode" : "Disabled",
    "recordsLimit" : {
      "enabled" : false,
      "value" : 1000
    },
    "topLevelPackage" : "l4omop531etlsynthea",
    "configurationVersion" : "v2"
  },
  "connections" : [ ],
  "processes" : {
    "KexyL_sy3OBvtO3Fizsws$$M6RxHJ6d7H5X-MN0Px-Ac" : {
      "id" : "KexyL_sy3OBvtO3Fizsws$$M6RxHJ6d7H5X-MN0Px-Ac",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "condition_occurrence_insert",
        "slug" : "condition_occurrence_insert",
        "x" : 0,
        "y" : 1260,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : { },
      "connections" : [ {
        "id" : "WDUuZT90KgKSITwPjBNnN",
        "source" : "KwEkcSApxvZGpCRyTS5_A$$rbo0WzMyYiASdOOc6QZLa",
        "sourcePort" : "y1F8lfmymb6vDwOknVnbd$$xkQQ4a9icxVAjditiO3am",
        "target" : "HJ3oT7kVMBUAt6gW3P0vL$$mta1ANqgebw-_y5Ew3Vzb",
        "targetPort" : "XBtgv4ZqucF7f9PZ7uei5$$5cUoSwWAc9gBK3YVyxeuB"
      }, {
        "id" : "70V9fukX-t-Ur--eIayVD",
        "source" : "yGgkoO27yd2iDmmrZdY9O$$eoKaBTlqP37qMxCPp2gMV",
        "sourcePort" : "YH89eDCW_ztjVYfiJPYQn$$M534ev151LchHSHaqEkGu",
        "target" : "HJ3oT7kVMBUAt6gW3P0vL$$mta1ANqgebw-_y5Ew3Vzb",
        "targetPort" : "R6vNX1j79yP6RNqOXe8_5$$_Id-drk-CkEcI8cjW7g5z"
      }, {
        "id" : "Ag3TIqEPRHs-EUp3zkid0",
        "source" : "XnmOJfN367MHHByEA6Y7Y$$w7vsbRHRQYo-vV3J-Uwz8",
        "sourcePort" : "p0MrypZxg443i7bHECONY$$ksecU0GtltPHEaGHHHWtj",
        "target" : "HJ3oT7kVMBUAt6gW3P0vL$$mta1ANqgebw-_y5Ew3Vzb",
        "targetPort" : "3Ns6ijJE0PnFmXapuG3Un$$SgTHE9tZk3IBM23SdzvTX"
      }, {
        "id" : "rKqb-gazbW-_e_R-ECK4q",
        "source" : "w1YzJvX_vnsZueV83wnG_$$GMhUlmi-QzGYT1-xkZKkw",
        "sourcePort" : "IZzFctgPFKSbcy3PjgD9f$$FcE-9hawhSTUid_VW9lLF",
        "target" : "HJ3oT7kVMBUAt6gW3P0vL$$mta1ANqgebw-_y5Ew3Vzb",
        "targetPort" : "FffjwMxtT5v9Lj4HNxSQc$$GL5MiEEgT1SKLzeO-exEU"
      }, {
        "id" : "NWYBlU7BqbiF0eFxZl3WD",
        "source" : "Yq6-A57yocbMSQyhRk9gB$$jrYb4OiJaALELgJaRZRoT",
        "sourcePort" : "Xdd_AnwL3OdrDE5IKTnua$$qoP0VrvouRb1JPWWdySKG",
        "target" : "HJ3oT7kVMBUAt6gW3P0vL$$mta1ANqgebw-_y5Ew3Vzb",
        "targetPort" : "56KjF355UCtkLSPY--20B$$oO74DZv0CRlxCBcHfJBUA"
      }, {
        "id" : "kli3VzVq5wlG2g3RtFzMk$$_YdrkjeTLaWsHKKn2ceJK",
        "source" : "HJ3oT7kVMBUAt6gW3P0vL$$mta1ANqgebw-_y5Ew3Vzb",
        "sourcePort" : "aA_Kzrg8Bd0aXSPn0oY4a$$X7lyxUC10eUpslAm38ZwR",
        "target" : "WVv0uKZwm-7cEszaab8_M$$4q6ksrpWSJ-j-olF9n8jE",
        "targetPort" : "OvMj2mj-z8aYjrOfg-Odx$$NuflKwzF1qYrmwemZXOsj"
      } ],
      "processes" : {
        "w1YzJvX_vnsZueV83wnG_$$GMhUlmi-QzGYT1-xkZKkw" : {
          "id" : "w1YzJvX_vnsZueV83wnG_$$GMhUlmi-QzGYT1-xkZKkw",
          "component" : "Source",
          "metadata" : {
            "label" : "final_visit_ids_2",
            "slug" : "final_visit_ids_2",
            "x" : 0,
            "y" : 1700,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "IZzFctgPFKSbcy3PjgD9f$$FcE-9hawhSTUid_VW9lLF",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/final_visit_ids"
          }
        },
        "Yq6-A57yocbMSQyhRk9gB$$jrYb4OiJaALELgJaRZRoT" : {
          "id" : "Yq6-A57yocbMSQyhRk9gB$$jrYb4OiJaALELgJaRZRoT",
          "component" : "Source",
          "metadata" : {
            "label" : "person_3",
            "slug" : "person_3",
            "x" : 0,
            "y" : 1860,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "Xdd_AnwL3OdrDE5IKTnua$$qoP0VrvouRb1JPWWdySKG",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/person"
          }
        },
        "HJ3oT7kVMBUAt6gW3P0vL$$mta1ANqgebw-_y5Ew3Vzb" : {
          "id" : "HJ3oT7kVMBUAt6gW3P0vL$$mta1ANqgebw-_y5Ew3Vzb",
          "component" : "Join",
          "metadata" : {
            "label" : "join_with_multiple_inputs",
            "slug" : "join_with_multiple_inputs",
            "x" : 280,
            "y" : 1540,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "XBtgv4ZqucF7f9PZ7uei5$$5cUoSwWAc9gBK3YVyxeuB",
              "slug" : "c",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "START",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "STOP",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PATIENT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ENCOUNTER",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "R6vNX1j79yP6RNqOXe8_5$$_Id-drk-CkEcI8cjW7g5z",
              "slug" : "srstostdvm",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "SOURCE_CODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CODE_DESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VALID_START_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VALID_END_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_NAME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_STANDARD_CONCEPT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "3Ns6ijJE0PnFmXapuG3Un$$SgTHE9tZk3IBM23SdzvTX",
              "slug" : "srctosrcvm",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "SOURCE_CODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CODE_DESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VALID_START_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VALID_END_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_NAME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_STANDARD_CONCEPT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "FffjwMxtT5v9Lj4HNxSQc$$GL5MiEEgT1SKLzeO-exEU",
              "slug" : "fv",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID_NEW",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "56KjF355UCtkLSPY--20B$$oO74DZv0CRlxCBcHfJBUA",
              "slug" : "p",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "gender_concept_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "YEAR_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "MONTH_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DAY_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "BIRTH_DATETIME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "LOCATION_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROVIDER_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CARE_SITE_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PERSON_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "aA_Kzrg8Bd0aXSPn0oY4a$$X7lyxUC10eUpslAm38ZwR",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "conditions" : [ {
              "alias" : "srstostdvm",
              "expression" : {
                "format" : "sql",
                "expression" : "srstostdvm.SOURCE_CODE = c.CODE\nand srstostdvm.TARGET_DOMAIN_ID = 'Condition'\nand srstostdvm.SOURCE_VOCABULARY_ID = 'SNOMED'\nand srstostdvm.TARGET_STANDARD_CONCEPT = 'S'\nand (srstostdvm.TARGET_INVALID_REASON IS NULL OR srstostdvm.TARGET_INVALID_REASON = '')"
              },
              "joinType" : "inner"
            }, {
              "alias" : "srctosrcvm",
              "expression" : {
                "format" : "sql",
                "expression" : "srctosrcvm.SOURCE_CODE = c.CODE\nAND srctosrcvm.SOURCE_VOCABULARY_ID = 'SNOMED'"
              },
              "joinType" : "left_outer"
            }, {
              "alias" : "fv",
              "expression" : {
                "format" : "sql",
                "expression" : "fv.encounter_id = c.ENCOUNTER"
              },
              "joinType" : "left_outer"
            }, {
              "alias" : "p",
              "expression" : {
                "format" : "sql",
                "expression" : "c.PATIENT = p.PERSON_SOURCE_VALUE"
              },
              "joinType" : "inner"
            } ],
            "expressions" : [ {
              "_row_id" : "c_616",
              "target" : "CONDITION_OCCURRENCE_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "row_number() OVER (PARTITION BY 1 ORDER BY p.person_id)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_617",
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "p.person_id"
              },
              "description" : ""
            }, {
              "_row_id" : "c_618",
              "target" : "target_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "coalesce(srstostdvm.TARGET_CONCEPT_ID, 0)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_619",
              "target" : "CONDITION_START_DATE",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(c.START as date)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_620",
              "target" : "CONDITION_START_DATETIME",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(c.START as timestamp)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_626",
              "target" : "CONDITION_END_DATE",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(c.STOP as date)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_627",
              "target" : "CONDITION_END_DATETIME",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(c.STOP as timestamp)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_628",
              "target" : "CONDITION_TYPE_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "32020"
              },
              "description" : ""
            }, {
              "_row_id" : "c_629",
              "target" : "STOP_REASON",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(null as string)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_630",
              "target" : "PROVIDER_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "_row_id" : "c_631",
              "target" : "VISIT_OCCURRENCE_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "fv.VISIT_OCCURRENCE_ID_NEW"
              },
              "description" : ""
            }, {
              "_row_id" : "c_632",
              "target" : "VISIT_DETAIL_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "_row_id" : "c_633",
              "target" : "CONDITION_SOURCE_VALUE",
              "expression" : {
                "format" : "sql",
                "expression" : "c.CODE"
              },
              "description" : ""
            }, {
              "_row_id" : "c_634",
              "target" : "CONDITION_SOURCE_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "coalesce(srctosrcvm.SOURCE_CONCEPT_ID, 0)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_635",
              "target" : "CONDITION_STATUS_SOURCE_VALUE",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(NULL AS string)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_636",
              "target" : "CONDITION_STATUS_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            } ],
            "hints" : [ {
              "id" : "XBtgv4ZqucF7f9PZ7uei5$$5cUoSwWAc9gBK3YVyxeuB",
              "alias" : "c",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "R6vNX1j79yP6RNqOXe8_5$$_Id-drk-CkEcI8cjW7g5z",
              "alias" : "srstostdvm",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "3Ns6ijJE0PnFmXapuG3Un$$SgTHE9tZk3IBM23SdzvTX",
              "alias" : "srctosrcvm",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "FffjwMxtT5v9Lj4HNxSQc$$GL5MiEEgT1SKLzeO-exEU",
              "alias" : "fv",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "56KjF355UCtkLSPY--20B$$oO74DZv0CRlxCBcHfJBUA",
              "alias" : "p",
              "hintType" : "none",
              "propagateColumns" : false
            } ],
            "allIn1" : null,
            "activeTab" : "expressions",
            "columnsSelector" : [ "R6vNX1j79yP6RNqOXe8_5$$_Id-drk-CkEcI8cjW7g5z##TARGET_DOMAIN_ID", "R6vNX1j79yP6RNqOXe8_5$$_Id-drk-CkEcI8cjW7g5z##TARGET_STANDARD_CONCEPT", "3Ns6ijJE0PnFmXapuG3Un$$SgTHE9tZk3IBM23SdzvTX##SOURCE_VOCABULARY_ID", "3Ns6ijJE0PnFmXapuG3Un$$SgTHE9tZk3IBM23SdzvTX##SOURCE_CODE", "56KjF355UCtkLSPY--20B$$oO74DZv0CRlxCBcHfJBUA##PERSON_SOURCE_VALUE", "FffjwMxtT5v9Lj4HNxSQc$$GL5MiEEgT1SKLzeO-exEU##encounter_id", "XBtgv4ZqucF7f9PZ7uei5$$5cUoSwWAc9gBK3YVyxeuB##PATIENT", "XBtgv4ZqucF7f9PZ7uei5$$5cUoSwWAc9gBK3YVyxeuB##CODE", "R6vNX1j79yP6RNqOXe8_5$$_Id-drk-CkEcI8cjW7g5z##SOURCE_CODE", "R6vNX1j79yP6RNqOXe8_5$$_Id-drk-CkEcI8cjW7g5z##TARGET_INVALID_REASON", "XBtgv4ZqucF7f9PZ7uei5$$5cUoSwWAc9gBK3YVyxeuB##ENCOUNTER", "R6vNX1j79yP6RNqOXe8_5$$_Id-drk-CkEcI8cjW7g5z##SOURCE_VOCABULARY_ID", "R6vNX1j79yP6RNqOXe8_5$$_Id-drk-CkEcI8cjW7g5z##TARGET_CONCEPT_ID", "XBtgv4ZqucF7f9PZ7uei5$$5cUoSwWAc9gBK3YVyxeuB##STOP", "FffjwMxtT5v9Lj4HNxSQc$$GL5MiEEgT1SKLzeO-exEU##VISIT_OCCURRENCE_ID_NEW", "56KjF355UCtkLSPY--20B$$oO74DZv0CRlxCBcHfJBUA##person_id", "XBtgv4ZqucF7f9PZ7uei5$$5cUoSwWAc9gBK3YVyxeuB##CODE", "3Ns6ijJE0PnFmXapuG3Un$$SgTHE9tZk3IBM23SdzvTX##SOURCE_CONCEPT_ID", "XBtgv4ZqucF7f9PZ7uei5$$5cUoSwWAc9gBK3YVyxeuB##START" ],
            "allIn0" : null,
            "whereClause" : null,
            "headAlias" : "c"
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Join",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "XnmOJfN367MHHByEA6Y7Y$$w7vsbRHRQYo-vV3J-Uwz8" : {
          "id" : "XnmOJfN367MHHByEA6Y7Y$$w7vsbRHRQYo-vV3J-Uwz8",
          "component" : "Source",
          "metadata" : {
            "label" : "source_to_source_vocab_map",
            "slug" : "source_to_source_vocab_map",
            "x" : 0,
            "y" : 1560,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "p0MrypZxg443i7bHECONY$$ksecU0GtltPHEaGHHHWtj",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/source_to_source_vocab_map"
          }
        },
        "WVv0uKZwm-7cEszaab8_M$$4q6ksrpWSJ-j-olF9n8jE" : {
          "id" : "WVv0uKZwm-7cEszaab8_M$$4q6ksrpWSJ-j-olF9n8jE",
          "component" : "Target",
          "metadata" : {
            "label" : "condition_occurence",
            "slug" : "condition_occurence",
            "x" : 500,
            "y" : 1560,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "OvMj2mj-z8aYjrOfg-Odx$$NuflKwzF1qYrmwemZXOsj",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "CONDITION_OCCURRENCE_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_concept_id",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_START_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_START_DATETIME",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_END_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_END_DATETIME",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_TYPE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "STOP_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROVIDER_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_DETAIL_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_SOURCE_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_STATUS_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CONDITION_STATUS_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/condition_occurence"
          }
        },
        "KwEkcSApxvZGpCRyTS5_A$$rbo0WzMyYiASdOOc6QZLa" : {
          "id" : "KwEkcSApxvZGpCRyTS5_A$$rbo0WzMyYiASdOOc6QZLa",
          "component" : "Source",
          "metadata" : {
            "label" : "conditions",
            "slug" : "conditions",
            "x" : 0,
            "y" : 1280,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "y1F8lfmymb6vDwOknVnbd$$xkQQ4a9icxVAjditiO3am",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/l0_bronze_layer_conditions"
          }
        },
        "yGgkoO27yd2iDmmrZdY9O$$eoKaBTlqP37qMxCPp2gMV" : {
          "id" : "yGgkoO27yd2iDmmrZdY9O$$eoKaBTlqP37qMxCPp2gMV",
          "component" : "Source",
          "metadata" : {
            "label" : "source_to_standard_vocab_map",
            "slug" : "source_to_standard_vocab_map",
            "x" : 0,
            "y" : 1420,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "YH89eDCW_ztjVYfiJPYQn$$M534ev151LchHSHaqEkGu",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/source_to_standard_vocab_map"
          }
        }
      }
    },
    "e19Wew8RXg_XQeRPhDDq0$$F7qFpmE3rsEff9T8Xx1db" : {
      "id" : "e19Wew8RXg_XQeRPhDDq0$$F7qFpmE3rsEff9T8Xx1db",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "drug_exposure_insert",
        "slug" : "drug_exposure_insert",
        "x" : 0,
        "y" : 1720,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : { },
      "connections" : [ {
        "id" : "sm-tnhExR-c7Ip5NvMHyA",
        "source" : "G2WEpQK9-Wp0QMfjAAB82$$LL2zHJZ984maN3K6oOiN2",
        "sourcePort" : "L_0uB2tYRIpyYJ1-H_bDR$$3OXqH7Ww-n_sVhd3PDjwr",
        "target" : "F3jaJvJA8AgcCcdWt1tHt$$DcpiN8I3c1dQ7fmuSrgHN",
        "targetPort" : "FkKZgVIlrdt0sfHmVC1eC$$5OVtn5dsTkgShSYSpt2BT"
      }, {
        "id" : "BBBRXV20RFWFIVoH2k_oO",
        "source" : "xI2ysNJz0N4WaQimitwjx$$2ANED8msNjeJgI5BypnAc",
        "sourcePort" : "xdgATxa-5sfuT71AgIcdG$$efuGUlucOhtXMygLUfuOi",
        "target" : "F3jaJvJA8AgcCcdWt1tHt$$DcpiN8I3c1dQ7fmuSrgHN",
        "targetPort" : "Qia8hddbzKdvqSX5m8v3F$$xy85RXLMFzaG4VaJ00DHE"
      }, {
        "id" : "pNUei5e0iWwUDmde9MtuP",
        "source" : "obPnRGEVzYHnRjlmpchAh$$fj74ErPBfoV5nmaPE5sCC",
        "sourcePort" : "cfcSnonu8fVSN0Oe1gHPa$$mLcP3cghHoUSCP9eBOFC4",
        "target" : "F3jaJvJA8AgcCcdWt1tHt$$DcpiN8I3c1dQ7fmuSrgHN",
        "targetPort" : "qhufDSsX4ol_keoncZfwY$$S9So1fZnTVOl70Pgxvp4m"
      }, {
        "id" : "tGAoq2xY1hnZ1dhMXmSJC",
        "source" : "WnXPO-tOJxJZoitGRzOEY$$2ObBdEX26u_q-6ddxrA3-",
        "sourcePort" : "Fm-Twua2P48A6GXtyqF4O$$QucuV90yumfgOwuRt8wA_",
        "target" : "F3jaJvJA8AgcCcdWt1tHt$$DcpiN8I3c1dQ7fmuSrgHN",
        "targetPort" : "iyRVAfkBx3ZUqX2c1qXYM$$-p1h54yOaaWXMVEdRFhFv"
      }, {
        "id" : "EYx2nAUELz8YfhB7aaqBI",
        "source" : "niq8P4-L8jbkWj9gJy3wg$$lsiV37o2QaH4jQF90FmhH",
        "sourcePort" : "T-ctHq8iyH-Oli4QoWbgl$$vBRQH4qoIKlgvqOtMOP3k",
        "target" : "F3jaJvJA8AgcCcdWt1tHt$$DcpiN8I3c1dQ7fmuSrgHN",
        "targetPort" : "hpCWd_zvhzzzLRDlYfz6E$$-8uROa20eLstCvBg1MG-e"
      }, {
        "id" : "zk1uEt1UxwHxxBFlQqTNW",
        "source" : "tEtQib_AlUlnCtMgTVtQ9$$T97Eml9MvfNkuC3Eg5z9L",
        "sourcePort" : "d837oEpHndHH8cI-RDjt_$$JxDYSylDF6Kg4OEoFZxXP",
        "target" : "awIYaye4qxrgDeyfWIpOK$$hxb5uXC80C6xTy7nu1J1o",
        "targetPort" : "x0ozv4PisV5257VL4xMXX$$7GawPbGgkiGGBFXGmzPhS"
      }, {
        "id" : "Xcl-JBj_DkpZ2AzXaEVsT",
        "source" : "ZnDOAvpwPenUs1gq2DYW5$$XXY5oVnsTRNsQyPy7fP88",
        "sourcePort" : "VfH2egr4EtcOG1aPUX0eL$$HEaHY4lA1Es8_hZAJgSjO",
        "target" : "awIYaye4qxrgDeyfWIpOK$$hxb5uXC80C6xTy7nu1J1o",
        "targetPort" : "NqsfGIkjdORY8MXoy8A5Q$$gBalnqTDoLYmEW_tOWwP0"
      }, {
        "id" : "044MMn6eY-l51iZWMsyGm",
        "source" : "7y69URTqbFp4jVdaLpZQx$$m65aE2D4gHWw7jyDecD6y",
        "sourcePort" : "r0QfZx7arLWu1PhYl8p1s$$jGVlHOtddZziRdx5UWRuP",
        "target" : "awIYaye4qxrgDeyfWIpOK$$hxb5uXC80C6xTy7nu1J1o",
        "targetPort" : "CxKQTTCeMhM49cUnVkR8J$$Bt5cWwJQDogUVY_IfFefI"
      }, {
        "id" : "xpiTzhtvvgBYhxZBL-5k6",
        "source" : "TAhUt-5Vs98p1-YRRN7P_$$XH6M0MXWJiOFmNs9dkXxn",
        "sourcePort" : "KCvHs2U-uSosWlFbzra48$$1t2AaWATdThulmbvaKhjD",
        "target" : "awIYaye4qxrgDeyfWIpOK$$hxb5uXC80C6xTy7nu1J1o",
        "targetPort" : "Im2RfKfYoWUud72drWQya$$CIXc3EtA3P53UlCR4kR9g"
      }, {
        "id" : "hQU5JVwBQOP0yVxX3eACc",
        "source" : "oyclxPURmxBOEbWM5Ojnr$$I9nNJ4SO0pZc4fY4wuQK2",
        "sourcePort" : "c5V18QHzt_lJa3jCEqRAR$$cuRaidcnb8W2NH3nSmxAq",
        "target" : "awIYaye4qxrgDeyfWIpOK$$hxb5uXC80C6xTy7nu1J1o",
        "targetPort" : "rGObGj_odD5nLpMPrUo1L$$I4fk5p79V1KunYQ8mvPU1"
      }, {
        "id" : "K2kE-cbL583wD6dbT1ma9",
        "source" : "JgvQaeowke_cZFLsLzxLG$$57u2PAPBwzLWHqsIOwPda",
        "sourcePort" : "fVk_fF_FW2-WlSuhEDutC$$5ytpfcjfk9NiBN5peGfpW",
        "target" : "wbRr0aaT8G1Krd5JRQhyd$$F79c3lpBSxAUUY1pstyuW",
        "targetPort" : "AijrAcYnze7qYOAdOyMES$$MO_L57kr8XlUIcc4DoN41"
      }, {
        "id" : "Xd5ZVHxSMrpEqDLAjnj8k",
        "source" : "2_fdqOxwXvMeoFLft9v6q$$9FDf7DrgmQyBANL2ce_FR",
        "sourcePort" : "ptwLghJnGTDi0FKjmKSdP$$qpYxj7d6WAYYsiW5OBWKJ",
        "target" : "wbRr0aaT8G1Krd5JRQhyd$$F79c3lpBSxAUUY1pstyuW",
        "targetPort" : "dlg6_ml_Girdq8nwoi_Dz$$kvmr_YWb3kkY2-e8azWVe"
      }, {
        "id" : "4t_gB1M4WSyDK281NcdGu",
        "source" : "OxWhNlN-9vpm1l7c02hnv$$BEe_1J1L4_if-xOvPge__",
        "sourcePort" : "IusWbxUpxIhaqDhnLiXUM$$U_LFc0lWL-eWHB92ngG0j",
        "target" : "wbRr0aaT8G1Krd5JRQhyd$$F79c3lpBSxAUUY1pstyuW",
        "targetPort" : "uO1o-7BHp67bCkerIVpOq$$MQECRbq5vg4mV11zYZ25I"
      }, {
        "id" : "Z7knKHP8VlJ-UsliHOl9W",
        "source" : "wj9unbREXpZAKYxCYa5xO$$TaC7idbK46XwuxoBnkwz1",
        "sourcePort" : "p_3BA0WZyLn7bETfBp3kY$$z9bHVV2ASxKLP4MP8D7eX",
        "target" : "wbRr0aaT8G1Krd5JRQhyd$$F79c3lpBSxAUUY1pstyuW",
        "targetPort" : "H8WRODqN2RT4IBte2si2H$$YTtyZ3RxdNzJWVVjsJIKr"
      }, {
        "id" : "1nkxADyY9wRazYE1UpTz_",
        "source" : "J3cSyilivxMEAfvHhouZm$$ydM72vOyEusu5q6mLq8oe",
        "sourcePort" : "_qv61-_17IsSNBKXJ5Qwq$$j2QZt8tUn_KySs2ERmgsK",
        "target" : "wbRr0aaT8G1Krd5JRQhyd$$F79c3lpBSxAUUY1pstyuW",
        "targetPort" : "v0L20eatJkSzgE1WDxXl6$$UIRG2M7LtkW-jBUMV9vO5"
      }, {
        "id" : "ZNJ5HwTKmLjbAPsOGY_mo",
        "source" : "F3jaJvJA8AgcCcdWt1tHt$$DcpiN8I3c1dQ7fmuSrgHN",
        "sourcePort" : "ilt6PXQdX3QpHHhmqg1Pe$$YI7twifBV4nOslAcymkVZ",
        "target" : "MITnL5VxMjd75_SqI87hP$$mdtOUOA2vZsYuWTiuMXt8",
        "targetPort" : "6GCIS6-SeOc5_OHIPBIq5$$x8IpqYKngUMbB16GzOUGH"
      }, {
        "id" : "Jgi3jUgb5oCvBLP0yo_Ds",
        "source" : "awIYaye4qxrgDeyfWIpOK$$hxb5uXC80C6xTy7nu1J1o",
        "sourcePort" : "jmP_VXfHGvMtpJV-joVPR$$hD_0toG_uqqwaR9ALmhho",
        "target" : "MITnL5VxMjd75_SqI87hP$$mdtOUOA2vZsYuWTiuMXt8",
        "targetPort" : "1I2p2bhV2mtHjZptMGDhm$$rtkqIT8wE5DjS1f9OWmMW"
      }, {
        "id" : "oOSzac0vQiCdi59ecdRGx",
        "source" : "wbRr0aaT8G1Krd5JRQhyd$$F79c3lpBSxAUUY1pstyuW",
        "sourcePort" : "U5s_trwLPhw29vpqEQs5j$$h8pONTmaoFA-om12lCnVu",
        "target" : "MITnL5VxMjd75_SqI87hP$$mdtOUOA2vZsYuWTiuMXt8",
        "targetPort" : "1z1-uilj1EVIxUuWUV91k$$DxbzJAWrlj51S3_2SP3d_"
      }, {
        "id" : "oGbAYkK7tvNJivsZSDyvD$$lYW-LZXLzUApMpEpUAHm0",
        "source" : "MITnL5VxMjd75_SqI87hP$$mdtOUOA2vZsYuWTiuMXt8",
        "sourcePort" : "Csu7ivJXnIC9qB3q4dfVC$$s6F843BwGf89DEhTM5Njp",
        "target" : "DLOLdcMmSPSk0yP1xz5TE$$hR7t9yOc07SQhFb3FCl7r",
        "targetPort" : "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ"
      }, {
        "id" : "YrHVSohYM417ShnWh1md4$$hZ3REA4aAvKZV37eFAu6m",
        "source" : "DLOLdcMmSPSk0yP1xz5TE$$hR7t9yOc07SQhFb3FCl7r",
        "sourcePort" : "LtPdjLzklF1khyUXgI-UG$$YiX0BEdoKZT9kH9_hJcUX",
        "target" : "xZiBk6AuqeKeY-HOTW2nL$$zc2DQ9Pd8br2PTrNCn2i0",
        "targetPort" : "VGnoFCJCj5oxFOOwplDHv$$HKFUai1AprRVxTm0s9XqL"
      } ],
      "processes" : {
        "wbRr0aaT8G1Krd5JRQhyd$$F79c3lpBSxAUUY1pstyuW" : {
          "id" : "wbRr0aaT8G1Krd5JRQhyd$$F79c3lpBSxAUUY1pstyuW",
          "component" : "Join",
          "metadata" : {
            "label" : "join_multiple_dataframes_3",
            "slug" : "join_multiple_dataframes_3",
            "x" : 300,
            "y" : 3420,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "v0L20eatJkSzgE1WDxXl6$$UIRG2M7LtkW-jBUMV9vO5",
              "slug" : "i",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PATIENT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ENCOUNTER",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "COST",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "AijrAcYnze7qYOAdOyMES$$MO_L57kr8XlUIcc4DoN41",
              "slug" : "srctostdvm",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "SOURCE_CODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CODE_DESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VALID_START_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VALID_END_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_NAME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_STANDARD_CONCEPT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "dlg6_ml_Girdq8nwoi_Dz$$kvmr_YWb3kkY2-e8azWVe",
              "slug" : "srctosrcvm",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "SOURCE_CODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CODE_DESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VALID_START_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VALID_END_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_NAME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_STANDARD_CONCEPT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "uO1o-7BHp67bCkerIVpOq$$MQECRbq5vg4mV11zYZ25I",
              "slug" : "fv",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID_NEW",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "H8WRODqN2RT4IBte2si2H$$YTtyZ3RxdNzJWVVjsJIKr",
              "slug" : "p",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "gender_concept_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "YEAR_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "MONTH_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DAY_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "BIRTH_DATETIME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "LOCATION_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROVIDER_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CARE_SITE_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PERSON_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "U5s_trwLPhw29vpqEQs5j$$h8pONTmaoFA-om12lCnVu",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "conditions" : [ {
              "alias" : "srctostdvm",
              "expression" : {
                "format" : "sql",
                "expression" : "srctostdvm.SOURCE_CODE = i.CODE\nAND srctostdvm.TARGET_DOMAIN_ID = 'Drug'\nAND srctostdvm.SOURCE_VOCABULARY_ID = 'CVX'\nAND srctostdvm.TARGET_STANDARD_CONCEPT = 'S'\nAND (srctostdvm.TARGET_INVALID_REASON IS NULL OR srctostdvm.TARGET_INVALID_REASON = '')"
              },
              "joinType" : "inner"
            }, {
              "alias" : "srctosrcvm",
              "expression" : {
                "format" : "sql",
                "expression" : "srctosrcvm.SOURCE_CODE = i.CODE\nAND srctosrcvm.SOURCE_VOCABULARY_ID = 'CVX'"
              },
              "joinType" : "left_outer"
            }, {
              "alias" : "fv",
              "expression" : {
                "format" : "sql",
                "expression" : "fv.encounter_id = i.ENCOUNTER"
              },
              "joinType" : "left_outer"
            }, {
              "alias" : "p",
              "expression" : {
                "format" : "sql",
                "expression" : "p.PERSON_SOURCE_VALUE = i.PATIENT"
              },
              "joinType" : "inner"
            } ],
            "expressions" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "p.person_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "_row_id" : "c_10",
              "target" : "drug_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "coalesce(srctostdvm.target_concept_id,0)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_11",
              "target" : "drug_exposure_start_date",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(i.date as date)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_12",
              "target" : "drug_exposure_start_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(i.DATE as timestamp)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_13",
              "target" : "drug_exposure_end_date",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(i.date as date)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_14",
              "target" : "drug_exposure_end_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(i.DATE as timestamp)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_15",
              "target" : "verbatim_end_date",
              "expression" : {
                "format" : "sql",
                "expression" : "i.DATE"
              },
              "description" : ""
            }, {
              "_row_id" : "c_16",
              "target" : "drug_type_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "581452"
              },
              "description" : ""
            }, {
              "_row_id" : "c_17",
              "target" : "stop_reason",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(null as string)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_18",
              "target" : "refills",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "_row_id" : "c_19",
              "target" : "quantity",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "_row_id" : "c_20",
              "target" : "days_supply",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "_row_id" : "c_21",
              "target" : "sig",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(null as string)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_22",
              "target" : "route_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "_row_id" : "c_23",
              "target" : "lot_number",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "_row_id" : "c_24",
              "target" : "provider_id",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "_row_id" : "c_25",
              "target" : "visit_occurrence_id",
              "expression" : {
                "format" : "sql",
                "expression" : "fv.VISIT_OCCURRENCE_ID_NEW"
              },
              "description" : ""
            }, {
              "_row_id" : "c_26",
              "target" : "visit_detail_id",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "_row_id" : "c_27",
              "target" : "drug_source_value",
              "expression" : {
                "format" : "sql",
                "expression" : "i.CODE"
              },
              "description" : ""
            }, {
              "_row_id" : "c_28",
              "target" : "drug_source_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "coalesce(srctosrcvm.source_concept_id,0)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_29",
              "target" : "route_source_value",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(null as string)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_30",
              "target" : "dose_unit_source_value",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(null as string)"
              },
              "description" : ""
            } ],
            "hints" : [ {
              "id" : "v0L20eatJkSzgE1WDxXl6$$UIRG2M7LtkW-jBUMV9vO5",
              "alias" : "i",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "AijrAcYnze7qYOAdOyMES$$MO_L57kr8XlUIcc4DoN41",
              "alias" : "srctostdvm",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "dlg6_ml_Girdq8nwoi_Dz$$kvmr_YWb3kkY2-e8azWVe",
              "alias" : "srctosrcvm",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "uO1o-7BHp67bCkerIVpOq$$MQECRbq5vg4mV11zYZ25I",
              "alias" : "fv",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "H8WRODqN2RT4IBte2si2H$$YTtyZ3RxdNzJWVVjsJIKr",
              "alias" : "p",
              "hintType" : "none",
              "propagateColumns" : false
            } ],
            "allIn1" : null,
            "activeTab" : "expressions",
            "columnsSelector" : [ "v0L20eatJkSzgE1WDxXl6$$UIRG2M7LtkW-jBUMV9vO5##CODE", "v0L20eatJkSzgE1WDxXl6$$UIRG2M7LtkW-jBUMV9vO5##PATIENT", "dlg6_ml_Girdq8nwoi_Dz$$kvmr_YWb3kkY2-e8azWVe##SOURCE_CODE", "AijrAcYnze7qYOAdOyMES$$MO_L57kr8XlUIcc4DoN41##TARGET_DOMAIN_ID", "dlg6_ml_Girdq8nwoi_Dz$$kvmr_YWb3kkY2-e8azWVe##SOURCE_VOCABULARY_ID", "AijrAcYnze7qYOAdOyMES$$MO_L57kr8XlUIcc4DoN41##TARGET_STANDARD_CONCEPT", "H8WRODqN2RT4IBte2si2H$$YTtyZ3RxdNzJWVVjsJIKr##PERSON_SOURCE_VALUE", "v0L20eatJkSzgE1WDxXl6$$UIRG2M7LtkW-jBUMV9vO5##ENCOUNTER", "AijrAcYnze7qYOAdOyMES$$MO_L57kr8XlUIcc4DoN41##TARGET_INVALID_REASON", "uO1o-7BHp67bCkerIVpOq$$MQECRbq5vg4mV11zYZ25I##encounter_id", "AijrAcYnze7qYOAdOyMES$$MO_L57kr8XlUIcc4DoN41##SOURCE_VOCABULARY_ID", "AijrAcYnze7qYOAdOyMES$$MO_L57kr8XlUIcc4DoN41##SOURCE_CODE", "v0L20eatJkSzgE1WDxXl6$$UIRG2M7LtkW-jBUMV9vO5##CODE", "uO1o-7BHp67bCkerIVpOq$$MQECRbq5vg4mV11zYZ25I##VISIT_OCCURRENCE_ID_NEW", "H8WRODqN2RT4IBte2si2H$$YTtyZ3RxdNzJWVVjsJIKr##person_id", "AijrAcYnze7qYOAdOyMES$$MO_L57kr8XlUIcc4DoN41##TARGET_CONCEPT_ID", "dlg6_ml_Girdq8nwoi_Dz$$kvmr_YWb3kkY2-e8azWVe##SOURCE_CONCEPT_ID", "v0L20eatJkSzgE1WDxXl6$$UIRG2M7LtkW-jBUMV9vO5##DATE" ],
            "allIn0" : null,
            "whereClause" : null,
            "headAlias" : "i"
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Join",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "JgvQaeowke_cZFLsLzxLG$$57u2PAPBwzLWHqsIOwPda" : {
          "id" : "JgvQaeowke_cZFLsLzxLG$$57u2PAPBwzLWHqsIOwPda",
          "component" : "Source",
          "metadata" : {
            "label" : "source_to_standard_vocab_map_7_1",
            "slug" : "source_to_standard_vocab_map_7_1",
            "x" : 0,
            "y" : 3340,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "fVk_fF_FW2-WlSuhEDutC$$5ytpfcjfk9NiBN5peGfpW",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/source_to_standard_vocab_map"
          }
        },
        "niq8P4-L8jbkWj9gJy3wg$$lsiV37o2QaH4jQF90FmhH" : {
          "id" : "niq8P4-L8jbkWj9gJy3wg$$lsiV37o2QaH4jQF90FmhH",
          "component" : "Source",
          "metadata" : {
            "label" : "person_6",
            "slug" : "person_6",
            "x" : 0,
            "y" : 2320,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "T-ctHq8iyH-Oli4QoWbgl$$vBRQH4qoIKlgvqOtMOP3k",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/person"
          }
        },
        "7y69URTqbFp4jVdaLpZQx$$m65aE2D4gHWw7jyDecD6y" : {
          "id" : "7y69URTqbFp4jVdaLpZQx$$m65aE2D4gHWw7jyDecD6y",
          "component" : "Source",
          "metadata" : {
            "label" : "source_to_source_vocab_map_3",
            "slug" : "source_to_source_vocab_map_3",
            "x" : 0,
            "y" : 2760,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "r0QfZx7arLWu1PhYl8p1s$$jGVlHOtddZziRdx5UWRuP",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/source_to_source_vocab_map"
          }
        },
        "wj9unbREXpZAKYxCYa5xO$$TaC7idbK46XwuxoBnkwz1" : {
          "id" : "wj9unbREXpZAKYxCYa5xO$$TaC7idbK46XwuxoBnkwz1",
          "component" : "Source",
          "metadata" : {
            "label" : "person_7_1",
            "slug" : "person_7_1",
            "x" : 0,
            "y" : 3760,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "p_3BA0WZyLn7bETfBp3kY$$z9bHVV2ASxKLP4MP8D7eX",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/person"
          }
        },
        "awIYaye4qxrgDeyfWIpOK$$hxb5uXC80C6xTy7nu1J1o" : {
          "id" : "awIYaye4qxrgDeyfWIpOK$$hxb5uXC80C6xTy7nu1J1o",
          "component" : "Join",
          "metadata" : {
            "label" : "join_multiple_dataframes",
            "slug" : "join_multiple_dataframes",
            "x" : 300,
            "y" : 2700,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "x0ozv4PisV5257VL4xMXX$$7GawPbGgkiGGBFXGmzPhS",
              "slug" : "m",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "START",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "STOP",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PATIENT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ENCOUNTER",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "COST",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DISPENSES",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TOTALCOST",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "REASONCODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "REASONDESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "NqsfGIkjdORY8MXoy8A5Q$$gBalnqTDoLYmEW_tOWwP0",
              "slug" : "srctostdvm",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "SOURCE_CODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CODE_DESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VALID_START_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VALID_END_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_NAME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_STANDARD_CONCEPT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "CxKQTTCeMhM49cUnVkR8J$$Bt5cWwJQDogUVY_IfFefI",
              "slug" : "srctosrcvm",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "SOURCE_CODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CODE_DESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VALID_START_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VALID_END_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_NAME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_STANDARD_CONCEPT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "Im2RfKfYoWUud72drWQya$$CIXc3EtA3P53UlCR4kR9g",
              "slug" : "fv",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID_NEW",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "rGObGj_odD5nLpMPrUo1L$$I4fk5p79V1KunYQ8mvPU1",
              "slug" : "p",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "gender_concept_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "YEAR_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "MONTH_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DAY_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "BIRTH_DATETIME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "LOCATION_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROVIDER_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CARE_SITE_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PERSON_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "jmP_VXfHGvMtpJV-joVPR$$hD_0toG_uqqwaR9ALmhho",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "conditions" : [ {
              "alias" : "srctostdvm",
              "expression" : {
                "format" : "sql",
                "expression" : "srctostdvm.SOURCE_CODE = m.CODE\nAND srctostdvm.TARGET_DOMAIN_ID = 'Drug'\nAND srctostdvm.SOURCE_VOCABULARY_ID = 'RxNorm'\nAND srctostdvm.TARGET_STANDARD_CONCEPT = 'S'\nAND (srctostdvm.TARGET_INVALID_REASON IS NULL OR srctostdvm.TARGET_INVALID_REASON = '')"
              },
              "joinType" : "inner"
            }, {
              "alias" : "srctosrcvm",
              "expression" : {
                "format" : "sql",
                "expression" : "srctosrcvm.SOURCE_CODE = m.CODE\nAND srctosrcvm.SOURCE_VOCABULARY_ID = 'RxNorm'"
              },
              "joinType" : "left_outer"
            }, {
              "alias" : "fv",
              "expression" : {
                "format" : "sql",
                "expression" : "fv.encounter_id = m.ENCOUNTER"
              },
              "joinType" : "left_outer"
            }, {
              "alias" : "p",
              "expression" : {
                "format" : "sql",
                "expression" : "p.PERSON_SOURCE_VALUE = m.PATIENT"
              },
              "joinType" : "inner"
            } ],
            "expressions" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "p.person_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "_row_id" : "c_10",
              "target" : "drug_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "coalesce(srctostdvm.target_concept_id,0)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_11",
              "target" : "drug_exposure_start_date",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(m.START as date)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_12",
              "target" : "drug_exposure_start_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(m.START as timestamp)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_13",
              "target" : "drug_exposure_end_date",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(coalesce(m.stop,m.start) as date)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_14",
              "target" : "drug_exposure_end_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(coalesce(m.stop,m.start) as timestamp)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_15",
              "target" : "verbatim_end_date",
              "expression" : {
                "format" : "sql",
                "expression" : "m.STOP"
              },
              "description" : ""
            }, {
              "_row_id" : "c_16",
              "target" : "drug_type_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "38000177"
              },
              "description" : ""
            }, {
              "_row_id" : "c_17",
              "target" : "stop_reason",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(null as string)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_18",
              "target" : "refills",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "_row_id" : "c_19",
              "target" : "quantity",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "_row_id" : "c_20",
              "target" : "days_supply",
              "expression" : {
                "format" : "sql",
                "expression" : "coalesce(datediff(m.stop,m.start),0)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_21",
              "target" : "sig",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(null as string)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_22",
              "target" : "route_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "_row_id" : "c_23",
              "target" : "lot_number",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "_row_id" : "c_24",
              "target" : "provider_id",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "_row_id" : "c_25",
              "target" : "visit_occurrence_id",
              "expression" : {
                "format" : "sql",
                "expression" : "fv.VISIT_OCCURRENCE_ID_NEW"
              },
              "description" : ""
            }, {
              "_row_id" : "c_26",
              "target" : "visit_detail_id",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "_row_id" : "c_27",
              "target" : "drug_source_value",
              "expression" : {
                "format" : "sql",
                "expression" : "m.CODE"
              },
              "description" : ""
            }, {
              "_row_id" : "c_28",
              "target" : "drug_source_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "coalesce(srctosrcvm.source_concept_id,0)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_29",
              "target" : "route_source_value",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(null as string)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_30",
              "target" : "dose_unit_source_value",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(null as string)"
              },
              "description" : ""
            } ],
            "hints" : [ {
              "id" : "x0ozv4PisV5257VL4xMXX$$7GawPbGgkiGGBFXGmzPhS",
              "alias" : "m",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "NqsfGIkjdORY8MXoy8A5Q$$gBalnqTDoLYmEW_tOWwP0",
              "alias" : "srctostdvm",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "CxKQTTCeMhM49cUnVkR8J$$Bt5cWwJQDogUVY_IfFefI",
              "alias" : "srctosrcvm",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "Im2RfKfYoWUud72drWQya$$CIXc3EtA3P53UlCR4kR9g",
              "alias" : "fv",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "rGObGj_odD5nLpMPrUo1L$$I4fk5p79V1KunYQ8mvPU1",
              "alias" : "p",
              "hintType" : "none",
              "propagateColumns" : false
            } ],
            "allIn1" : null,
            "activeTab" : "expressions",
            "columnsSelector" : [ "x0ozv4PisV5257VL4xMXX$$7GawPbGgkiGGBFXGmzPhS##CODE", "CxKQTTCeMhM49cUnVkR8J$$Bt5cWwJQDogUVY_IfFefI##SOURCE_VOCABULARY_ID", "Im2RfKfYoWUud72drWQya$$CIXc3EtA3P53UlCR4kR9g##encounter_id", "NqsfGIkjdORY8MXoy8A5Q$$gBalnqTDoLYmEW_tOWwP0##SOURCE_VOCABULARY_ID", "x0ozv4PisV5257VL4xMXX$$7GawPbGgkiGGBFXGmzPhS##ENCOUNTER", "NqsfGIkjdORY8MXoy8A5Q$$gBalnqTDoLYmEW_tOWwP0##TARGET_STANDARD_CONCEPT", "rGObGj_odD5nLpMPrUo1L$$I4fk5p79V1KunYQ8mvPU1##PERSON_SOURCE_VALUE", "x0ozv4PisV5257VL4xMXX$$7GawPbGgkiGGBFXGmzPhS##PATIENT", "CxKQTTCeMhM49cUnVkR8J$$Bt5cWwJQDogUVY_IfFefI##SOURCE_CODE", "NqsfGIkjdORY8MXoy8A5Q$$gBalnqTDoLYmEW_tOWwP0##TARGET_INVALID_REASON", "NqsfGIkjdORY8MXoy8A5Q$$gBalnqTDoLYmEW_tOWwP0##TARGET_DOMAIN_ID", "NqsfGIkjdORY8MXoy8A5Q$$gBalnqTDoLYmEW_tOWwP0##SOURCE_CODE", "x0ozv4PisV5257VL4xMXX$$7GawPbGgkiGGBFXGmzPhS##CODE", "CxKQTTCeMhM49cUnVkR8J$$Bt5cWwJQDogUVY_IfFefI##SOURCE_CONCEPT_ID", "Im2RfKfYoWUud72drWQya$$CIXc3EtA3P53UlCR4kR9g##VISIT_OCCURRENCE_ID_NEW", "rGObGj_odD5nLpMPrUo1L$$I4fk5p79V1KunYQ8mvPU1##person_id", "NqsfGIkjdORY8MXoy8A5Q$$gBalnqTDoLYmEW_tOWwP0##TARGET_CONCEPT_ID", "x0ozv4PisV5257VL4xMXX$$7GawPbGgkiGGBFXGmzPhS##STOP", "x0ozv4PisV5257VL4xMXX$$7GawPbGgkiGGBFXGmzPhS##START" ],
            "allIn0" : null,
            "whereClause" : null,
            "headAlias" : "m"
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Join",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "F3jaJvJA8AgcCcdWt1tHt$$DcpiN8I3c1dQ7fmuSrgHN" : {
          "id" : "F3jaJvJA8AgcCcdWt1tHt$$DcpiN8I3c1dQ7fmuSrgHN",
          "component" : "Join",
          "metadata" : {
            "label" : "join_multiple_dataframes_2",
            "slug" : "join_multiple_dataframes_2",
            "x" : 300,
            "y" : 2040,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "FkKZgVIlrdt0sfHmVC1eC$$5OVtn5dsTkgShSYSpt2BT",
              "slug" : "c",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "START",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "STOP",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PATIENT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ENCOUNTER",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "Qia8hddbzKdvqSX5m8v3F$$xy85RXLMFzaG4VaJ00DHE",
              "slug" : "srctostdvm",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "SOURCE_CODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CODE_DESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VALID_START_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VALID_END_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_NAME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_STANDARD_CONCEPT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "qhufDSsX4ol_keoncZfwY$$S9So1fZnTVOl70Pgxvp4m",
              "slug" : "srctosrcvm",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "SOURCE_CODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CODE_DESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VALID_START_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VALID_END_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_NAME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_STANDARD_CONCEPT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "iyRVAfkBx3ZUqX2c1qXYM$$-p1h54yOaaWXMVEdRFhFv",
              "slug" : "fv",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID_NEW",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "hpCWd_zvhzzzLRDlYfz6E$$-8uROa20eLstCvBg1MG-e",
              "slug" : "p",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "gender_concept_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "YEAR_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "MONTH_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DAY_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "BIRTH_DATETIME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "LOCATION_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROVIDER_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CARE_SITE_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PERSON_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "ilt6PXQdX3QpHHhmqg1Pe$$YI7twifBV4nOslAcymkVZ",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "conditions" : [ {
              "alias" : "srctostdvm",
              "expression" : {
                "format" : "sql",
                "expression" : "srctostdvm.SOURCE_CODE = c.CODE\nAND srctostdvm.TARGET_DOMAIN_ID = 'Drug'\nAND srctostdvm.SOURCE_VOCABULARY_ID = 'RxNorm'\nAND srctostdvm.TARGET_STANDARD_CONCEPT = 'S'\nAND (srctostdvm.TARGET_INVALID_REASON IS NULL OR srctostdvm.TARGET_INVALID_REASON = '')"
              },
              "joinType" : "inner"
            }, {
              "alias" : "srctosrcvm",
              "expression" : {
                "format" : "sql",
                "expression" : "srctosrcvm.SOURCE_CODE = c.CODE\nAND srctosrcvm.SOURCE_VOCABULARY_ID = 'RxNorm'"
              },
              "joinType" : "left_outer"
            }, {
              "alias" : "fv",
              "expression" : {
                "format" : "sql",
                "expression" : "fv.encounter_id = c.ENCOUNTER"
              },
              "joinType" : "left_outer"
            }, {
              "alias" : "p",
              "expression" : {
                "format" : "sql",
                "expression" : "p.PERSON_SOURCE_VALUE = c.PATIENT"
              },
              "joinType" : "inner"
            } ],
            "expressions" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "p.person_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "drug_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "coalesce(srctostdvm.TARGET_CONCEPT_ID, 0)"
              },
              "description" : "",
              "_row_id" : "c_224"
            }, {
              "target" : "drug_exposure_start_date",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(c.START as date)"
              },
              "description" : "",
              "_row_id" : "c_225"
            }, {
              "target" : "drug_exposure_start_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(c.START as timestamp)"
              },
              "description" : "",
              "_row_id" : "c_226"
            }, {
              "target" : "drug_exposure_end_date",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(coalesce(c.STOP, c.START) as date)"
              },
              "description" : "",
              "_row_id" : "c_227"
            }, {
              "target" : "drug_exposure_end_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(coalesce(c.STOP, c.START) as timestamp)"
              },
              "description" : "",
              "_row_id" : "c_228"
            }, {
              "target" : "verbatim_end_date",
              "expression" : {
                "format" : "sql",
                "expression" : "c.STOP"
              },
              "description" : "",
              "_row_id" : "c_229"
            }, {
              "target" : "drug_type_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "581452"
              },
              "description" : "",
              "_row_id" : "c_230"
            }, {
              "target" : "stop_reason",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(null as string)"
              },
              "description" : "",
              "_row_id" : "c_231"
            }, {
              "target" : "refills",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : "",
              "_row_id" : "c_232"
            }, {
              "target" : "quantity",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : "",
              "_row_id" : "c_233"
            }, {
              "target" : "days_supply",
              "expression" : {
                "format" : "sql",
                "expression" : "coalesce(datediff(c.STOP, c.START))"
              },
              "description" : "",
              "_row_id" : "c_234"
            }, {
              "target" : "sig",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(null as string)"
              },
              "description" : "",
              "_row_id" : "c_235"
            }, {
              "target" : "route_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : "",
              "_row_id" : "c_236"
            }, {
              "target" : "lot_number",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : "",
              "_row_id" : "c_237"
            }, {
              "target" : "provider_id",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : "",
              "_row_id" : "c_238"
            }, {
              "target" : "visit_occurrence_id",
              "expression" : {
                "format" : "sql",
                "expression" : "fv.VISIT_OCCURRENCE_ID_NEW"
              },
              "description" : "",
              "_row_id" : "c_239"
            }, {
              "target" : "visit_detail_id",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : "",
              "_row_id" : "c_240"
            }, {
              "target" : "drug_source_value",
              "expression" : {
                "format" : "sql",
                "expression" : "c.CODE"
              },
              "description" : "",
              "_row_id" : "c_241"
            }, {
              "target" : "drug_source_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "coalesce(srctosrcvm.SOURCE_CONCEPT_ID, 0)"
              },
              "description" : "",
              "_row_id" : "c_242"
            }, {
              "target" : "route_source_value",
              "expression" : {
                "format" : "sql",
                "expression" : "null"
              },
              "description" : "",
              "_row_id" : "c_243"
            }, {
              "target" : "dose_unit_source_value",
              "expression" : {
                "format" : "sql",
                "expression" : "null"
              },
              "description" : "",
              "_row_id" : "c_244"
            } ],
            "hints" : [ {
              "id" : "FkKZgVIlrdt0sfHmVC1eC$$5OVtn5dsTkgShSYSpt2BT",
              "alias" : "c",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "Qia8hddbzKdvqSX5m8v3F$$xy85RXLMFzaG4VaJ00DHE",
              "alias" : "srctostdvm",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "qhufDSsX4ol_keoncZfwY$$S9So1fZnTVOl70Pgxvp4m",
              "alias" : "srctosrcvm",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "iyRVAfkBx3ZUqX2c1qXYM$$-p1h54yOaaWXMVEdRFhFv",
              "alias" : "fv",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "hpCWd_zvhzzzLRDlYfz6E$$-8uROa20eLstCvBg1MG-e",
              "alias" : "p",
              "hintType" : "none",
              "propagateColumns" : false
            } ],
            "allIn1" : null,
            "activeTab" : "expressions",
            "columnsSelector" : [ "qhufDSsX4ol_keoncZfwY$$S9So1fZnTVOl70Pgxvp4m##SOURCE_CODE", "Qia8hddbzKdvqSX5m8v3F$$xy85RXLMFzaG4VaJ00DHE##SOURCE_VOCABULARY_ID", "Qia8hddbzKdvqSX5m8v3F$$xy85RXLMFzaG4VaJ00DHE##SOURCE_CODE", "iyRVAfkBx3ZUqX2c1qXYM$$-p1h54yOaaWXMVEdRFhFv##encounter_id", "qhufDSsX4ol_keoncZfwY$$S9So1fZnTVOl70Pgxvp4m##SOURCE_VOCABULARY_ID", "FkKZgVIlrdt0sfHmVC1eC$$5OVtn5dsTkgShSYSpt2BT##CODE", "Qia8hddbzKdvqSX5m8v3F$$xy85RXLMFzaG4VaJ00DHE##TARGET_STANDARD_CONCEPT", "Qia8hddbzKdvqSX5m8v3F$$xy85RXLMFzaG4VaJ00DHE##TARGET_DOMAIN_ID", "FkKZgVIlrdt0sfHmVC1eC$$5OVtn5dsTkgShSYSpt2BT##ENCOUNTER", "hpCWd_zvhzzzLRDlYfz6E$$-8uROa20eLstCvBg1MG-e##PERSON_SOURCE_VALUE", "FkKZgVIlrdt0sfHmVC1eC$$5OVtn5dsTkgShSYSpt2BT##PATIENT", "Qia8hddbzKdvqSX5m8v3F$$xy85RXLMFzaG4VaJ00DHE##TARGET_INVALID_REASON", "iyRVAfkBx3ZUqX2c1qXYM$$-p1h54yOaaWXMVEdRFhFv##VISIT_OCCURRENCE_ID_NEW", "qhufDSsX4ol_keoncZfwY$$S9So1fZnTVOl70Pgxvp4m##SOURCE_CONCEPT_ID", "hpCWd_zvhzzzLRDlYfz6E$$-8uROa20eLstCvBg1MG-e##person_id", "FkKZgVIlrdt0sfHmVC1eC$$5OVtn5dsTkgShSYSpt2BT##START", "FkKZgVIlrdt0sfHmVC1eC$$5OVtn5dsTkgShSYSpt2BT##CODE", "FkKZgVIlrdt0sfHmVC1eC$$5OVtn5dsTkgShSYSpt2BT##STOP", "Qia8hddbzKdvqSX5m8v3F$$xy85RXLMFzaG4VaJ00DHE##TARGET_CONCEPT_ID" ],
            "allIn0" : null,
            "whereClause" : null,
            "headAlias" : "c"
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Join",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "obPnRGEVzYHnRjlmpchAh$$fj74ErPBfoV5nmaPE5sCC" : {
          "id" : "obPnRGEVzYHnRjlmpchAh$$fj74ErPBfoV5nmaPE5sCC",
          "component" : "Source",
          "metadata" : {
            "label" : "source_to_source_vocab_map_2",
            "slug" : "source_to_source_vocab_map_2",
            "x" : 0,
            "y" : 2020,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "cfcSnonu8fVSN0Oe1gHPa$$mLcP3cghHoUSCP9eBOFC4",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/source_to_source_vocab_map"
          }
        },
        "xZiBk6AuqeKeY-HOTW2nL$$zc2DQ9Pd8br2PTrNCn2i0" : {
          "id" : "xZiBk6AuqeKeY-HOTW2nL$$zc2DQ9Pd8br2PTrNCn2i0",
          "component" : "Target",
          "metadata" : {
            "label" : "drug_exposure",
            "slug" : "drug_exposure",
            "x" : 1120,
            "y" : 2700,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "VGnoFCJCj5oxFOOwplDHv$$HKFUai1AprRVxTm0s9XqL",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "drug_exposure_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_concept_id",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_start_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_start_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_end_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_end_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "verbatim_end_date",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_type_concept_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "stop_reason",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "refills",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "quantity",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "days_supply",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "sig",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "route_concept_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lot_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "provider_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "visit_occurrence_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "visit_detail_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_source_concept_id",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "route_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "dose_unit_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/drug_exposure"
          }
        },
        "xI2ysNJz0N4WaQimitwjx$$2ANED8msNjeJgI5BypnAc" : {
          "id" : "xI2ysNJz0N4WaQimitwjx$$2ANED8msNjeJgI5BypnAc",
          "component" : "Source",
          "metadata" : {
            "label" : "source_to_standard_vocab_map_6",
            "slug" : "source_to_standard_vocab_map_6",
            "x" : 0,
            "y" : 1880,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "xdgATxa-5sfuT71AgIcdG$$efuGUlucOhtXMygLUfuOi",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/source_to_standard_vocab_map"
          }
        },
        "TAhUt-5Vs98p1-YRRN7P_$$XH6M0MXWJiOFmNs9dkXxn" : {
          "id" : "TAhUt-5Vs98p1-YRRN7P_$$XH6M0MXWJiOFmNs9dkXxn",
          "component" : "Source",
          "metadata" : {
            "label" : "final_visit_ids_6",
            "slug" : "final_visit_ids_6",
            "x" : 0,
            "y" : 2900,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "KCvHs2U-uSosWlFbzra48$$1t2AaWATdThulmbvaKhjD",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/final_visit_ids"
          }
        },
        "G2WEpQK9-Wp0QMfjAAB82$$LL2zHJZ984maN3K6oOiN2" : {
          "id" : "G2WEpQK9-Wp0QMfjAAB82$$LL2zHJZ984maN3K6oOiN2",
          "component" : "Source",
          "metadata" : {
            "label" : "conditions_1",
            "slug" : "conditions_1",
            "x" : 0,
            "y" : 1740,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "L_0uB2tYRIpyYJ1-H_bDR$$3OXqH7Ww-n_sVhd3PDjwr",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/l0_bronze_layer_conditions"
          }
        },
        "oyclxPURmxBOEbWM5Ojnr$$I9nNJ4SO0pZc4fY4wuQK2" : {
          "id" : "oyclxPURmxBOEbWM5Ojnr$$I9nNJ4SO0pZc4fY4wuQK2",
          "component" : "Source",
          "metadata" : {
            "label" : "person_7",
            "slug" : "person_7",
            "x" : 0,
            "y" : 3040,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "c5V18QHzt_lJa3jCEqRAR$$cuRaidcnb8W2NH3nSmxAq",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/person"
          }
        },
        "WnXPO-tOJxJZoitGRzOEY$$2ObBdEX26u_q-6ddxrA3-" : {
          "id" : "WnXPO-tOJxJZoitGRzOEY$$2ObBdEX26u_q-6ddxrA3-",
          "component" : "Source",
          "metadata" : {
            "label" : "final_visit_ids_5",
            "slug" : "final_visit_ids_5",
            "x" : 0,
            "y" : 2160,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "Fm-Twua2P48A6GXtyqF4O$$QucuV90yumfgOwuRt8wA_",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/final_visit_ids"
          }
        },
        "2_fdqOxwXvMeoFLft9v6q$$9FDf7DrgmQyBANL2ce_FR" : {
          "id" : "2_fdqOxwXvMeoFLft9v6q$$9FDf7DrgmQyBANL2ce_FR",
          "component" : "Source",
          "metadata" : {
            "label" : "source_to_source_vocab_map_3_1",
            "slug" : "source_to_source_vocab_map_3_1",
            "x" : 0,
            "y" : 3480,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "ptwLghJnGTDi0FKjmKSdP$$qpYxj7d6WAYYsiW5OBWKJ",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/source_to_source_vocab_map"
          }
        },
        "DLOLdcMmSPSk0yP1xz5TE$$hR7t9yOc07SQhFb3FCl7r" : {
          "id" : "DLOLdcMmSPSk0yP1xz5TE$$hR7t9yOc07SQhFb3FCl7r",
          "component" : "Reformat",
          "metadata" : {
            "label" : "drug_exposures_by_person_id",
            "slug" : "drug_exposures_by_person_id",
            "x" : 940,
            "y" : 2700,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ",
              "slug" : "SetOperation_3",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_concept_id",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_start_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_start_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_end_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_end_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "verbatim_end_date",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_type_concept_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "stop_reason",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "refills",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "quantity",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "days_supply",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "sig",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "route_concept_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lot_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "provider_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "visit_occurrence_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "visit_detail_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_source_concept_id",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "route_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "dose_unit_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "LtPdjLzklF1khyUXgI-UG$$YiX0BEdoKZT9kH9_hJcUX",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "drug_exposure_id",
              "expression" : {
                "format" : "sql",
                "expression" : "row_number() OVER (PARTITION BY 1 ORDER BY person_id)"
              },
              "description" : ""
            }, {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "drug_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_concept_id"
              },
              "description" : ""
            }, {
              "target" : "drug_exposure_start_date",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_exposure_start_date"
              },
              "description" : ""
            }, {
              "target" : "drug_exposure_start_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_exposure_start_datetime"
              },
              "description" : ""
            }, {
              "target" : "drug_exposure_end_date",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_exposure_end_date"
              },
              "description" : ""
            }, {
              "target" : "drug_exposure_end_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_exposure_end_datetime"
              },
              "description" : ""
            }, {
              "target" : "verbatim_end_date",
              "expression" : {
                "format" : "sql",
                "expression" : "verbatim_end_date"
              },
              "description" : ""
            }, {
              "target" : "drug_type_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_type_concept_id"
              },
              "description" : ""
            }, {
              "target" : "stop_reason",
              "expression" : {
                "format" : "sql",
                "expression" : "stop_reason"
              },
              "description" : ""
            }, {
              "target" : "refills",
              "expression" : {
                "format" : "sql",
                "expression" : "refills"
              },
              "description" : ""
            }, {
              "target" : "quantity",
              "expression" : {
                "format" : "sql",
                "expression" : "quantity"
              },
              "description" : ""
            }, {
              "target" : "days_supply",
              "expression" : {
                "format" : "sql",
                "expression" : "days_supply"
              },
              "description" : ""
            }, {
              "target" : "sig",
              "expression" : {
                "format" : "sql",
                "expression" : "sig"
              },
              "description" : ""
            }, {
              "target" : "route_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "route_concept_id"
              },
              "description" : ""
            }, {
              "target" : "lot_number",
              "expression" : {
                "format" : "sql",
                "expression" : "lot_number"
              },
              "description" : ""
            }, {
              "target" : "provider_id",
              "expression" : {
                "format" : "sql",
                "expression" : "provider_id"
              },
              "description" : ""
            }, {
              "target" : "visit_occurrence_id",
              "expression" : {
                "format" : "sql",
                "expression" : "visit_occurrence_id"
              },
              "description" : ""
            }, {
              "target" : "visit_detail_id",
              "expression" : {
                "format" : "sql",
                "expression" : "visit_detail_id"
              },
              "description" : ""
            }, {
              "target" : "drug_source_value",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_source_value"
              },
              "description" : ""
            }, {
              "target" : "drug_source_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "drug_source_concept_id"
              },
              "description" : ""
            }, {
              "target" : "route_source_value",
              "expression" : {
                "format" : "sql",
                "expression" : "route_source_value"
              },
              "description" : ""
            }, {
              "target" : "dose_unit_source_value",
              "expression" : {
                "format" : "sql",
                "expression" : "dose_unit_source_value"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##quantity", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##visit_detail_id", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##drug_exposure_end_datetime", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##drug_exposure_end_date", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##provider_id", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##sig", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##route_source_value", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##route_concept_id", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##drug_concept_id", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##stop_reason", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##person_id", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##lot_number", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##drug_exposure_start_datetime", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##days_supply", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##drug_type_concept_id", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##drug_source_value", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##drug_exposure_start_date", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##visit_occurrence_id", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##dose_unit_source_value", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##drug_source_concept_id", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##verbatim_end_date", "kuDau3m8ap_8AQG5V2Rpi$$RafvyUQpTAb8HmRYiskGJ##refills" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "MITnL5VxMjd75_SqI87hP$$mdtOUOA2vZsYuWTiuMXt8" : {
          "id" : "MITnL5VxMjd75_SqI87hP$$mdtOUOA2vZsYuWTiuMXt8",
          "component" : "SetOperation",
          "metadata" : {
            "label" : "SetOperation_3",
            "slug" : "SetOperation_3",
            "x" : 760,
            "y" : 2700,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "6GCIS6-SeOc5_OHIPBIq5$$x8IpqYKngUMbB16GzOUGH",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_concept_id",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_start_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_start_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_end_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_end_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "verbatim_end_date",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_type_concept_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "stop_reason",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "refills",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "quantity",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "days_supply",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "sig",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "route_concept_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lot_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "provider_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "visit_occurrence_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "visit_detail_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_source_concept_id",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "route_source_value",
                  "type" : "void",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "dose_unit_source_value",
                  "type" : "void",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "1I2p2bhV2mtHjZptMGDhm$$rtkqIT8wE5DjS1f9OWmMW",
              "slug" : "in1",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_concept_id",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_start_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_start_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_end_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_end_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "verbatim_end_date",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_type_concept_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "stop_reason",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "refills",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "quantity",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "days_supply",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "sig",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "route_concept_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lot_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "provider_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "visit_occurrence_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "visit_detail_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_source_concept_id",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "route_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "dose_unit_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "1z1-uilj1EVIxUuWUV91k$$DxbzJAWrlj51S3_2SP3d_",
              "slug" : "in2",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_concept_id",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_start_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_start_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_end_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_exposure_end_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "verbatim_end_date",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_type_concept_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "stop_reason",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "refills",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "quantity",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "days_supply",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "sig",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "route_concept_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lot_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "provider_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "visit_occurrence_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "visit_detail_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "drug_source_concept_id",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "route_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "dose_unit_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Csu7ivJXnIC9qB3q4dfVC$$s6F843BwGf89DEhTM5Njp",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "operationType" : "unionAll",
            "allowMissingColumns" : false
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/SetOperation",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "J3cSyilivxMEAfvHhouZm$$ydM72vOyEusu5q6mLq8oe" : {
          "id" : "J3cSyilivxMEAfvHhouZm$$ydM72vOyEusu5q6mLq8oe",
          "component" : "Source",
          "metadata" : {
            "label" : "immunizations",
            "slug" : "immunizations",
            "x" : 0,
            "y" : 3200,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "_qv61-_17IsSNBKXJ5Qwq$$j2QZt8tUn_KySs2ERmgsK",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/l0_bronze_layer_immunizations"
          }
        },
        "tEtQib_AlUlnCtMgTVtQ9$$T97Eml9MvfNkuC3Eg5z9L" : {
          "id" : "tEtQib_AlUlnCtMgTVtQ9$$T97Eml9MvfNkuC3Eg5z9L",
          "component" : "Source",
          "metadata" : {
            "label" : "medications",
            "slug" : "medications",
            "x" : 0,
            "y" : 2480,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "d837oEpHndHH8cI-RDjt_$$JxDYSylDF6Kg4OEoFZxXP",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/l0_bronze_layer_medications"
          }
        },
        "OxWhNlN-9vpm1l7c02hnv$$BEe_1J1L4_if-xOvPge__" : {
          "id" : "OxWhNlN-9vpm1l7c02hnv$$BEe_1J1L4_if-xOvPge__",
          "component" : "Source",
          "metadata" : {
            "label" : "final_visit_ids_6_1",
            "slug" : "final_visit_ids_6_1",
            "x" : 0,
            "y" : 3620,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "IusWbxUpxIhaqDhnLiXUM$$U_LFc0lWL-eWHB92ngG0j",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/final_visit_ids"
          }
        },
        "ZnDOAvpwPenUs1gq2DYW5$$XXY5oVnsTRNsQyPy7fP88" : {
          "id" : "ZnDOAvpwPenUs1gq2DYW5$$XXY5oVnsTRNsQyPy7fP88",
          "component" : "Source",
          "metadata" : {
            "label" : "source_to_standard_vocab_map_7",
            "slug" : "source_to_standard_vocab_map_7",
            "x" : 0,
            "y" : 2620,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "VfH2egr4EtcOG1aPUX0eL$$HEaHY4lA1Es8_hZAJgSjO",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/source_to_standard_vocab_map"
          }
        }
      }
    },
    "ROnmsu55TzsElf5LohLbb$$1gLRV9cgkORDIC4Z2393C" : {
      "id" : "ROnmsu55TzsElf5LohLbb$$1gLRV9cgkORDIC4Z2393C",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "all_visits_table",
        "slug" : "all_visits_table",
        "x" : 0,
        "y" : 300,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : { },
      "connections" : [ {
        "id" : "p4nZyTZwKu5I0EriNye_a",
        "source" : "2yoD5HmJcqzVJYvJZ-SZY$$QtUxD9JzMPENYr1C4k0t-",
        "sourcePort" : "OJxaf3wKqYUVplD1-pLm8$$0mWCQQhrg7SJUzIkgf2bM",
        "target" : "1GwEf2v4BXgDjSSJZUmCS$$jeP1HTl4XoPR2PUw5WNrd",
        "targetPort" : "EGPvPWOrPHv-MHvp2KGbC$$xy0dbDVCGiiyd8kYCIino"
      }, {
        "id" : "IuiU-H05RGIr4L6_PydpK",
        "source" : "i5YjIsz9x9i2tji9go-MF$$_PAPCPfDsfgROW14QqpWL",
        "sourcePort" : "DYyNxzaxJPb8g9GGgmBaK$$JWmd3-DxYwnkWEpYCEE1k",
        "target" : "1GwEf2v4BXgDjSSJZUmCS$$jeP1HTl4XoPR2PUw5WNrd",
        "targetPort" : "uEmmoiMfShMJxdWybivxZ$$3CAvIDwobg2DxyVp72VfJ"
      }, {
        "id" : "Gbq1zxffNzhMWzKyFGJPn",
        "source" : "nqJ15YynKRJewu9MLITCC$$nIjh-0lrwov9uiWo-pqlT",
        "sourcePort" : "LqQQnhO6CBfGZsdtEz3F4$$-BbrH7NaGsQLIqA-i5aUr",
        "target" : "1GwEf2v4BXgDjSSJZUmCS$$jeP1HTl4XoPR2PUw5WNrd",
        "targetPort" : "ythbDtkQeW4c6a2ga0pLZ$$Ce0gcp75YOeFbo02nnk28"
      }, {
        "id" : "2exxeA0UZcQu-z_nw08Fo$$CnGD_XC0bsd19tzxjABWy",
        "source" : "1GwEf2v4BXgDjSSJZUmCS$$jeP1HTl4XoPR2PUw5WNrd",
        "sourcePort" : "Aeego0w0MtjAHYIU_MdFg$$hMPC3bacnb7EFUtP184F1",
        "target" : "TzGFyhngKBR5gETws51AQ$$4F0z2lbclXeUizheir6bq",
        "targetPort" : "rX2_9BbObED1EplI9ZZA3$$fKXeS3Sq_VPeUUfgLqyu1"
      }, {
        "id" : "jMujfUJsmYDPfbFWzgwKl$$G_bYmn-bo_mXtaF5VyGat",
        "source" : "TzGFyhngKBR5gETws51AQ$$4F0z2lbclXeUizheir6bq",
        "sourcePort" : "4NEV_IN4BOr9g2F96d7RB$$ZotQ6Kcl97qkZHlWzREfQ",
        "target" : "BfP4UL-lR9tEZRegY9EKU$$sXhE8FBKkjELM_B43W1o2",
        "targetPort" : "QntUUu6fV9Eq-hlvRvB1O$$9HlDAweHEtfD_NQ2UiNCb"
      } ],
      "processes" : {
        "nqJ15YynKRJewu9MLITCC$$nIjh-0lrwov9uiWo-pqlT" : {
          "id" : "nqJ15YynKRJewu9MLITCC$$nIjh-0lrwov9uiWo-pqlT",
          "component" : "Subgraph",
          "metadata" : {
            "label" : "OP_VISITS",
            "slug" : "OP_VISITS",
            "x" : -360,
            "y" : 40,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "LqQQnhO6CBfGZsdtEz3F4$$-BbrH7NaGsQLIqA-i5aUr",
              "slug" : "out0"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : { },
          "connections" : [ {
            "id" : "Srfygbp4OF1tnwvDCZyWL$$D0APgVEOAKYUlaU1S9FYA",
            "source" : "gimk7YlyF_bj5hM6jgjGV$$2mPZegcWvcBHRyy8mDuVr",
            "sourcePort" : "aPsOvoHPfzhX0pZqUpTTE$$Z37cIcEtZ0NF9YOXY8uh3",
            "target" : "54VInQWoShYlfci6MUDJk$$juIKG7YQ9amcUUrdvQaZl",
            "targetPort" : "b2TZpfHaVS547m-HtDhi0$$lcQjjM8qtWNmYJtFGL9eJ"
          }, {
            "id" : "hKInqHAG-fyGmgBgmud2C$$4SVFxa-mPmM_ubqwm4tY4",
            "source" : "54VInQWoShYlfci6MUDJk$$juIKG7YQ9amcUUrdvQaZl",
            "sourcePort" : "XudmRRsuLiYzW4gAOqu3o$$8549x8qTMuQ7idXBND8MQ",
            "target" : "lTMgaaz567ywaO-anKF7w$$dKFzeDYDe9aJVecy2YOeC",
            "targetPort" : "L7PxL2uHYn3SGnhzaBDV3$$3TzqegtLXB9mgvhmjMt3N"
          }, {
            "id" : "dZwXq-9gSF00YBshqcT9d$$bXbGcWM9ncUbQTaI8VJKm",
            "source" : "lTMgaaz567ywaO-anKF7w$$dKFzeDYDe9aJVecy2YOeC",
            "sourcePort" : "2rhSLHUQPS3pQZbdCc5-M$$-8aRC8G2ceuywY60JD9fn",
            "target" : "hifdDmQjkAUavpvVjwuXt$$pqH_et0N3GZpoYU1uB4rQ",
            "targetPort" : "rkx4RcSR_spqd-XLdoMBd$$KUoEITPdoIF9Jtfr6q600"
          }, {
            "id" : "vTpdCk8c4W27KiU7o0Qah$$kYD2k0lfa79JGIYxumOPH",
            "source" : "hifdDmQjkAUavpvVjwuXt$$pqH_et0N3GZpoYU1uB4rQ",
            "sourcePort" : "98FwrB5xR4Nqx_NwLnD_3$$ZMyukJ7gDjOrohwq2I6SX",
            "target" : "6KoVjtkh1Y-cTjt3rcl6M$$OaoDvK4gysmAWjdb-bRPF",
            "targetPort" : "uvSkkRP0T6Sbh9CiMeOcH$$ogPJUhybsgnNm37iX_765"
          }, {
            "id" : "rHzbvTbShgujyxNU-ZrGI$$6i1YrxA8Oo821Pv56W7Ah",
            "source" : "6KoVjtkh1Y-cTjt3rcl6M$$OaoDvK4gysmAWjdb-bRPF",
            "sourcePort" : "zrwU9_4YaJNqlUCJTwYSf$$yp0Py6dqij5Kf8V8nUybH",
            "target" : "i3AUDten0PeGKY0HPCQir$$mUZRt7ySIg0KojiJVFhor",
            "targetPort" : "s6mD7th9fdqv0ST1JmWWU$$VpgR-ijzvFYmKvavlU2Ha"
          }, {
            "id" : "-0wKg1UaIDbqcfdHWOdS7",
            "source" : "i3AUDten0PeGKY0HPCQir$$mUZRt7ySIg0KojiJVFhor",
            "sourcePort" : "iZVAbB52nRBdgkM-g8OZs$$-azPy7D5aD8jixw5RPod_",
            "target" : "nqJ15YynKRJewu9MLITCC$$nIjh-0lrwov9uiWo-pqlT",
            "targetPort" : "LqQQnhO6CBfGZsdtEz3F4$$-BbrH7NaGsQLIqA-i5aUr"
          } ],
          "processes" : {
            "54VInQWoShYlfci6MUDJk$$juIKG7YQ9amcUUrdvQaZl" : {
              "id" : "54VInQWoShYlfci6MUDJk$$juIKG7YQ9amcUUrdvQaZl",
              "component" : "Filter",
              "metadata" : {
                "label" : "filter_encounterclass",
                "slug" : "filter_encounterclass",
                "x" : 220,
                "y" : 20,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "b2TZpfHaVS547m-HtDhi0$$lcQjjM8qtWNmYJtFGL9eJ",
                  "slug" : "in0",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "Id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "START",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "STOP",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "PATIENT",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "PROVIDER",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "ENCOUNTERCLASS",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "CODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "DESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "COST",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "REASONCODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "REASONDESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "XudmRRsuLiYzW4gAOqu3o$$8549x8qTMuQ7idXBND8MQ",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "columnsSelector" : [ "b2TZpfHaVS547m-HtDhi0$$lcQjjM8qtWNmYJtFGL9eJ##ENCOUNTERCLASS" ],
                "condition" : {
                  "format" : "sql",
                  "expression" : "encounterclass in ('ambulatory', 'wellness', 'outpatient')"
                }
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Filter",
                "projectName" : "ProphecySparkBasicsPython"
              }
            },
            "hifdDmQjkAUavpvVjwuXt$$pqH_et0N3GZpoYU1uB4rQ" : {
              "id" : "hifdDmQjkAUavpvVjwuXt$$pqH_et0N3GZpoYU1uB4rQ",
              "component" : "Reformat",
              "metadata" : {
                "label" : "CTE_VISITS_DISTINCT",
                "slug" : "CTE_VISITS_DISTINCT",
                "x" : 620,
                "y" : 20,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "rkx4RcSR_spqd-XLdoMBd$$KUoEITPdoIF9Jtfr6q600",
                  "slug" : "encounter_id_by_patient",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "PATIENT",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "ENCOUNTERCLASS",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "START",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "STOP",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "encounter_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "98FwrB5xR4Nqx_NwLnD_3$$ZMyukJ7gDjOrohwq2I6SX",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
                "expressions" : [ {
                  "target" : "encounter_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "encounter_id"
                  },
                  "description" : ""
                }, {
                  "target" : "patient",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "PATIENT"
                  },
                  "description" : ""
                }, {
                  "target" : "encounterclass",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "ENCOUNTERCLASS"
                  },
                  "description" : ""
                }, {
                  "target" : "VISIT_START_DATE",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "START"
                  },
                  "description" : ""
                }, {
                  "target" : "VISIT_END_DATE",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "STOP"
                  },
                  "description" : ""
                } ],
                "importString" : "",
                "activeTab" : "expressions",
                "columnsSelector" : [ "rkx4RcSR_spqd-XLdoMBd$$KUoEITPdoIF9Jtfr6q600##PATIENT", "rkx4RcSR_spqd-XLdoMBd$$KUoEITPdoIF9Jtfr6q600##STOP", "rkx4RcSR_spqd-XLdoMBd$$KUoEITPdoIF9Jtfr6q600##encounter_id", "rkx4RcSR_spqd-XLdoMBd$$KUoEITPdoIF9Jtfr6q600##ENCOUNTERCLASS", "rkx4RcSR_spqd-XLdoMBd$$KUoEITPdoIF9Jtfr6q600##START" ]
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
                "projectName" : "ProphecySparkBasicsPython"
              }
            },
            "i3AUDten0PeGKY0HPCQir$$mUZRt7ySIg0KojiJVFhor" : {
              "id" : "i3AUDten0PeGKY0HPCQir$$mUZRt7ySIg0KojiJVFhor",
              "component" : "Reformat",
              "metadata" : {
                "label" : "encounters_projection",
                "slug" : "encounters_projection",
                "x" : 1020,
                "y" : 20,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "s6mD7th9fdqv0ST1JmWWU$$VpgR-ijzvFYmKvavlU2Ha",
                  "slug" : "encounters_by_patient_visit",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "patient",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "encounterclass",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "VISIT_START_DATE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "encounter_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "VISIT_END_DATE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "iZVAbB52nRBdgkM-g8OZs$$-azPy7D5aD8jixw5RPod_",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
                "expressions" : [ {
                  "target" : "encounter_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "encounter_id"
                  },
                  "description" : ""
                }, {
                  "target" : "patient",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "patient"
                  },
                  "description" : ""
                }, {
                  "target" : "encounterclass",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "encounterclass"
                  },
                  "description" : ""
                }, {
                  "target" : "VISIT_START_DATE",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "VISIT_START_DATE"
                  },
                  "description" : ""
                }, {
                  "target" : "VISIT_END_DATE",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "VISIT_END_DATE"
                  },
                  "description" : ""
                } ],
                "importString" : "",
                "activeTab" : "expressions",
                "columnsSelector" : [ "s6mD7th9fdqv0ST1JmWWU$$VpgR-ijzvFYmKvavlU2Ha##encounterclass", "s6mD7th9fdqv0ST1JmWWU$$VpgR-ijzvFYmKvavlU2Ha##VISIT_START_DATE", "s6mD7th9fdqv0ST1JmWWU$$VpgR-ijzvFYmKvavlU2Ha##VISIT_END_DATE", "s6mD7th9fdqv0ST1JmWWU$$VpgR-ijzvFYmKvavlU2Ha##encounter_id", "s6mD7th9fdqv0ST1JmWWU$$VpgR-ijzvFYmKvavlU2Ha##patient" ]
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
                "projectName" : "ProphecySparkBasicsPython"
              }
            },
            "6KoVjtkh1Y-cTjt3rcl6M$$OaoDvK4gysmAWjdb-bRPF" : {
              "id" : "6KoVjtkh1Y-cTjt3rcl6M$$OaoDvK4gysmAWjdb-bRPF",
              "component" : "Aggregate",
              "metadata" : {
                "label" : "encounters_by_patient_visit",
                "slug" : "encounters_by_patient_visit",
                "x" : 820,
                "y" : 20,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "uvSkkRP0T6Sbh9CiMeOcH$$ogPJUhybsgnNm37iX_765",
                  "slug" : "CTE_VISITS_DISTINCT",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "encounter_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "patient",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "encounterclass",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "VISIT_START_DATE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "VISIT_END_DATE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "zrwU9_4YaJNqlUCJTwYSf$$yp0Py6dqij5Kf8V8nUybH",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "allIns" : false,
                "doPivot" : false,
                "aggregate" : [ {
                  "_row_id" : "c_298",
                  "target" : "encounter_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "min(encounter_id)"
                  },
                  "description" : ""
                }, {
                  "_row_id" : "c_299",
                  "target" : "VISIT_END_DATE",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "max(VISIT_END_DATE)"
                  },
                  "description" : ""
                } ],
                "allowSelection" : true,
                "pivotColumn" : null,
                "pivotValues" : [ ],
                "activeTab" : "aggregate",
                "columnsSelector" : [ "uvSkkRP0T6Sbh9CiMeOcH$$ogPJUhybsgnNm37iX_765##VISIT_END_DATE", "uvSkkRP0T6Sbh9CiMeOcH$$ogPJUhybsgnNm37iX_765##encounterclass", "uvSkkRP0T6Sbh9CiMeOcH$$ogPJUhybsgnNm37iX_765##patient", "uvSkkRP0T6Sbh9CiMeOcH$$ogPJUhybsgnNm37iX_765##VISIT_START_DATE", "uvSkkRP0T6Sbh9CiMeOcH$$ogPJUhybsgnNm37iX_765##encounter_id" ],
                "groupBy" : [ {
                  "target" : "patient",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "patient"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "encounterclass",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "encounterclass"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "VISIT_START_DATE",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "VISIT_START_DATE"
                  },
                  "description" : "",
                  "_row_id" : null
                } ]
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Aggregate",
                "projectName" : "ProphecySparkBasicsPython"
              }
            },
            "lTMgaaz567ywaO-anKF7w$$dKFzeDYDe9aJVecy2YOeC" : {
              "id" : "lTMgaaz567ywaO-anKF7w$$dKFzeDYDe9aJVecy2YOeC",
              "component" : "Aggregate",
              "metadata" : {
                "label" : "encounter_id_by_patient",
                "slug" : "encounter_id_by_patient",
                "x" : 420,
                "y" : 20,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "L7PxL2uHYn3SGnhzaBDV3$$3TzqegtLXB9mgvhmjMt3N",
                  "slug" : "encounters_5",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "Id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "START",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "STOP",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "PATIENT",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "PROVIDER",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "ENCOUNTERCLASS",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "CODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "DESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "COST",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "REASONCODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "REASONDESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "2rhSLHUQPS3pQZbdCc5-M$$-8aRC8G2ceuywY60JD9fn",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "allIns" : false,
                "doPivot" : false,
                "aggregate" : [ {
                  "_row_id" : "c_280",
                  "target" : "encounter_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "min(Id)"
                  },
                  "description" : ""
                } ],
                "allowSelection" : true,
                "pivotColumn" : null,
                "pivotValues" : [ ],
                "activeTab" : "aggregate",
                "columnsSelector" : [ ],
                "groupBy" : [ {
                  "target" : "PATIENT",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "PATIENT"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "ENCOUNTERCLASS",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "ENCOUNTERCLASS"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "START",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "START"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "STOP",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "STOP"
                  },
                  "description" : "",
                  "_row_id" : null
                } ]
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Aggregate",
                "projectName" : "ProphecySparkBasicsPython"
              }
            },
            "gimk7YlyF_bj5hM6jgjGV$$2mPZegcWvcBHRyy8mDuVr" : {
              "id" : "gimk7YlyF_bj5hM6jgjGV$$2mPZegcWvcBHRyy8mDuVr",
              "component" : "Source",
              "metadata" : {
                "label" : "encounters_5",
                "slug" : "encounters_5",
                "x" : 20,
                "y" : 20,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ ],
                "outputs" : [ {
                  "id" : "aPsOvoHPfzhX0pZqUpTTE$$Z37cIcEtZ0NF9YOXY8uh3",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "datasetId" : "datasets/l0_bronze_layer_encounters"
              }
            }
          }
        },
        "1GwEf2v4BXgDjSSJZUmCS$$jeP1HTl4XoPR2PUw5WNrd" : {
          "id" : "1GwEf2v4BXgDjSSJZUmCS$$jeP1HTl4XoPR2PUw5WNrd",
          "component" : "SetOperation",
          "metadata" : {
            "label" : "SetOperation_1",
            "slug" : "SetOperation_1",
            "x" : -100,
            "y" : -120,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "EGPvPWOrPHv-MHvp2KGbC$$xy0dbDVCGiiyd8kYCIino",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "patient",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "encounterclass",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_START_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_END_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "uEmmoiMfShMJxdWybivxZ$$3CAvIDwobg2DxyVp72VfJ",
              "slug" : "in1",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "patient",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "encounterclass",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_START_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_END_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "ythbDtkQeW4c6a2ga0pLZ$$Ce0gcp75YOeFbo02nnk28",
              "slug" : "in2",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "patient",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "encounterclass",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_START_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_END_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Aeego0w0MtjAHYIU_MdFg$$hMPC3bacnb7EFUtP184F1",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "operationType" : "unionAll",
            "allowMissingColumns" : false
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/SetOperation",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "2yoD5HmJcqzVJYvJZ-SZY$$QtUxD9JzMPENYr1C4k0t-" : {
          "id" : "2yoD5HmJcqzVJYvJZ-SZY$$QtUxD9JzMPENYr1C4k0t-",
          "component" : "Subgraph",
          "metadata" : {
            "label" : "IP_VISITS",
            "slug" : "IP_VISITS",
            "x" : -380,
            "y" : -300,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "OJxaf3wKqYUVplD1-pLm8$$0mWCQQhrg7SJUzIkgf2bM",
              "slug" : "out0"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : { },
          "connections" : [ {
            "id" : "tKOClBMXPqBLzbPtRl3Fa$$ufRXsUk3eGAIdhZ18c_i6",
            "source" : "_WJcJuerQf1HhARr7nDTn$$dFnB3TLNZy5Jz-nCXA63e",
            "sourcePort" : "bVet10n6RW-6S2syer85x$$FP-0NjlOZdWClLAbvFBlM",
            "target" : "-T4EMKkbwVPYwdn-_RJ-t$$Dextf0fJZwvnHSXWfeQSr",
            "targetPort" : "9mrbbYqHzRAv7Ds6fxcRH$$6-ot0Be-CKjMBt49xjJyd"
          }, {
            "id" : "XLkuGd-QMSJsN1fq4bor4$$iQrk8GZyo2dJl30_Z7PFm",
            "source" : "Q-y6Z9sLUNR8AmBpH1pC0$$jHVbyerqaP2b9UpUqGTvZ",
            "sourcePort" : "hYW9JYX1iN5vjWVcS8uui$$2eg08Urfd49Ra_fxDbDyb",
            "target" : "-T4EMKkbwVPYwdn-_RJ-t$$Dextf0fJZwvnHSXWfeQSr",
            "targetPort" : "IyiiwgpAbRlPxuzvpbn1r$$wHm0DstOVRKLt2zcEuPFE"
          }, {
            "id" : "ET8f4QpNXCpwpug4mCBDZ$$2Ua2IaemQNavmTOASmytF",
            "source" : "-T4EMKkbwVPYwdn-_RJ-t$$Dextf0fJZwvnHSXWfeQSr",
            "sourcePort" : "bs9-9NH9Pa1feaveKm4oS$$cYMrFOhhPreWBubR3qYE4",
            "target" : "EVBHMbzqh6JNTdBmGE6Ik$$__QPAHn78mEKRmU5IOaGJ",
            "targetPort" : "sKTcq4pRfesIaz46vTVr5$$n_xo-PSYrHxexF4Ii8VKD"
          }, {
            "id" : "LplE31b82Bx0m-viYJyRB$$oW9wX2rfX-6k5aNML_Rw9",
            "source" : "EVBHMbzqh6JNTdBmGE6Ik$$__QPAHn78mEKRmU5IOaGJ",
            "sourcePort" : "KJfsNnZjyAyS6d-ck9L2o$$caUZXSddK9JvqF90gHq0K",
            "target" : "fzn899bl2qCMLz3_UisLG$$cE4TUNf_DoR2TuYGHWgFb",
            "targetPort" : "bGbIRwi_R2QvRJ-nvWr4U$$oimfCEiSyWQYRaTSVXng9"
          }, {
            "id" : "ccIPE3w9H5Jo4QANXqJH9$$EFB0UXljamj7HQUaZ-_jJ",
            "source" : "fzn899bl2qCMLz3_UisLG$$cE4TUNf_DoR2TuYGHWgFb",
            "sourcePort" : "PtzGD_RZz_P3YWqu4O0KV$$mjTeNUlU_3URIp7uSK89u",
            "target" : "lsJVdRDlT0CCpDvHW6_bx$$Ez3u1QVY1J202ViePTuQj",
            "targetPort" : "7K_uYQyTI7e3hLUw2TmbC$$OR8EUp0q72YLFuCB4bKxU"
          }, {
            "id" : "gZmk70SSgxTs0lSwuQ3B8",
            "source" : "lsJVdRDlT0CCpDvHW6_bx$$Ez3u1QVY1J202ViePTuQj",
            "sourcePort" : "KuOhdAe_GE0VywmH363xC$$rAH9I-QOq8YyU7_KoeAOW",
            "target" : "2yoD5HmJcqzVJYvJZ-SZY$$QtUxD9JzMPENYr1C4k0t-",
            "targetPort" : "OJxaf3wKqYUVplD1-pLm8$$0mWCQQhrg7SJUzIkgf2bM"
          } ],
          "processes" : {
            "lsJVdRDlT0CCpDvHW6_bx$$Ez3u1QVY1J202ViePTuQj" : {
              "id" : "lsJVdRDlT0CCpDvHW6_bx$$Ez3u1QVY1J202ViePTuQj",
              "component" : "Reformat",
              "metadata" : {
                "label" : "encounter_projection",
                "slug" : "encounter_projection",
                "x" : 820,
                "y" : 120,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "7K_uYQyTI7e3hLUw2TmbC$$OR8EUp0q72YLFuCB4bKxU",
                  "slug" : "encounter_start_date",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "encounter_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "PATIENT",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "ENCOUNTERCLASS",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "VISIT_END_DATE",
                      "type" : "date",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "VISIT_START_DATE",
                      "type" : "date",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "KuOhdAe_GE0VywmH363xC$$rAH9I-QOq8YyU7_KoeAOW",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
                "expressions" : [ {
                  "target" : "encounter_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "encounter_id"
                  },
                  "description" : ""
                }, {
                  "target" : "patient",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "PATIENT"
                  },
                  "description" : ""
                }, {
                  "target" : "encounterclass",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "ENCOUNTERCLASS"
                  },
                  "description" : ""
                }, {
                  "target" : "VISIT_START_DATE",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "VISIT_START_DATE"
                  },
                  "description" : ""
                }, {
                  "target" : "VISIT_END_DATE",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "VISIT_END_DATE"
                  },
                  "description" : ""
                } ],
                "importString" : "",
                "activeTab" : "expressions",
                "columnsSelector" : [ "7K_uYQyTI7e3hLUw2TmbC$$OR8EUp0q72YLFuCB4bKxU##VISIT_END_DATE", "7K_uYQyTI7e3hLUw2TmbC$$OR8EUp0q72YLFuCB4bKxU##ENCOUNTERCLASS", "7K_uYQyTI7e3hLUw2TmbC$$OR8EUp0q72YLFuCB4bKxU##encounter_id", "7K_uYQyTI7e3hLUw2TmbC$$OR8EUp0q72YLFuCB4bKxU##VISIT_START_DATE", "7K_uYQyTI7e3hLUw2TmbC$$OR8EUp0q72YLFuCB4bKxU##PATIENT" ]
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
                "projectName" : "ProphecySparkBasicsPython"
              }
            },
            "EVBHMbzqh6JNTdBmGE6Ik$$__QPAHn78mEKRmU5IOaGJ" : {
              "id" : "EVBHMbzqh6JNTdBmGE6Ik$$__QPAHn78mEKRmU5IOaGJ",
              "component" : "Aggregate",
              "metadata" : {
                "label" : "CTE_VISIT_ENDS",
                "slug" : "CTE_VISIT_ENDS",
                "x" : 420,
                "y" : 120,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "sKTcq4pRfesIaz46vTVr5$$n_xo-PSYrHxexF4Ii8VKD",
                  "slug" : "in0",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "END_DATE",
                      "type" : "date",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "Id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "START",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "STOP",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "PATIENT",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "PROVIDER",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "ENCOUNTERCLASS",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "CODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "DESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "COST",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "REASONCODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "REASONDESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "KJfsNnZjyAyS6d-ck9L2o$$caUZXSddK9JvqF90gHq0K",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "allIns" : false,
                "doPivot" : false,
                "aggregate" : [ {
                  "target" : "encounter_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "min(Id)"
                  },
                  "description" : "",
                  "_row_id" : "c_181"
                }, {
                  "target" : "VISIT_END_DATE",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "min(END_DATE)"
                  },
                  "description" : "",
                  "_row_id" : "c_188"
                } ],
                "allowSelection" : true,
                "pivotColumn" : null,
                "pivotValues" : [ ],
                "activeTab" : "aggregate",
                "columnsSelector" : [ "sKTcq4pRfesIaz46vTVr5$$n_xo-PSYrHxexF4Ii8VKD##END_DATE", "sKTcq4pRfesIaz46vTVr5$$n_xo-PSYrHxexF4Ii8VKD##ENCOUNTERCLASS", "sKTcq4pRfesIaz46vTVr5$$n_xo-PSYrHxexF4Ii8VKD##PATIENT", "sKTcq4pRfesIaz46vTVr5$$n_xo-PSYrHxexF4Ii8VKD##Id", "sKTcq4pRfesIaz46vTVr5$$n_xo-PSYrHxexF4Ii8VKD##START" ],
                "groupBy" : [ {
                  "target" : "PATIENT",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "PATIENT"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "ENCOUNTERCLASS",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "ENCOUNTERCLASS"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "START",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "START"
                  },
                  "description" : "",
                  "_row_id" : null
                } ]
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Aggregate",
                "projectName" : "ProphecySparkBasicsPython"
              }
            },
            "-T4EMKkbwVPYwdn-_RJ-t$$Dextf0fJZwvnHSXWfeQSr" : {
              "id" : "-T4EMKkbwVPYwdn-_RJ-t$$Dextf0fJZwvnHSXWfeQSr",
              "component" : "Join",
              "metadata" : {
                "label" : "encounters_and_visits_join",
                "slug" : "encounters_and_visits_join",
                "x" : 220,
                "y" : 120,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "9mrbbYqHzRAv7Ds6fxcRH$$6-ot0Be-CKjMBt49xjJyd",
                  "slug" : "E",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "patient",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "encounterclass",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "END_DATE",
                      "type" : "date",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                }, {
                  "id" : "IyiiwgpAbRlPxuzvpbn1r$$wHm0DstOVRKLt2zcEuPFE",
                  "slug" : "V",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "Id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "START",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "STOP",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "PATIENT",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "PROVIDER",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "ENCOUNTERCLASS",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "CODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "DESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "COST",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "REASONCODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "REASONDESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "bs9-9NH9Pa1feaveKm4oS$$cYMrFOhhPreWBubR3qYE4",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "conditions" : [ {
                  "alias" : "V",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "E.patient = V.PATIENT and E.encounterclass = V.ENCOUNTERCLASS and E.END_DATE > V.START"
                  },
                  "joinType" : "inner"
                } ],
                "expressions" : [ {
                  "target" : "END_DATE",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "E.END_DATE"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "Id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "V.Id"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "START",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "V.START"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "STOP",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "V.STOP"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "PATIENT",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "V.PATIENT"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "PROVIDER",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "V.PROVIDER"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "ENCOUNTERCLASS",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "V.ENCOUNTERCLASS"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "CODE",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "V.CODE"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "DESCRIPTION",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "V.DESCRIPTION"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "COST",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "V.COST"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "REASONCODE",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "V.REASONCODE"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "REASONDESCRIPTION",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "V.REASONDESCRIPTION"
                  },
                  "description" : "",
                  "_row_id" : null
                } ],
                "hints" : [ {
                  "id" : "9mrbbYqHzRAv7Ds6fxcRH$$6-ot0Be-CKjMBt49xjJyd",
                  "alias" : "E",
                  "hintType" : "none",
                  "propagateColumns" : false
                }, {
                  "id" : "IyiiwgpAbRlPxuzvpbn1r$$wHm0DstOVRKLt2zcEuPFE",
                  "alias" : "V",
                  "hintType" : "none",
                  "propagateColumns" : false
                } ],
                "allIn1" : null,
                "activeTab" : "expressions",
                "columnsSelector" : [ "IyiiwgpAbRlPxuzvpbn1r$$wHm0DstOVRKLt2zcEuPFE##PATIENT", "9mrbbYqHzRAv7Ds6fxcRH$$6-ot0Be-CKjMBt49xjJyd##patient", "IyiiwgpAbRlPxuzvpbn1r$$wHm0DstOVRKLt2zcEuPFE##START", "9mrbbYqHzRAv7Ds6fxcRH$$6-ot0Be-CKjMBt49xjJyd##encounterclass", "9mrbbYqHzRAv7Ds6fxcRH$$6-ot0Be-CKjMBt49xjJyd##END_DATE", "IyiiwgpAbRlPxuzvpbn1r$$wHm0DstOVRKLt2zcEuPFE##ENCOUNTERCLASS", "IyiiwgpAbRlPxuzvpbn1r$$wHm0DstOVRKLt2zcEuPFE##REASONDESCRIPTION", "IyiiwgpAbRlPxuzvpbn1r$$wHm0DstOVRKLt2zcEuPFE##PATIENT", "IyiiwgpAbRlPxuzvpbn1r$$wHm0DstOVRKLt2zcEuPFE##STOP", "IyiiwgpAbRlPxuzvpbn1r$$wHm0DstOVRKLt2zcEuPFE##START", "IyiiwgpAbRlPxuzvpbn1r$$wHm0DstOVRKLt2zcEuPFE##REASONCODE", "IyiiwgpAbRlPxuzvpbn1r$$wHm0DstOVRKLt2zcEuPFE##DESCRIPTION", "IyiiwgpAbRlPxuzvpbn1r$$wHm0DstOVRKLt2zcEuPFE##CODE", "9mrbbYqHzRAv7Ds6fxcRH$$6-ot0Be-CKjMBt49xjJyd##END_DATE", "IyiiwgpAbRlPxuzvpbn1r$$wHm0DstOVRKLt2zcEuPFE##COST", "IyiiwgpAbRlPxuzvpbn1r$$wHm0DstOVRKLt2zcEuPFE##PROVIDER", "IyiiwgpAbRlPxuzvpbn1r$$wHm0DstOVRKLt2zcEuPFE##Id", "IyiiwgpAbRlPxuzvpbn1r$$wHm0DstOVRKLt2zcEuPFE##ENCOUNTERCLASS" ],
                "allIn0" : null,
                "whereClause" : null,
                "headAlias" : "E"
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Join",
                "projectName" : "ProphecySparkBasicsPython"
              }
            },
            "fzn899bl2qCMLz3_UisLG$$cE4TUNf_DoR2TuYGHWgFb" : {
              "id" : "fzn899bl2qCMLz3_UisLG$$cE4TUNf_DoR2TuYGHWgFb",
              "component" : "Aggregate",
              "metadata" : {
                "label" : "encounter_start_date",
                "slug" : "encounter_start_date",
                "x" : 620,
                "y" : 120,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "bGbIRwi_R2QvRJ-nvWr4U$$oimfCEiSyWQYRaTSVXng9",
                  "slug" : "in0",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "PATIENT",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "ENCOUNTERCLASS",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "START",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "encounter_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "VISIT_END_DATE",
                      "type" : "date",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "PtzGD_RZz_P3YWqu4O0KV$$mjTeNUlU_3URIp7uSK89u",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "allIns" : false,
                "doPivot" : false,
                "aggregate" : [ {
                  "_row_id" : "c_219",
                  "target" : "VISIT_START_DATE",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "min(VISIT_END_DATE)"
                  },
                  "description" : ""
                } ],
                "allowSelection" : true,
                "pivotColumn" : null,
                "pivotValues" : [ ],
                "activeTab" : "aggregate",
                "columnsSelector" : [ "bGbIRwi_R2QvRJ-nvWr4U$$oimfCEiSyWQYRaTSVXng9##encounter_id", "bGbIRwi_R2QvRJ-nvWr4U$$oimfCEiSyWQYRaTSVXng9##VISIT_END_DATE", "bGbIRwi_R2QvRJ-nvWr4U$$oimfCEiSyWQYRaTSVXng9##ENCOUNTERCLASS", "bGbIRwi_R2QvRJ-nvWr4U$$oimfCEiSyWQYRaTSVXng9##PATIENT" ],
                "groupBy" : [ {
                  "target" : "encounter_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "encounter_id"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "PATIENT",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "PATIENT"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "ENCOUNTERCLASS",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "ENCOUNTERCLASS"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "VISIT_END_DATE",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "VISIT_END_DATE"
                  },
                  "description" : "",
                  "_row_id" : null
                } ]
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Aggregate",
                "projectName" : "ProphecySparkBasicsPython"
              }
            },
            "_WJcJuerQf1HhARr7nDTn$$dFnB3TLNZy5Jz-nCXA63e" : {
              "id" : "_WJcJuerQf1HhARr7nDTn$$dFnB3TLNZy5Jz-nCXA63e",
              "component" : "Subgraph",
              "metadata" : {
                "label" : "CTE_END_DATES",
                "slug" : "CTE_END_DATES",
                "x" : 20,
                "y" : 20,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ ],
                "outputs" : [ {
                  "id" : "bVet10n6RW-6S2syer85x$$FP-0NjlOZdWClLAbvFBlM",
                  "slug" : "out0"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : { },
              "connections" : [ {
                "id" : "639QMMi0tIavlDWBs-g7M$$AllygLOw40SZZQfwzTD32",
                "source" : "NdOXlx54G-KsAjjvIgXYR$$tXy_q7gyDrTw3HjHCf1y4",
                "sourcePort" : "DkqRRrfWytBscIu4ptlVk$$R92L8U5gcWJZnuizsd8r6",
                "target" : "bkx4faNJv0NLVaPyoB7Bx$$Nc4HZZlrpbIqMmVA48fFl",
                "targetPort" : "SUITfJEzEqOrbmlHhluUj$$iVQz0-JPPPOT-_JZECVJo"
              }, {
                "id" : "vb1XbW7c-hdyxuXrykiT2",
                "source" : "LkJuouqm4de6GyVvCbVCe$$xOpUNZMloV8TkLchMgaGs",
                "sourcePort" : "zKqHPEfnMTc-8XF2N_5T3$$HSw0ZhodAkEYWCTslgRFl",
                "target" : "QKSWWc9PmuvsVG6z7P9_N$$BSpO6cI6w13RMt7GZTA_G",
                "targetPort" : "lgPb9XRzc70Rh7dLVxSXW$$eIdrJFKaHjZC2TaKcnFeJ"
              }, {
                "id" : "SjDmZyYe8SCIFfDYQA8_3$$vsnHuQ2DMUtGzRUkpxtak",
                "source" : "bkx4faNJv0NLVaPyoB7Bx$$Nc4HZZlrpbIqMmVA48fFl",
                "sourcePort" : "ws3EMou0_cM5OgNUUPrnB$$UDellOSx-lYWpJ0e1UQSu",
                "target" : "ZWHqscYAxhCi8okTDiJUV$$STkHQVzBrT0YZNRDsEKC1",
                "targetPort" : "Y11qb5j1GkJU-GgmjbnVD$$_5gS_FLqpdx-Z4aojYyYO"
              }, {
                "id" : "15YtWyZ0tkTcSIEOmgODQ$$7PRIxnr3N_iz8_fzSG457",
                "source" : "QKSWWc9PmuvsVG6z7P9_N$$BSpO6cI6w13RMt7GZTA_G",
                "sourcePort" : "t_-AJUeZA0QKg1QzIJsye$$pGOgH5L9KUlVD1F-CfOnI",
                "target" : "Du-g87795-ri0Y6Iwp_vK$$Zou4xmnVWuewebz0qqLA-",
                "targetPort" : "JMqELwc9fAbASrzzZS2Qc$$vdPdG2-_tun3A6b5_8WPi"
              }, {
                "id" : "qFQm8HemWBsori9IeCZA4$$Mla953Aimku4VqPlYEvtB",
                "source" : "ZWHqscYAxhCi8okTDiJUV$$STkHQVzBrT0YZNRDsEKC1",
                "sourcePort" : "8Bnwkmv_VjPGcl1wIR06E$$9t1rlTTWRRTUnkyRmhbvv",
                "target" : "d0KS6vsaG024tTLOKRCgL$$JhswWyzgp9cGIckTh_IxC",
                "targetPort" : "Pt_uKfUXT5nlP1hcJ06gT$$dmQLqdTeJyIDutBINV0XN"
              }, {
                "id" : "r8cE6JPgMHx-sdwUq19Ay$$rCNblQ9jptgQt30oXfhB7",
                "source" : "Du-g87795-ri0Y6Iwp_vK$$Zou4xmnVWuewebz0qqLA-",
                "sourcePort" : "4AZ-EmeZQT5MQLpjNx08H$$zoQu_Eoar7PxqPrAGbXPK",
                "target" : "d0KS6vsaG024tTLOKRCgL$$JhswWyzgp9cGIckTh_IxC",
                "targetPort" : "LY3emSGeDHfhKSJ1OKvsc$$GxLetb3k3pCSeYC3LUG-e"
              }, {
                "id" : "dfCsM-I2msk2zgu2j5Oc2$$ntLNFAMSVDKjEh8hj9ThR",
                "source" : "d0KS6vsaG024tTLOKRCgL$$JhswWyzgp9cGIckTh_IxC",
                "sourcePort" : "8oZCMRPOqcngW65lo5_qT$$ZzKSMC2ba7yAtyMZkP7Hn",
                "target" : "mWUDhPr0q3Um5sq-_AzSU$$hICtWhql3IDSr9SKisGiM",
                "targetPort" : "QR8IRJft5Hxi7MBH4Bq2C$$tzoHHXmEQT8aii06vrl52"
              }, {
                "id" : "l617DAEpHFj56tBqHgWJz$$n0uYwr8Jta4qe5fNRHGsU",
                "source" : "mWUDhPr0q3Um5sq-_AzSU$$hICtWhql3IDSr9SKisGiM",
                "sourcePort" : "Yhv9H3KJNHaMZx7T9xbnt$$Ho_b1hLkfQ3VklO3u3Kg0",
                "target" : "Mgj4rK8OfX7klbG19IjFL$$hobBp9cck0tjZfLH4N3or",
                "targetPort" : "4FhRyRFIDYlqnuj2EJ4e3$$U6wrZE38JZuDc_5LASPIy"
              }, {
                "id" : "yn8dDY7m4zDfvcFPJurnY$$vhl31xFCEQSYWWt6XQV_S",
                "source" : "Mgj4rK8OfX7klbG19IjFL$$hobBp9cck0tjZfLH4N3or",
                "sourcePort" : "Sb_Q2WMvYB327UlvWcr-K$$J8pkFcmCKh7gzsHK0GKjQ",
                "target" : "WloyzPVZcWt0-canaTBTD$$NdgXOMRhjuqKh--szwOWe",
                "targetPort" : "HzJ8mrRJVYur7VrUE-hPd$$qHwbDlX0SW0uFNjerxdvp"
              }, {
                "id" : "ibU7tIgw1GPTC9F_zkpq9",
                "source" : "WloyzPVZcWt0-canaTBTD$$NdgXOMRhjuqKh--szwOWe",
                "sourcePort" : "uWxweHJroPWq9dn0S2TwF$$dyY05fY6guw2cFCODLy76",
                "target" : "_WJcJuerQf1HhARr7nDTn$$dFnB3TLNZy5Jz-nCXA63e",
                "targetPort" : "bVet10n6RW-6S2syer85x$$FP-0NjlOZdWClLAbvFBlM"
              } ],
              "processes" : {
                "Du-g87795-ri0Y6Iwp_vK$$Zou4xmnVWuewebz0qqLA-" : {
                  "id" : "Du-g87795-ri0Y6Iwp_vK$$Zou4xmnVWuewebz0qqLA-",
                  "component" : "Reformat",
                  "metadata" : {
                    "label" : "reformatted_inpatient_encounters",
                    "slug" : "reformatted_inpatient_encounters",
                    "x" : 420,
                    "y" : 220,
                    "phase" : 0,
                    "cache" : false,
                    "detailedStats" : false,
                    "isImported" : false
                  },
                  "ports" : {
                    "inputs" : [ {
                      "id" : "JMqELwc9fAbASrzzZS2Qc$$vdPdG2-_tun3A6b5_8WPi",
                      "slug" : "inpatient_encounters_1",
                      "schema" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "Id",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "START",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "STOP",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "PATIENT",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "PROVIDER",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "ENCOUNTERCLASS",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "CODE",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "DESCRIPTION",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "COST",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "REASONCODE",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "REASONDESCRIPTION",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "isStreaming" : false
                    } ],
                    "outputs" : [ {
                      "id" : "4AZ-EmeZQT5MQLpjNx08H$$zoQu_Eoar7PxqPrAGbXPK",
                      "slug" : "out"
                    } ],
                    "selectedInputFields" : [ ],
                    "isCustomOutputSchema" : false,
                    "autoUpdateOnRun" : false
                  },
                  "properties" : {
                    "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
                    "expressions" : [ {
                      "target" : "patient",
                      "expression" : {
                        "format" : "sql",
                        "expression" : "PATIENT"
                      },
                      "description" : ""
                    }, {
                      "target" : "encounterclass",
                      "expression" : {
                        "format" : "sql",
                        "expression" : "ENCOUNTERCLASS"
                      },
                      "description" : ""
                    }, {
                      "target" : "EVENT_DATE",
                      "expression" : {
                        "format" : "sql",
                        "expression" : "date_add(STOP, 1)"
                      },
                      "description" : ""
                    }, {
                      "target" : "EVENT_TYPE",
                      "expression" : {
                        "format" : "sql",
                        "expression" : "1"
                      },
                      "description" : ""
                    }, {
                      "target" : "START_ORDINAL",
                      "expression" : {
                        "format" : "sql",
                        "expression" : "NULL"
                      },
                      "description" : ""
                    } ],
                    "importString" : "",
                    "activeTab" : "expressions",
                    "columnsSelector" : [ "JMqELwc9fAbASrzzZS2Qc$$vdPdG2-_tun3A6b5_8WPi##ENCOUNTERCLASS", "JMqELwc9fAbASrzzZS2Qc$$vdPdG2-_tun3A6b5_8WPi##STOP", "JMqELwc9fAbASrzzZS2Qc$$vdPdG2-_tun3A6b5_8WPi##PATIENT" ]
                  },
                  "componentInfo" : {
                    "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
                    "projectName" : "ProphecySparkBasicsPython"
                  }
                },
                "ZWHqscYAxhCi8okTDiJUV$$STkHQVzBrT0YZNRDsEKC1" : {
                  "id" : "ZWHqscYAxhCi8okTDiJUV$$STkHQVzBrT0YZNRDsEKC1",
                  "component" : "Reformat",
                  "metadata" : {
                    "label" : "encounters_by_patient",
                    "slug" : "encounters_by_patient",
                    "x" : 420,
                    "y" : 20,
                    "phase" : 0,
                    "cache" : false,
                    "detailedStats" : false,
                    "isImported" : false
                  },
                  "ports" : {
                    "inputs" : [ {
                      "id" : "Y11qb5j1GkJU-GgmjbnVD$$_5gS_FLqpdx-Z4aojYyYO",
                      "slug" : "in0",
                      "schema" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "Id",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "START",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "STOP",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "PATIENT",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "PROVIDER",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "ENCOUNTERCLASS",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "CODE",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "DESCRIPTION",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "COST",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "REASONCODE",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "REASONDESCRIPTION",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "isStreaming" : false
                    } ],
                    "outputs" : [ {
                      "id" : "8Bnwkmv_VjPGcl1wIR06E$$9t1rlTTWRRTUnkyRmhbvv",
                      "slug" : "out"
                    } ],
                    "selectedInputFields" : [ ],
                    "isCustomOutputSchema" : false,
                    "autoUpdateOnRun" : false
                  },
                  "properties" : {
                    "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
                    "expressions" : [ {
                      "target" : "PATIENT",
                      "expression" : {
                        "format" : "sql",
                        "expression" : "PATIENT"
                      },
                      "description" : ""
                    }, {
                      "target" : "ENCOUNTERCLASS",
                      "expression" : {
                        "format" : "sql",
                        "expression" : "ENCOUNTERCLASS"
                      },
                      "description" : ""
                    }, {
                      "target" : "EVENT_DATE",
                      "expression" : {
                        "format" : "sql",
                        "expression" : "START"
                      },
                      "description" : ""
                    }, {
                      "target" : "EVENT_TYPE",
                      "expression" : {
                        "format" : "sql",
                        "expression" : "-1"
                      },
                      "description" : ""
                    }, {
                      "target" : "START_ORDINAL",
                      "expression" : {
                        "format" : "sql",
                        "expression" : "row_number() OVER (\n  PARTITION BY\n    PATIENT,\n    ENCOUNTERCLASS\n  ORDER BY\n    START,\n    STOP\n)"
                      },
                      "description" : ""
                    } ],
                    "importString" : "",
                    "activeTab" : "expressions",
                    "columnsSelector" : [ "Y11qb5j1GkJU-GgmjbnVD$$_5gS_FLqpdx-Z4aojYyYO##PATIENT", "Y11qb5j1GkJU-GgmjbnVD$$_5gS_FLqpdx-Z4aojYyYO##ENCOUNTERCLASS", "Y11qb5j1GkJU-GgmjbnVD$$_5gS_FLqpdx-Z4aojYyYO##STOP", "Y11qb5j1GkJU-GgmjbnVD$$_5gS_FLqpdx-Z4aojYyYO##START" ]
                  },
                  "componentInfo" : {
                    "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
                    "projectName" : "ProphecySparkBasicsPython"
                  }
                },
                "QKSWWc9PmuvsVG6z7P9_N$$BSpO6cI6w13RMt7GZTA_G" : {
                  "id" : "QKSWWc9PmuvsVG6z7P9_N$$BSpO6cI6w13RMt7GZTA_G",
                  "component" : "Filter",
                  "metadata" : {
                    "label" : "inpatient_encounters_1",
                    "slug" : "inpatient_encounters_1",
                    "x" : 220,
                    "y" : 220,
                    "phase" : 0,
                    "cache" : false,
                    "detailedStats" : false,
                    "isImported" : false
                  },
                  "ports" : {
                    "inputs" : [ {
                      "id" : "lgPb9XRzc70Rh7dLVxSXW$$eIdrJFKaHjZC2TaKcnFeJ",
                      "slug" : "in0",
                      "schema" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "Id",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "START",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "STOP",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "PATIENT",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "PROVIDER",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "ENCOUNTERCLASS",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "CODE",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "DESCRIPTION",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "COST",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "REASONCODE",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "REASONDESCRIPTION",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "isStreaming" : false
                    } ],
                    "outputs" : [ {
                      "id" : "t_-AJUeZA0QKg1QzIJsye$$pGOgH5L9KUlVD1F-CfOnI",
                      "slug" : "out"
                    } ],
                    "selectedInputFields" : [ ],
                    "isCustomOutputSchema" : false,
                    "autoUpdateOnRun" : false
                  },
                  "properties" : {
                    "columnsSelector" : [ ],
                    "condition" : {
                      "format" : "sql",
                      "expression" : "ENCOUNTERCLASS = 'inpatient'"
                    }
                  },
                  "componentInfo" : {
                    "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Filter",
                    "projectName" : "ProphecySparkBasicsPython"
                  }
                },
                "bkx4faNJv0NLVaPyoB7Bx$$Nc4HZZlrpbIqMmVA48fFl" : {
                  "id" : "bkx4faNJv0NLVaPyoB7Bx$$Nc4HZZlrpbIqMmVA48fFl",
                  "component" : "Filter",
                  "metadata" : {
                    "label" : "inpatient_encounters",
                    "slug" : "inpatient_encounters",
                    "x" : 220,
                    "y" : 20,
                    "phase" : 0,
                    "cache" : false,
                    "detailedStats" : false,
                    "isImported" : false
                  },
                  "ports" : {
                    "inputs" : [ {
                      "id" : "SUITfJEzEqOrbmlHhluUj$$iVQz0-JPPPOT-_JZECVJo",
                      "slug" : "in0",
                      "schema" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "Id",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "START",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "STOP",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "PATIENT",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "PROVIDER",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "ENCOUNTERCLASS",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "CODE",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "DESCRIPTION",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "COST",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "REASONCODE",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "REASONDESCRIPTION",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "isStreaming" : false
                    } ],
                    "outputs" : [ {
                      "id" : "ws3EMou0_cM5OgNUUPrnB$$UDellOSx-lYWpJ0e1UQSu",
                      "slug" : "out"
                    } ],
                    "selectedInputFields" : [ ],
                    "isCustomOutputSchema" : false,
                    "autoUpdateOnRun" : false
                  },
                  "properties" : {
                    "columnsSelector" : [ "SUITfJEzEqOrbmlHhluUj$$iVQz0-JPPPOT-_JZECVJo##ENCOUNTERCLASS" ],
                    "condition" : {
                      "format" : "sql",
                      "expression" : "ENCOUNTERCLASS = 'inpatient'"
                    }
                  },
                  "componentInfo" : {
                    "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Filter",
                    "projectName" : "ProphecySparkBasicsPython"
                  }
                },
                "LkJuouqm4de6GyVvCbVCe$$xOpUNZMloV8TkLchMgaGs" : {
                  "id" : "LkJuouqm4de6GyVvCbVCe$$xOpUNZMloV8TkLchMgaGs",
                  "component" : "Source",
                  "metadata" : {
                    "label" : "encounters_1",
                    "slug" : "encounters_1",
                    "x" : 20,
                    "y" : 220,
                    "phase" : 0,
                    "cache" : false,
                    "detailedStats" : false,
                    "isImported" : false
                  },
                  "ports" : {
                    "inputs" : [ ],
                    "outputs" : [ {
                      "id" : "zKqHPEfnMTc-8XF2N_5T3$$HSw0ZhodAkEYWCTslgRFl",
                      "slug" : "out"
                    } ],
                    "selectedInputFields" : [ ],
                    "isCustomOutputSchema" : false,
                    "autoUpdateOnRun" : false
                  },
                  "properties" : {
                    "datasetId" : "datasets/l0_bronze_layer_encounters"
                  }
                },
                "d0KS6vsaG024tTLOKRCgL$$JhswWyzgp9cGIckTh_IxC" : {
                  "id" : "d0KS6vsaG024tTLOKRCgL$$JhswWyzgp9cGIckTh_IxC",
                  "component" : "SetOperation",
                  "metadata" : {
                    "label" : "RAWDATA",
                    "slug" : "RAWDATA",
                    "x" : 620,
                    "y" : 120,
                    "phase" : 0,
                    "cache" : false,
                    "detailedStats" : false,
                    "isImported" : false
                  },
                  "ports" : {
                    "inputs" : [ {
                      "id" : "Pt_uKfUXT5nlP1hcJ06gT$$dmQLqdTeJyIDutBINV0XN",
                      "slug" : "in0",
                      "schema" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "PATIENT",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "ENCOUNTERCLASS",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "EVENT_DATE",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "EVENT_TYPE",
                          "type" : "integer",
                          "nullable" : false,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "START_ORDINAL",
                          "type" : "integer",
                          "nullable" : false,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "isStreaming" : false
                    }, {
                      "id" : "LY3emSGeDHfhKSJ1OKvsc$$GxLetb3k3pCSeYC3LUG-e",
                      "slug" : "in1",
                      "schema" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "patient",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "encounterclass",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "EVENT_DATE",
                          "type" : "date",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "EVENT_TYPE",
                          "type" : "integer",
                          "nullable" : false,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "START_ORDINAL",
                          "type" : "void",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "isStreaming" : false
                    } ],
                    "outputs" : [ {
                      "id" : "8oZCMRPOqcngW65lo5_qT$$ZzKSMC2ba7yAtyMZkP7Hn",
                      "slug" : "out"
                    } ],
                    "selectedInputFields" : [ ],
                    "isCustomOutputSchema" : false,
                    "autoUpdateOnRun" : false
                  },
                  "properties" : {
                    "operationType" : "unionAll",
                    "allowMissingColumns" : false
                  },
                  "componentInfo" : {
                    "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/SetOperation",
                    "projectName" : "ProphecySparkBasicsPython"
                  }
                },
                "mWUDhPr0q3Um5sq-_AzSU$$hICtWhql3IDSr9SKisGiM" : {
                  "id" : "mWUDhPr0q3Um5sq-_AzSU$$hICtWhql3IDSr9SKisGiM",
                  "component" : "Reformat",
                  "metadata" : {
                    "label" : "E",
                    "slug" : "E",
                    "x" : 820,
                    "y" : 120,
                    "phase" : 0,
                    "cache" : false,
                    "detailedStats" : false,
                    "isImported" : false
                  },
                  "ports" : {
                    "inputs" : [ {
                      "id" : "QR8IRJft5Hxi7MBH4Bq2C$$tzoHHXmEQT8aii06vrl52",
                      "slug" : "in0",
                      "schema" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "PATIENT",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "ENCOUNTERCLASS",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "EVENT_DATE",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "EVENT_TYPE",
                          "type" : "integer",
                          "nullable" : false,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "START_ORDINAL",
                          "type" : "integer",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "isStreaming" : false
                    } ],
                    "outputs" : [ {
                      "id" : "Yhv9H3KJNHaMZx7T9xbnt$$Ho_b1hLkfQ3VklO3u3Kg0",
                      "slug" : "out"
                    } ],
                    "selectedInputFields" : [ ],
                    "isCustomOutputSchema" : false,
                    "autoUpdateOnRun" : false
                  },
                  "properties" : {
                    "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
                    "expressions" : [ {
                      "target" : "patient",
                      "expression" : {
                        "format" : "sql",
                        "expression" : "PATIENT"
                      },
                      "description" : ""
                    }, {
                      "target" : "encounterclass",
                      "expression" : {
                        "format" : "sql",
                        "expression" : "ENCOUNTERCLASS"
                      },
                      "description" : ""
                    }, {
                      "target" : "EVENT_DATE",
                      "expression" : {
                        "format" : "sql",
                        "expression" : "EVENT_DATE"
                      },
                      "description" : ""
                    }, {
                      "target" : "EVENT_TYPE",
                      "expression" : {
                        "format" : "sql",
                        "expression" : "EVENT_TYPE"
                      },
                      "description" : ""
                    }, {
                      "target" : "START_ORDINAL",
                      "expression" : {
                        "format" : "sql",
                        "expression" : "max(START_ORDINAL) over (\n    PARTITION BY PATIENT, ENCOUNTERCLASS\n    ORDER BY EVENT_DATE, EVENT_TYPE ROWS UNBOUNDED PRECEDING\n    )"
                      },
                      "description" : ""
                    }, {
                      "target" : "OVERALL_ORD",
                      "expression" : {
                        "format" : "sql",
                        "expression" : "row_number() OVER (\n  PARTITION BY\n    PATIENT,\n    ENCOUNTERCLASS\n  ORDER BY\n    EVENT_DATE,\n    EVENT_TYPE\n)"
                      },
                      "description" : ""
                    } ],
                    "importString" : "",
                    "activeTab" : "expressions",
                    "columnsSelector" : [ "QR8IRJft5Hxi7MBH4Bq2C$$tzoHHXmEQT8aii06vrl52##EVENT_DATE", "QR8IRJft5Hxi7MBH4Bq2C$$tzoHHXmEQT8aii06vrl52##PATIENT", "QR8IRJft5Hxi7MBH4Bq2C$$tzoHHXmEQT8aii06vrl52##ENCOUNTERCLASS", "QR8IRJft5Hxi7MBH4Bq2C$$tzoHHXmEQT8aii06vrl52##EVENT_TYPE" ]
                  },
                  "componentInfo" : {
                    "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
                    "projectName" : "ProphecySparkBasicsPython"
                  }
                },
                "WloyzPVZcWt0-canaTBTD$$NdgXOMRhjuqKh--szwOWe" : {
                  "id" : "WloyzPVZcWt0-canaTBTD$$NdgXOMRhjuqKh--szwOWe",
                  "component" : "Reformat",
                  "metadata" : {
                    "label" : "end_dates_by_event_date",
                    "slug" : "end_dates_by_event_date",
                    "x" : 1220,
                    "y" : 120,
                    "phase" : 0,
                    "cache" : false,
                    "detailedStats" : false,
                    "isImported" : false
                  },
                  "ports" : {
                    "inputs" : [ {
                      "id" : "HzJ8mrRJVYur7VrUE-hPd$$qHwbDlX0SW0uFNjerxdvp",
                      "slug" : "in0",
                      "schema" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "patient",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "encounterclass",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "EVENT_DATE",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "EVENT_TYPE",
                          "type" : "integer",
                          "nullable" : false,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "START_ORDINAL",
                          "type" : "integer",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "OVERALL_ORD",
                          "type" : "integer",
                          "nullable" : false,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "isStreaming" : false
                    } ],
                    "outputs" : [ {
                      "id" : "uWxweHJroPWq9dn0S2TwF$$dyY05fY6guw2cFCODLy76",
                      "slug" : "out"
                    } ],
                    "selectedInputFields" : [ ],
                    "isCustomOutputSchema" : false,
                    "autoUpdateOnRun" : false
                  },
                  "properties" : {
                    "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
                    "expressions" : [ {
                      "target" : "patient",
                      "expression" : {
                        "format" : "sql",
                        "expression" : "patient"
                      },
                      "description" : ""
                    }, {
                      "target" : "encounterclass",
                      "expression" : {
                        "format" : "sql",
                        "expression" : "encounterclass"
                      },
                      "description" : ""
                    }, {
                      "target" : "END_DATE",
                      "expression" : {
                        "format" : "sql",
                        "expression" : "date_add(EVENT_DATE, -1)"
                      },
                      "description" : ""
                    } ],
                    "importString" : "",
                    "activeTab" : "expressions",
                    "columnsSelector" : [ "HzJ8mrRJVYur7VrUE-hPd$$qHwbDlX0SW0uFNjerxdvp##EVENT_DATE", "HzJ8mrRJVYur7VrUE-hPd$$qHwbDlX0SW0uFNjerxdvp##encounterclass", "HzJ8mrRJVYur7VrUE-hPd$$qHwbDlX0SW0uFNjerxdvp##patient" ]
                  },
                  "componentInfo" : {
                    "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
                    "projectName" : "ProphecySparkBasicsPython"
                  }
                },
                "Mgj4rK8OfX7klbG19IjFL$$hobBp9cck0tjZfLH4N3or" : {
                  "id" : "Mgj4rK8OfX7klbG19IjFL$$hobBp9cck0tjZfLH4N3or",
                  "component" : "Filter",
                  "metadata" : {
                    "label" : "filter_by_start_and_overall_ord",
                    "slug" : "filter_by_start_and_overall_ord",
                    "x" : 1020,
                    "y" : 120,
                    "phase" : 0,
                    "cache" : false,
                    "detailedStats" : false,
                    "isImported" : false
                  },
                  "ports" : {
                    "inputs" : [ {
                      "id" : "4FhRyRFIDYlqnuj2EJ4e3$$U6wrZE38JZuDc_5LASPIy",
                      "slug" : "in0",
                      "schema" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "patient",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "encounterclass",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "EVENT_DATE",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "EVENT_TYPE",
                          "type" : "integer",
                          "nullable" : false,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "START_ORDINAL",
                          "type" : "integer",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "OVERALL_ORD",
                          "type" : "integer",
                          "nullable" : false,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "isStreaming" : false
                    } ],
                    "outputs" : [ {
                      "id" : "Sb_Q2WMvYB327UlvWcr-K$$J8pkFcmCKh7gzsHK0GKjQ",
                      "slug" : "out"
                    } ],
                    "selectedInputFields" : [ ],
                    "isCustomOutputSchema" : false,
                    "autoUpdateOnRun" : false
                  },
                  "properties" : {
                    "columnsSelector" : [ "4FhRyRFIDYlqnuj2EJ4e3$$U6wrZE38JZuDc_5LASPIy##START_ORDINAL", "4FhRyRFIDYlqnuj2EJ4e3$$U6wrZE38JZuDc_5LASPIy##OVERALL_ORD" ],
                    "condition" : {
                      "format" : "sql",
                      "expression" : "2 * START_ORDINAL - OVERALL_ORD = 0"
                    }
                  },
                  "componentInfo" : {
                    "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Filter",
                    "projectName" : "ProphecySparkBasicsPython"
                  }
                },
                "NdOXlx54G-KsAjjvIgXYR$$tXy_q7gyDrTw3HjHCf1y4" : {
                  "id" : "NdOXlx54G-KsAjjvIgXYR$$tXy_q7gyDrTw3HjHCf1y4",
                  "component" : "Source",
                  "metadata" : {
                    "label" : "encounters",
                    "slug" : "encounters",
                    "x" : 20,
                    "y" : 20,
                    "phase" : 0,
                    "cache" : false,
                    "detailedStats" : false,
                    "isImported" : false
                  },
                  "ports" : {
                    "inputs" : [ ],
                    "outputs" : [ {
                      "id" : "DkqRRrfWytBscIu4ptlVk$$R92L8U5gcWJZnuizsd8r6",
                      "slug" : "out"
                    } ],
                    "selectedInputFields" : [ ],
                    "isCustomOutputSchema" : false,
                    "autoUpdateOnRun" : false
                  },
                  "properties" : {
                    "datasetId" : "datasets/l0_bronze_layer_encounters"
                  }
                }
              }
            },
            "Q-y6Z9sLUNR8AmBpH1pC0$$jHVbyerqaP2b9UpUqGTvZ" : {
              "id" : "Q-y6Z9sLUNR8AmBpH1pC0$$jHVbyerqaP2b9UpUqGTvZ",
              "component" : "Source",
              "metadata" : {
                "label" : "encounters_2",
                "slug" : "encounters_2",
                "x" : 20,
                "y" : 220,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ ],
                "outputs" : [ {
                  "id" : "hYW9JYX1iN5vjWVcS8uui$$2eg08Urfd49Ra_fxDbDyb",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "datasetId" : "datasets/l0_bronze_layer_encounters"
              }
            }
          }
        },
        "BfP4UL-lR9tEZRegY9EKU$$sXhE8FBKkjELM_B43W1o2" : {
          "id" : "BfP4UL-lR9tEZRegY9EKU$$sXhE8FBKkjELM_B43W1o2",
          "component" : "Target",
          "metadata" : {
            "label" : "all_visits",
            "slug" : "all_visits",
            "x" : 260,
            "y" : -120,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "QntUUu6fV9Eq-hlvRvB1O$$9HlDAweHEtfD_NQ2UiNCb",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "patient",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "encounterclass",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_START_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_END_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "visit_occurrence_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/all_visits"
          }
        },
        "i5YjIsz9x9i2tji9go-MF$$_PAPCPfDsfgROW14QqpWL" : {
          "id" : "i5YjIsz9x9i2tji9go-MF$$_PAPCPfDsfgROW14QqpWL",
          "component" : "Subgraph",
          "metadata" : {
            "label" : "ER_VISITS",
            "slug" : "ER_VISITS",
            "x" : -360,
            "y" : -120,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "DYyNxzaxJPb8g9GGgmBaK$$JWmd3-DxYwnkWEpYCEE1k",
              "slug" : "out0"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : { },
          "connections" : [ {
            "id" : "FyVu9-jbMNWhMp6segY-3$$0Qau2MkipJz9muJ4Kp6LG",
            "source" : "-b_dgAz9-72w1wXKzu5YK$$VEgaM-_PbzP_8qmPSAYmS",
            "sourcePort" : "Jx0W3L7SzxvqrfRcWS00g$$ulYH4ltJ0rmRx4xcOKCw3",
            "target" : "HNFGbhawWtmwmzwbELorE$$PdY2my-tVdWDRHEKfg7O2",
            "targetPort" : "gjOeED4mYp4C2FrlN66UB$$Zijq3vVVbM0HsfotLnjiB"
          }, {
            "id" : "jD4F4kMVnnK-GCF9X9hGB",
            "source" : "2UlQbCe0SEgIOyumVtCaQ$$n7LDlkbfd87hcuSUv7624",
            "sourcePort" : "lFTsSx0lGvhLgoaJjooiL$$fHDUbmKBwnCz1qsi57d4m",
            "target" : "HNFGbhawWtmwmzwbELorE$$PdY2my-tVdWDRHEKfg7O2",
            "targetPort" : "1pjeU7HQIXCO7yDSe1WXj$$pXjizoA7BPtOg4BalKipr"
          }, {
            "id" : "3NjzUjRIRE6RJEY0kt8Ya$$ap4ZPDLNHlbDiZSAV8pme",
            "source" : "HNFGbhawWtmwmzwbELorE$$PdY2my-tVdWDRHEKfg7O2",
            "sourcePort" : "ZJqSa9ItKs883oCD4INsU$$o15RLHEhHsM_JhGoqhpTX",
            "target" : "SVLtFUSZ8tqJZW36YAjow$$kb4yiLY9yXyCJB0CxayP8",
            "targetPort" : "aIhfa6aOkT-CH7Ri7E0XW$$we9O7gB7LseEMRhnl6DnX"
          }, {
            "id" : "u9ljQa26cXTECRHjO63tw$$U6gdeoNpbzUK21Zax0zmA",
            "source" : "SVLtFUSZ8tqJZW36YAjow$$kb4yiLY9yXyCJB0CxayP8",
            "sourcePort" : "KlDf3xhqR24W1HXXOMew1$$ifVEcZuV2oSEUH_Cjx9mt",
            "target" : "XOXQHWs6lu_iKtgA1GRee$$Fylv7DqJQk7SUpKWtJXHb",
            "targetPort" : "Rtv2WizEZ8sPTCvDz1xHt$$-_Fqw4oFX9hBi7IOrvxmU"
          }, {
            "id" : "_jqXHv_e95Ty6485TaNGQ",
            "source" : "XOXQHWs6lu_iKtgA1GRee$$Fylv7DqJQk7SUpKWtJXHb",
            "sourcePort" : "GQV1Qa1Up706NvTJB6uoC$$QJbOscpc8g_lon_YdXk47",
            "target" : "i5YjIsz9x9i2tji9go-MF$$_PAPCPfDsfgROW14QqpWL",
            "targetPort" : "DYyNxzaxJPb8g9GGgmBaK$$JWmd3-DxYwnkWEpYCEE1k"
          } ],
          "processes" : {
            "HNFGbhawWtmwmzwbELorE$$PdY2my-tVdWDRHEKfg7O2" : {
              "id" : "HNFGbhawWtmwmzwbELorE$$PdY2my-tVdWDRHEKfg7O2",
              "component" : "Join",
              "metadata" : {
                "label" : "emergency_urgent_encounters",
                "slug" : "emergency_urgent_encounters",
                "x" : 220,
                "y" : 120,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "gjOeED4mYp4C2FrlN66UB$$Zijq3vVVbM0HsfotLnjiB",
                  "slug" : "CL1",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "Id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "START",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "STOP",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "PATIENT",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "PROVIDER",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "ENCOUNTERCLASS",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "CODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "DESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "COST",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "REASONCODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "REASONDESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                }, {
                  "id" : "1pjeU7HQIXCO7yDSe1WXj$$pXjizoA7BPtOg4BalKipr",
                  "slug" : "CL2",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "Id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "START",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "STOP",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "PATIENT",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "PROVIDER",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "ENCOUNTERCLASS",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "CODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "DESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "COST",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "REASONCODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "REASONDESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "ZJqSa9ItKs883oCD4INsU$$o15RLHEhHsM_JhGoqhpTX",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "conditions" : [ {
                  "alias" : "CL2",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "CL1.PATIENT = CL2.PATIENT AND CL1.START = CL2.START and CL1.ENCOUNTERCLASS = CL2.ENCOUNTERCLASS"
                  },
                  "joinType" : "inner"
                } ],
                "expressions" : [ {
                  "target" : "encounter_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "CL1.Id"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "patient",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "CL1.PATIENT"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "encounterclass",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "CL1.ENCOUNTERCLASS"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "VISIT_START_DATE",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "CL1.START"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "VISIT_END_DATE",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "CL2.STOP"
                  },
                  "description" : "",
                  "_row_id" : null
                } ],
                "hints" : [ {
                  "id" : "gjOeED4mYp4C2FrlN66UB$$Zijq3vVVbM0HsfotLnjiB",
                  "alias" : "CL1",
                  "hintType" : "none",
                  "propagateColumns" : false
                }, {
                  "id" : "1pjeU7HQIXCO7yDSe1WXj$$pXjizoA7BPtOg4BalKipr",
                  "alias" : "CL2",
                  "hintType" : "none",
                  "propagateColumns" : false
                } ],
                "allIn1" : null,
                "activeTab" : "expressions",
                "columnsSelector" : [ "1pjeU7HQIXCO7yDSe1WXj$$pXjizoA7BPtOg4BalKipr##ENCOUNTERCLASS", "gjOeED4mYp4C2FrlN66UB$$Zijq3vVVbM0HsfotLnjiB##PATIENT", "gjOeED4mYp4C2FrlN66UB$$Zijq3vVVbM0HsfotLnjiB##ENCOUNTERCLASS", "gjOeED4mYp4C2FrlN66UB$$Zijq3vVVbM0HsfotLnjiB##START", "1pjeU7HQIXCO7yDSe1WXj$$pXjizoA7BPtOg4BalKipr##START", "1pjeU7HQIXCO7yDSe1WXj$$pXjizoA7BPtOg4BalKipr##PATIENT", "gjOeED4mYp4C2FrlN66UB$$Zijq3vVVbM0HsfotLnjiB##PATIENT", "gjOeED4mYp4C2FrlN66UB$$Zijq3vVVbM0HsfotLnjiB##ENCOUNTERCLASS", "gjOeED4mYp4C2FrlN66UB$$Zijq3vVVbM0HsfotLnjiB##Id", "gjOeED4mYp4C2FrlN66UB$$Zijq3vVVbM0HsfotLnjiB##START", "1pjeU7HQIXCO7yDSe1WXj$$pXjizoA7BPtOg4BalKipr##STOP" ],
                "allIn0" : null,
                "whereClause" : {
                  "format" : "sql",
                  "expression" : "CL1.ENCOUNTERCLASS in ('emergency', 'urgent')"
                },
                "headAlias" : "CL1"
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Join",
                "projectName" : "ProphecySparkBasicsPython"
              }
            },
            "SVLtFUSZ8tqJZW36YAjow$$kb4yiLY9yXyCJB0CxayP8" : {
              "id" : "SVLtFUSZ8tqJZW36YAjow$$kb4yiLY9yXyCJB0CxayP8",
              "component" : "Aggregate",
              "metadata" : {
                "label" : "encounters_by_patient",
                "slug" : "encounters_by_patient",
                "x" : 420,
                "y" : 120,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "aIhfa6aOkT-CH7Ri7E0XW$$we9O7gB7LseEMRhnl6DnX",
                  "slug" : "emergency_urgent_encounters",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "encounter_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "patient",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "encounterclass",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "VISIT_START_DATE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "VISIT_END_DATE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "KlDf3xhqR24W1HXXOMew1$$ifVEcZuV2oSEUH_Cjx9mt",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "allIns" : false,
                "doPivot" : false,
                "aggregate" : [ {
                  "target" : "encounter_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "min(encounter_id)"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "_row_id" : "c_247",
                  "target" : "VISIT_END_DATE",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "max(VISIT_END_DATE)"
                  },
                  "description" : ""
                } ],
                "allowSelection" : true,
                "pivotColumn" : null,
                "pivotValues" : [ ],
                "activeTab" : "aggregate",
                "columnsSelector" : [ "aIhfa6aOkT-CH7Ri7E0XW$$we9O7gB7LseEMRhnl6DnX##VISIT_START_DATE", "aIhfa6aOkT-CH7Ri7E0XW$$we9O7gB7LseEMRhnl6DnX##VISIT_END_DATE", "aIhfa6aOkT-CH7Ri7E0XW$$we9O7gB7LseEMRhnl6DnX##patient", "aIhfa6aOkT-CH7Ri7E0XW$$we9O7gB7LseEMRhnl6DnX##encounterclass", "aIhfa6aOkT-CH7Ri7E0XW$$we9O7gB7LseEMRhnl6DnX##encounter_id" ],
                "groupBy" : [ {
                  "target" : "patient",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "patient"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "encounterclass",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "encounterclass"
                  },
                  "description" : "",
                  "_row_id" : null
                }, {
                  "target" : "VISIT_START_DATE",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "VISIT_START_DATE"
                  },
                  "description" : "",
                  "_row_id" : null
                } ]
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Aggregate",
                "projectName" : "ProphecySparkBasicsPython"
              }
            },
            "-b_dgAz9-72w1wXKzu5YK$$VEgaM-_PbzP_8qmPSAYmS" : {
              "id" : "-b_dgAz9-72w1wXKzu5YK$$VEgaM-_PbzP_8qmPSAYmS",
              "component" : "Source",
              "metadata" : {
                "label" : "encounters_3",
                "slug" : "encounters_3",
                "x" : 20,
                "y" : 20,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ ],
                "outputs" : [ {
                  "id" : "Jx0W3L7SzxvqrfRcWS00g$$ulYH4ltJ0rmRx4xcOKCw3",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "datasetId" : "datasets/l0_bronze_layer_encounters"
              }
            },
            "2UlQbCe0SEgIOyumVtCaQ$$n7LDlkbfd87hcuSUv7624" : {
              "id" : "2UlQbCe0SEgIOyumVtCaQ$$n7LDlkbfd87hcuSUv7624",
              "component" : "Source",
              "metadata" : {
                "label" : "encounters_4",
                "slug" : "encounters_4",
                "x" : 20,
                "y" : 220,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ ],
                "outputs" : [ {
                  "id" : "lFTsSx0lGvhLgoaJjooiL$$fHDUbmKBwnCz1qsi57d4m",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "datasetId" : "datasets/l0_bronze_layer_encounters"
              }
            },
            "XOXQHWs6lu_iKtgA1GRee$$Fylv7DqJQk7SUpKWtJXHb" : {
              "id" : "XOXQHWs6lu_iKtgA1GRee$$Fylv7DqJQk7SUpKWtJXHb",
              "component" : "Reformat",
              "metadata" : {
                "label" : "encounters_projection",
                "slug" : "encounters_projection",
                "x" : 620,
                "y" : 120,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "Rtv2WizEZ8sPTCvDz1xHt$$-_Fqw4oFX9hBi7IOrvxmU",
                  "slug" : "encounters_by_patient",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "patient",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "encounterclass",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "VISIT_START_DATE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "encounter_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "VISIT_END_DATE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "GQV1Qa1Up706NvTJB6uoC$$QJbOscpc8g_lon_YdXk47",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
                "expressions" : [ {
                  "target" : "encounter_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "encounter_id"
                  },
                  "description" : ""
                }, {
                  "target" : "patient",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "patient"
                  },
                  "description" : ""
                }, {
                  "target" : "encounterclass",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "encounterclass"
                  },
                  "description" : ""
                }, {
                  "target" : "VISIT_START_DATE",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "VISIT_START_DATE"
                  },
                  "description" : ""
                }, {
                  "target" : "VISIT_END_DATE",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "VISIT_END_DATE"
                  },
                  "description" : ""
                } ],
                "importString" : "",
                "activeTab" : "expressions",
                "columnsSelector" : [ "Rtv2WizEZ8sPTCvDz1xHt$$-_Fqw4oFX9hBi7IOrvxmU##VISIT_END_DATE", "Rtv2WizEZ8sPTCvDz1xHt$$-_Fqw4oFX9hBi7IOrvxmU##encounter_id", "Rtv2WizEZ8sPTCvDz1xHt$$-_Fqw4oFX9hBi7IOrvxmU##patient", "Rtv2WizEZ8sPTCvDz1xHt$$-_Fqw4oFX9hBi7IOrvxmU##VISIT_START_DATE", "Rtv2WizEZ8sPTCvDz1xHt$$-_Fqw4oFX9hBi7IOrvxmU##encounterclass" ]
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
                "projectName" : "ProphecySparkBasicsPython"
              }
            }
          }
        },
        "TzGFyhngKBR5gETws51AQ$$4F0z2lbclXeUizheir6bq" : {
          "id" : "TzGFyhngKBR5gETws51AQ$$4F0z2lbclXeUizheir6bq",
          "component" : "Reformat",
          "metadata" : {
            "label" : "visit_occurrences_by_patient_and_class",
            "slug" : "visit_occurrences_by_patient_and_class",
            "x" : 60,
            "y" : -120,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "rX2_9BbObED1EplI9ZZA3$$fKXeS3Sq_VPeUUfgLqyu1",
              "slug" : "SetOperation_1",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "patient",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "encounterclass",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_START_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_END_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "4NEV_IN4BOr9g2F96d7RB$$ZotQ6Kcl97qkZHlWzREfQ",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "encounter_id",
              "expression" : {
                "format" : "sql",
                "expression" : "encounter_id"
              },
              "description" : ""
            }, {
              "target" : "patient",
              "expression" : {
                "format" : "sql",
                "expression" : "patient"
              },
              "description" : ""
            }, {
              "target" : "encounterclass",
              "expression" : {
                "format" : "sql",
                "expression" : "encounterclass"
              },
              "description" : ""
            }, {
              "target" : "VISIT_START_DATE",
              "expression" : {
                "format" : "sql",
                "expression" : "VISIT_START_DATE"
              },
              "description" : ""
            }, {
              "target" : "VISIT_END_DATE",
              "expression" : {
                "format" : "sql",
                "expression" : "VISIT_END_DATE"
              },
              "description" : ""
            }, {
              "target" : "visit_occurrence_id",
              "expression" : {
                "format" : "sql",
                "expression" : "row_number() OVER (PARTITION BY 1 ORDER BY patient)"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "rX2_9BbObED1EplI9ZZA3$$fKXeS3Sq_VPeUUfgLqyu1##VISIT_START_DATE", "rX2_9BbObED1EplI9ZZA3$$fKXeS3Sq_VPeUUfgLqyu1##encounter_id", "rX2_9BbObED1EplI9ZZA3$$fKXeS3Sq_VPeUUfgLqyu1##encounterclass", "rX2_9BbObED1EplI9ZZA3$$fKXeS3Sq_VPeUUfgLqyu1##VISIT_END_DATE", "rX2_9BbObED1EplI9ZZA3$$fKXeS3Sq_VPeUUfgLqyu1##patient" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        }
      }
    },
    "p2IQriYm86tCB51LEwMhh$$BDH_QDVPT9BDmkQj3tLar" : {
      "id" : "p2IQriYm86tCB51LEwMhh$$BDH_QDVPT9BDmkQj3tLar",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "observation_period_insert",
        "slug" : "observation_period_insert",
        "x" : 0,
        "y" : 940,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : { },
      "connections" : [ {
        "id" : "6bIW285ACewafKdCt3y80$$rfnU_XMZhwxpjcKuoPig5",
        "source" : "eQX1ifyQc8Qq7SbW1rRc-$$phUsU5LVsDBSCFlQkHiXw",
        "sourcePort" : "UggY0UTMVW0YSQIWYb0tJ$$n07f9SS83OHUY8RG4G5iD",
        "target" : "ZY1koa2ZKl7hqNJq2JEzI$$mrTrqVD-qmQuf5eOnb7KR",
        "targetPort" : "fdo6JwfrxOg7isIYd8OLM$$Ynh2yFlQIHzWnWIJeBVp0"
      }, {
        "id" : "yyI1i56kQvgJaiqBf206I$$X5Jx_TjqgUKMJD2YJKMH2",
        "source" : "c1TBuV1CY5Yf8S9z5_wWV$$JOIGuFeC0AkZKLpxDqQ6D",
        "sourcePort" : "iVAISSjsD7hbWvrM36Uqo$$so8djBO0fREp9bFpSSUif",
        "target" : "ZY1koa2ZKl7hqNJq2JEzI$$mrTrqVD-qmQuf5eOnb7KR",
        "targetPort" : "tDKdEHapRcvre4InCsrX9$$3IHIDCIc9QVXpIorTbDQq"
      }, {
        "id" : "oVfwiikv2qfBCwMZHA8gK$$3eYV2sSRrZAiXJHReeeum",
        "source" : "ZY1koa2ZKl7hqNJq2JEzI$$mrTrqVD-qmQuf5eOnb7KR",
        "sourcePort" : "BDnmNhDmj0-ioGELIP4Jl$$TY60wRlaQIZ2pJYhjtfcT",
        "target" : "LhpMY56yP55O0nT5cPNIy$$y1k8Us4GAtz571gF44AvN",
        "targetPort" : "4DM1P4LCi1kpKQ8OLJ1n7$$MnSjmT0THxNCX1diyFuaa"
      }, {
        "id" : "IS6xS6t5YSnhw6bvpl8s9$$DeosWBa97vQooAaXIrJhl",
        "source" : "LhpMY56yP55O0nT5cPNIy$$y1k8Us4GAtz571gF44AvN",
        "sourcePort" : "Vc2ihNyHkn8S5TdYFz5gZ$$4I_2GizoGizK7lqpBJSDE",
        "target" : "CTWw7t39o2kDdp-pxUsnC$$a8N5qLQhJOvWqTVYnC4Ca",
        "targetPort" : "Kyhx1zs_XCz5C3mUPvk7I$$1yhnmRFACO-BW8SBcNXE3"
      }, {
        "id" : "blb0vekn3iWHlX0xWJt40",
        "source" : "CTWw7t39o2kDdp-pxUsnC$$a8N5qLQhJOvWqTVYnC4Ca",
        "sourcePort" : "Agkdr4k4cW1tcWKtpNtAR$$Q4aKZVJEyawNucbwPJGVL",
        "target" : "_XHXZQVclUaepe560QUjN$$pNVjcSFYgjKIZmq60aaXB",
        "targetPort" : "zcZrlreg8JTOgHH4kfTp3$$hxCuqpVpDO1fCT5hqPRZ_"
      } ],
      "processes" : {
        "LhpMY56yP55O0nT5cPNIy$$y1k8Us4GAtz571gF44AvN" : {
          "id" : "LhpMY56yP55O0nT5cPNIy$$y1k8Us4GAtz571gF44AvN",
          "component" : "Aggregate",
          "metadata" : {
            "label" : "by_person_start_end_dates",
            "slug" : "by_person_start_end_dates",
            "x" : -20,
            "y" : 700,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "4DM1P4LCi1kpKQ8OLJ1n7$$MnSjmT0THxNCX1diyFuaa",
              "slug" : "by_person_source_value",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "gender_concept_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "YEAR_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "MONTH_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DAY_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "BIRTH_DATETIME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "LOCATION_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROVIDER_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CARE_SITE_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PERSON_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "Id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "START",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "STOP",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PATIENT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROVIDER",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ENCOUNTERCLASS",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "COST",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "REASONCODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "REASONDESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Vc2ihNyHkn8S5TdYFz5gZ$$4I_2GizoGizK7lqpBJSDE",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "allIns" : false,
            "doPivot" : false,
            "aggregate" : [ {
              "target" : "start_date",
              "expression" : {
                "format" : "sql",
                "expression" : "min(START)"
              },
              "description" : "",
              "_row_id" : "c_253"
            }, {
              "target" : "end_date",
              "expression" : {
                "format" : "sql",
                "expression" : "max(STOP)"
              },
              "description" : "",
              "_row_id" : "c_254"
            } ],
            "allowSelection" : true,
            "pivotColumn" : null,
            "pivotValues" : [ ],
            "activeTab" : "aggregate",
            "columnsSelector" : [ "4DM1P4LCi1kpKQ8OLJ1n7$$MnSjmT0THxNCX1diyFuaa##person_id", "4DM1P4LCi1kpKQ8OLJ1n7$$MnSjmT0THxNCX1diyFuaa##STOP", "4DM1P4LCi1kpKQ8OLJ1n7$$MnSjmT0THxNCX1diyFuaa##START" ],
            "groupBy" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : "",
              "_row_id" : null
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Aggregate",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "eQX1ifyQc8Qq7SbW1rRc-$$phUsU5LVsDBSCFlQkHiXw" : {
          "id" : "eQX1ifyQc8Qq7SbW1rRc-$$phUsU5LVsDBSCFlQkHiXw",
          "component" : "Source",
          "metadata" : {
            "label" : "person_1",
            "slug" : "person_1",
            "x" : -360,
            "y" : 640,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "UggY0UTMVW0YSQIWYb0tJ$$n07f9SS83OHUY8RG4G5iD",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/person"
          }
        },
        "c1TBuV1CY5Yf8S9z5_wWV$$JOIGuFeC0AkZKLpxDqQ6D" : {
          "id" : "c1TBuV1CY5Yf8S9z5_wWV$$JOIGuFeC0AkZKLpxDqQ6D",
          "component" : "Source",
          "metadata" : {
            "label" : "encounters_7",
            "slug" : "encounters_7",
            "x" : -360,
            "y" : 780,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "iVAISSjsD7hbWvrM36Uqo$$so8djBO0fREp9bFpSSUif",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/l0_bronze_layer_encounters"
          }
        },
        "CTWw7t39o2kDdp-pxUsnC$$a8N5qLQhJOvWqTVYnC4Ca" : {
          "id" : "CTWw7t39o2kDdp-pxUsnC$$a8N5qLQhJOvWqTVYnC4Ca",
          "component" : "Reformat",
          "metadata" : {
            "label" : "observation_period_reformat",
            "slug" : "observation_period_reformat",
            "x" : 140,
            "y" : 700,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Kyhx1zs_XCz5C3mUPvk7I$$1yhnmRFACO-BW8SBcNXE3",
              "slug" : "by_person_start_end_dates",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "start_date",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "end_date",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Agkdr4k4cW1tcWKtpNtAR$$Q4aKZVJEyawNucbwPJGVL",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "OBSERVATION_PERIOD_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "row_number() OVER (PARTITION BY 1 ORDER BY person_id)"
              },
              "description" : ""
            }, {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "OBSERVATION_PERIOD_START_DATE",
              "expression" : {
                "format" : "sql",
                "expression" : "start_date"
              },
              "description" : ""
            }, {
              "target" : "OBSERVATION_PERIOD_END_DATE",
              "expression" : {
                "format" : "sql",
                "expression" : "end_date"
              },
              "description" : ""
            }, {
              "target" : "period_type_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "44814724"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "Kyhx1zs_XCz5C3mUPvk7I$$1yhnmRFACO-BW8SBcNXE3##start_date", "Kyhx1zs_XCz5C3mUPvk7I$$1yhnmRFACO-BW8SBcNXE3##person_id", "Kyhx1zs_XCz5C3mUPvk7I$$1yhnmRFACO-BW8SBcNXE3##end_date" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "ZY1koa2ZKl7hqNJq2JEzI$$mrTrqVD-qmQuf5eOnb7KR" : {
          "id" : "ZY1koa2ZKl7hqNJq2JEzI$$mrTrqVD-qmQuf5eOnb7KR",
          "component" : "Join",
          "metadata" : {
            "label" : "by_person_source_value",
            "slug" : "by_person_source_value",
            "x" : -180,
            "y" : 700,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "fdo6JwfrxOg7isIYd8OLM$$Ynh2yFlQIHzWnWIJeBVp0",
              "slug" : "p",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "gender_concept_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "YEAR_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "MONTH_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DAY_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "BIRTH_DATETIME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "LOCATION_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROVIDER_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CARE_SITE_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PERSON_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "tDKdEHapRcvre4InCsrX9$$3IHIDCIc9QVXpIorTbDQq",
              "slug" : "e",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "Id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "START",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "STOP",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PATIENT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROVIDER",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ENCOUNTERCLASS",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "COST",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "REASONCODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "REASONDESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "BDnmNhDmj0-ioGELIP4Jl$$TY60wRlaQIZ2pJYhjtfcT",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "conditions" : [ {
              "alias" : "e",
              "expression" : {
                "format" : "sql",
                "expression" : "p.PERSON_SOURCE_VALUE = e.PATIENT"
              },
              "joinType" : "inner"
            } ],
            "expressions" : [ ],
            "hints" : [ {
              "id" : "fdo6JwfrxOg7isIYd8OLM$$Ynh2yFlQIHzWnWIJeBVp0",
              "alias" : "p",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "tDKdEHapRcvre4InCsrX9$$3IHIDCIc9QVXpIorTbDQq",
              "alias" : "e",
              "hintType" : "none",
              "propagateColumns" : false
            } ],
            "allIn1" : null,
            "activeTab" : "conditions",
            "columnsSelector" : [ "tDKdEHapRcvre4InCsrX9$$3IHIDCIc9QVXpIorTbDQq##PATIENT", "fdo6JwfrxOg7isIYd8OLM$$Ynh2yFlQIHzWnWIJeBVp0##PERSON_SOURCE_VALUE" ],
            "allIn0" : null,
            "whereClause" : null,
            "headAlias" : "p"
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Join",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "_XHXZQVclUaepe560QUjN$$pNVjcSFYgjKIZmq60aaXB" : {
          "id" : "_XHXZQVclUaepe560QUjN$$pNVjcSFYgjKIZmq60aaXB",
          "component" : "Target",
          "metadata" : {
            "label" : "observation_period",
            "slug" : "observation_period",
            "x" : 340,
            "y" : 700,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "zcZrlreg8JTOgHH4kfTp3$$hxCuqpVpDO1fCT5hqPRZ_",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "OBSERVATION_PERIOD_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "OBSERVATION_PERIOD_START_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "OBSERVATION_PERIOD_END_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "period_type_concept_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/observation_period"
          }
        }
      }
    },
    "7QniCnpDKQJU0MnvcxN5a$$_AIv4A_9jyKGR3XgvWrFA" : {
      "id" : "7QniCnpDKQJU0MnvcxN5a$$_AIv4A_9jyKGR3XgvWrFA",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "final_visit_ids_table",
        "slug" : "final_visit_ids_table",
        "x" : 0,
        "y" : 460,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : { },
      "connections" : [ {
        "id" : "XSCQWgTRCq-DuM5BCeDt_$$jJFpHSeo22KTOrpT-ToWf",
        "source" : "lqUrCg5cRg0OACbwxfpdt$$GWAHLO_1fdu0wwXBMdZNa",
        "sourcePort" : "MVPKyZArZhpTv1Q1wSrMM$$P66sacmxbkf_NjeA6q9xT",
        "target" : "0obQdTJ5JQ-Jo4g9elA3d$$DvplVwuW6nwFKWNVToFEK",
        "targetPort" : "MBrg3TnN4xFHaHpJuwOS-$$V_KNO32tTj80M30RPkw1B"
      }, {
        "id" : "dBrtGvp36IDTbfWom6FYE$$Yfrx9F_vnMTsVpeehh86A",
        "source" : "0obQdTJ5JQ-Jo4g9elA3d$$DvplVwuW6nwFKWNVToFEK",
        "sourcePort" : "vnjOdjMp72JQ_Xaakh1Zx$$9B54BNvYF2gXz3FeTAMYT",
        "target" : "VPJlgvIL0xs3DrWg5CZcx$$-sZyCSx8eWDAtINyfqsGd",
        "targetPort" : "DmXYRRM6JqsY8mU4_ky9K$$ct_Vliu73rX1KXvdgEl39"
      }, {
        "id" : "OxbNm8xKb3IsEreHeVudN$$MXXWT9sJC0XjgO3Nmill4",
        "source" : "VPJlgvIL0xs3DrWg5CZcx$$-sZyCSx8eWDAtINyfqsGd",
        "sourcePort" : "S4CYxHw1zzVUzH-yDgvcD$$rTs3quQ6PZTTtJJBkHpv0",
        "target" : "tVVr2bj1yszdpWrTuPMZh$$9cPZi0Kne8gQiNsnCV63e",
        "targetPort" : "rgaYulafGsj-zj5YEVfnI$$01iuux5l9T-3OJrtSX232"
      }, {
        "id" : "WV5K2UoGA_1sNNiNITazJ$$Ja9_5oAR0GFRWbcDk_jlB",
        "source" : "tVVr2bj1yszdpWrTuPMZh$$9cPZi0Kne8gQiNsnCV63e",
        "sourcePort" : "w6hozWrxtd0TeEpwkg_lY$$knOENa-tJ9vYrVRP_c-T2",
        "target" : "I7XRcYzs9sGUQpcH09T-R$$f01U6gwGH1AZ-n1OG90x3",
        "targetPort" : "mQnltgR0WfYdD3wvEmzYZ$$TnxGiDvunSndoDHL1PYuz"
      }, {
        "id" : "RQdMU_RAqwEHJnLH_irNW$$5UzRQA42tfMiu3d9iy6uK",
        "source" : "I7XRcYzs9sGUQpcH09T-R$$f01U6gwGH1AZ-n1OG90x3",
        "sourcePort" : "XGb1urt8CK1-ZZ89IU8j3$$kjEmgfvloXdshDUZG2EUH",
        "target" : "q_GqwpkMyqhPXhhQWEbdn$$XPAkkUjKNgnsPoN3wvpZt",
        "targetPort" : "whQOUDEWyORfnB5FcfGaS$$0qWf-5ZJ44FoTPexlnd53"
      } ],
      "processes" : {
        "0obQdTJ5JQ-Jo4g9elA3d$$DvplVwuW6nwFKWNVToFEK" : {
          "id" : "0obQdTJ5JQ-Jo4g9elA3d$$DvplVwuW6nwFKWNVToFEK",
          "component" : "Reformat",
          "metadata" : {
            "label" : "visit_priority_projection",
            "slug" : "visit_priority_projection",
            "x" : -200,
            "y" : 580,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "MBrg3TnN4xFHaHpJuwOS-$$V_KNO32tTj80M30RPkw1B",
              "slug" : "assign_all_visit_ids_1",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "date_service",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "date_service_end",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "encounterclass",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_TYPE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_START_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_END_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID_NEW",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_COST",
                  "type" : "double",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "vnjOdjMp72JQ_Xaakh1Zx$$9B54BNvYF2gXz3FeTAMYT",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "encounter_id",
              "expression" : {
                "format" : "sql",
                "expression" : "encounter_id"
              },
              "description" : ""
            }, {
              "target" : "person_source_value",
              "expression" : {
                "format" : "sql",
                "expression" : "person_source_value"
              },
              "description" : ""
            }, {
              "target" : "date_service",
              "expression" : {
                "format" : "sql",
                "expression" : "date_service"
              },
              "description" : ""
            }, {
              "target" : "date_service_end",
              "expression" : {
                "format" : "sql",
                "expression" : "date_service_end"
              },
              "description" : ""
            }, {
              "target" : "encounterclass",
              "expression" : {
                "format" : "sql",
                "expression" : "encounterclass"
              },
              "description" : ""
            }, {
              "target" : "VISIT_TYPE",
              "expression" : {
                "format" : "sql",
                "expression" : "VISIT_TYPE"
              },
              "description" : ""
            }, {
              "target" : "VISIT_START_DATE",
              "expression" : {
                "format" : "sql",
                "expression" : "VISIT_START_DATE"
              },
              "description" : ""
            }, {
              "target" : "VISIT_END_DATE",
              "expression" : {
                "format" : "sql",
                "expression" : "VISIT_END_DATE"
              },
              "description" : ""
            }, {
              "target" : "VISIT_OCCURRENCE_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "VISIT_OCCURRENCE_ID"
              },
              "description" : ""
            }, {
              "target" : "VISIT_OCCURRENCE_ID_NEW",
              "expression" : {
                "format" : "sql",
                "expression" : "VISIT_OCCURRENCE_ID_NEW"
              },
              "description" : ""
            }, {
              "target" : "PRIORITY",
              "expression" : {
                "format" : "sql",
                "expression" : "CASE\n    WHEN encounterclass in ('emergency', 'urgent') THEN\n        CASE\n            WHEN VISIT_TYPE = 'inpatient' AND VISIT_OCCURRENCE_ID_NEW IS NOT NULL THEN 1\n            WHEN VISIT_TYPE in ('emergency', 'urgent') AND VISIT_OCCURRENCE_ID_NEW IS NOT NULL THEN 2\n            ELSE 99\n        END\nEND"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "MBrg3TnN4xFHaHpJuwOS-$$V_KNO32tTj80M30RPkw1B##VISIT_END_DATE", "MBrg3TnN4xFHaHpJuwOS-$$V_KNO32tTj80M30RPkw1B##encounterclass", "MBrg3TnN4xFHaHpJuwOS-$$V_KNO32tTj80M30RPkw1B##person_source_value", "MBrg3TnN4xFHaHpJuwOS-$$V_KNO32tTj80M30RPkw1B##VISIT_OCCURRENCE_ID", "MBrg3TnN4xFHaHpJuwOS-$$V_KNO32tTj80M30RPkw1B##VISIT_TYPE", "MBrg3TnN4xFHaHpJuwOS-$$V_KNO32tTj80M30RPkw1B##encounter_id", "MBrg3TnN4xFHaHpJuwOS-$$V_KNO32tTj80M30RPkw1B##VISIT_START_DATE", "MBrg3TnN4xFHaHpJuwOS-$$V_KNO32tTj80M30RPkw1B##date_service_end", "MBrg3TnN4xFHaHpJuwOS-$$V_KNO32tTj80M30RPkw1B##date_service", "MBrg3TnN4xFHaHpJuwOS-$$V_KNO32tTj80M30RPkw1B##VISIT_OCCURRENCE_ID_NEW" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "VPJlgvIL0xs3DrWg5CZcx$$-sZyCSx8eWDAtINyfqsGd" : {
          "id" : "VPJlgvIL0xs3DrWg5CZcx$$-sZyCSx8eWDAtINyfqsGd",
          "component" : "Reformat",
          "metadata" : {
            "label" : "encounters_with_priority",
            "slug" : "encounters_with_priority",
            "x" : -20,
            "y" : 580,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "DmXYRRM6JqsY8mU4_ky9K$$ct_Vliu73rX1KXvdgEl39",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "date_service",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "date_service_end",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "encounterclass",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_TYPE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_START_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_END_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID_NEW",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PRIORITY",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "S4CYxHw1zzVUzH-yDgvcD$$rTs3quQ6PZTTtJJBkHpv0",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "encounter_id",
              "expression" : {
                "format" : "sql",
                "expression" : "encounter_id"
              },
              "description" : ""
            }, {
              "target" : "person_source_value",
              "expression" : {
                "format" : "sql",
                "expression" : "person_source_value"
              },
              "description" : ""
            }, {
              "target" : "date_service",
              "expression" : {
                "format" : "sql",
                "expression" : "date_service"
              },
              "description" : ""
            }, {
              "target" : "date_service_end",
              "expression" : {
                "format" : "sql",
                "expression" : "date_service_end"
              },
              "description" : ""
            }, {
              "target" : "encounterclass",
              "expression" : {
                "format" : "sql",
                "expression" : "encounterclass"
              },
              "description" : ""
            }, {
              "target" : "VISIT_TYPE",
              "expression" : {
                "format" : "sql",
                "expression" : "VISIT_TYPE"
              },
              "description" : ""
            }, {
              "target" : "VISIT_START_DATE",
              "expression" : {
                "format" : "sql",
                "expression" : "VISIT_START_DATE"
              },
              "description" : ""
            }, {
              "target" : "VISIT_END_DATE",
              "expression" : {
                "format" : "sql",
                "expression" : "VISIT_END_DATE"
              },
              "description" : ""
            }, {
              "target" : "VISIT_OCCURRENCE_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "VISIT_OCCURRENCE_ID"
              },
              "description" : ""
            }, {
              "target" : "VISIT_OCCURRENCE_ID_NEW",
              "expression" : {
                "format" : "sql",
                "expression" : "VISIT_OCCURRENCE_ID_NEW"
              },
              "description" : ""
            }, {
              "target" : "PRIORITY",
              "expression" : {
                "format" : "sql",
                "expression" : "PRIORITY"
              },
              "description" : ""
            }, {
              "target" : "RN",
              "expression" : {
                "format" : "sql",
                "expression" : "row_number() OVER (PARTITION BY encounter_id ORDER BY PRIORITY)"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "DmXYRRM6JqsY8mU4_ky9K$$ct_Vliu73rX1KXvdgEl39##PRIORITY", "DmXYRRM6JqsY8mU4_ky9K$$ct_Vliu73rX1KXvdgEl39##VISIT_END_DATE", "DmXYRRM6JqsY8mU4_ky9K$$ct_Vliu73rX1KXvdgEl39##encounter_id", "DmXYRRM6JqsY8mU4_ky9K$$ct_Vliu73rX1KXvdgEl39##VISIT_START_DATE", "DmXYRRM6JqsY8mU4_ky9K$$ct_Vliu73rX1KXvdgEl39##VISIT_TYPE", "DmXYRRM6JqsY8mU4_ky9K$$ct_Vliu73rX1KXvdgEl39##person_source_value", "DmXYRRM6JqsY8mU4_ky9K$$ct_Vliu73rX1KXvdgEl39##date_service", "DmXYRRM6JqsY8mU4_ky9K$$ct_Vliu73rX1KXvdgEl39##VISIT_OCCURRENCE_ID", "DmXYRRM6JqsY8mU4_ky9K$$ct_Vliu73rX1KXvdgEl39##encounterclass", "DmXYRRM6JqsY8mU4_ky9K$$ct_Vliu73rX1KXvdgEl39##VISIT_OCCURRENCE_ID_NEW", "DmXYRRM6JqsY8mU4_ky9K$$ct_Vliu73rX1KXvdgEl39##date_service_end" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "lqUrCg5cRg0OACbwxfpdt$$GWAHLO_1fdu0wwXBMdZNa" : {
          "id" : "lqUrCg5cRg0OACbwxfpdt$$GWAHLO_1fdu0wwXBMdZNa",
          "component" : "Source",
          "metadata" : {
            "label" : "assign_all_visit_ids_1",
            "slug" : "assign_all_visit_ids_1",
            "x" : -360,
            "y" : 580,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "MVPKyZArZhpTv1Q1wSrMM$$P66sacmxbkf_NjeA6q9xT",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/assign_all_visit_ids"
          }
        },
        "q_GqwpkMyqhPXhhQWEbdn$$XPAkkUjKNgnsPoN3wvpZt" : {
          "id" : "q_GqwpkMyqhPXhhQWEbdn$$XPAkkUjKNgnsPoN3wvpZt",
          "component" : "Target",
          "metadata" : {
            "label" : "final_visit_ids",
            "slug" : "final_visit_ids",
            "x" : 440,
            "y" : 580,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "whQOUDEWyORfnB5FcfGaS$$0qWf-5ZJ44FoTPexlnd53",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID_NEW",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/final_visit_ids"
          }
        },
        "I7XRcYzs9sGUQpcH09T-R$$f01U6gwGH1AZ-n1OG90x3" : {
          "id" : "I7XRcYzs9sGUQpcH09T-R$$f01U6gwGH1AZ-n1OG90x3",
          "component" : "Reformat",
          "metadata" : {
            "label" : "encounter_id_and_visit_occurrence_id_projection",
            "slug" : "encounter_id_and_visit_occurrence_id_projection",
            "x" : 300,
            "y" : 580,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "mQnltgR0WfYdD3wvEmzYZ$$TnxGiDvunSndoDHL1PYuz",
              "slug" : "first_encounter_of_visit_occurrence",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "date_service",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "date_service_end",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "encounterclass",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_TYPE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_START_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_END_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID_NEW",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PRIORITY",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RN",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "XGb1urt8CK1-ZZ89IU8j3$$kjEmgfvloXdshDUZG2EUH",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "encounter_id",
              "expression" : {
                "format" : "sql",
                "expression" : "encounter_id"
              },
              "description" : ""
            }, {
              "target" : "VISIT_OCCURRENCE_ID_NEW",
              "expression" : {
                "format" : "sql",
                "expression" : "VISIT_OCCURRENCE_ID_NEW"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "mQnltgR0WfYdD3wvEmzYZ$$TnxGiDvunSndoDHL1PYuz##encounter_id", "mQnltgR0WfYdD3wvEmzYZ$$TnxGiDvunSndoDHL1PYuz##VISIT_OCCURRENCE_ID_NEW" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "tVVr2bj1yszdpWrTuPMZh$$9cPZi0Kne8gQiNsnCV63e" : {
          "id" : "tVVr2bj1yszdpWrTuPMZh$$9cPZi0Kne8gQiNsnCV63e",
          "component" : "Filter",
          "metadata" : {
            "label" : "first_encounter_of_visit_occurrence",
            "slug" : "first_encounter_of_visit_occurrence",
            "x" : 140,
            "y" : 580,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "rgaYulafGsj-zj5YEVfnI$$01iuux5l9T-3OJrtSX232",
              "slug" : "encounter_id_and_visit_occurrence_id_projection",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "date_service",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "date_service_end",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "encounterclass",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_TYPE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_START_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_END_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID_NEW",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PRIORITY",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RN",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "w6hozWrxtd0TeEpwkg_lY$$knOENa-tJ9vYrVRP_c-T2",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ "rgaYulafGsj-zj5YEVfnI$$01iuux5l9T-3OJrtSX232##RN" ],
            "condition" : {
              "format" : "sql",
              "expression" : "RN = '1'"
            }
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Filter",
            "projectName" : "ProphecySparkBasicsPython"
          }
        }
      }
    },
    "TCzxCDVDD_ZOFKIcMsLMl$$zvdjHXX3PeSHbOmoO6X-a" : {
      "id" : "TCzxCDVDD_ZOFKIcMsLMl$$zvdjHXX3PeSHbOmoO6X-a",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "measurement_insert",
        "slug" : "measurement_insert",
        "x" : 0,
        "y" : 1420,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : { },
      "connections" : [ {
        "id" : "PnF2SWoHRJMHT3Q8p8Ajd$$wP2SR12iXOBNeSq0H-Bml",
        "source" : "71Gc_B_k9tV7FI21IXsJv$$__2aMVBkYsmDADaJQk7FZ",
        "sourcePort" : "lZ6TI5ceSkTU2WdzV6NNh$$X0gpW3nx1fb3hnmEYccXk",
        "target" : "b2Hj8DzcoYFNA_Zl0yZpt$$kzavWGosUm8nKthUxoGJb",
        "targetPort" : "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD"
      }, {
        "id" : "uyF9n4av4ReaBktblH4fW$$ja2si-fLkImOG4ODcEfcL",
        "source" : "b2Hj8DzcoYFNA_Zl0yZpt$$kzavWGosUm8nKthUxoGJb",
        "sourcePort" : "1v-eyMoge4xIQyULlqkcV$$Zpr43uVdEs-xnbS0lNxe8",
        "target" : "5cPFdlCCT_5aLZXRPi3i9$$Sh3W-kQEyM6hawYAMijyR",
        "targetPort" : "Q_ICLAncct8Dvzn4umPik$$hskQt4uaYjpD6RBLWIK6G"
      } ],
      "processes" : {
        "71Gc_B_k9tV7FI21IXsJv$$__2aMVBkYsmDADaJQk7FZ" : {
          "id" : "71Gc_B_k9tV7FI21IXsJv$$__2aMVBkYsmDADaJQk7FZ",
          "component" : "Subgraph",
          "metadata" : {
            "label" : "tmp",
            "slug" : "tmp",
            "x" : -20,
            "y" : 1520,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "lZ6TI5ceSkTU2WdzV6NNh$$X0gpW3nx1fb3hnmEYccXk",
              "slug" : "out0"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : { },
          "connections" : [ {
            "id" : "tM3U0QpPf3IbpjkkEsMX_",
            "source" : "ig2bBoYFVM2--cL-zoNmr$$ruua-ptE-D_ddnv46eCcp",
            "sourcePort" : "CTwL-MBAgEMhurjQ-AoKr$$1TJQ0in9xvUC-LdjHczTq",
            "target" : "O5iYjYvtetlkN_VIe-Nc8$$GtJoqzNF3hwf2aOSSf5tl",
            "targetPort" : "deLXe9s5EXLGTxHCNGgrc$$pbBKK0jrrDnds9JuxCZR2"
          }, {
            "id" : "10FpgupqbKwM0RC6DymHe",
            "source" : "xSq7OUxF50fqhKyl3LGN_$$9HW0JKGBJehx_36mNhKwA",
            "sourcePort" : "_ehvAMgiUETUgxhDIaXo-$$J4GGOrH8cMZIbkJAO48ko",
            "target" : "O5iYjYvtetlkN_VIe-Nc8$$GtJoqzNF3hwf2aOSSf5tl",
            "targetPort" : "p8xlB5sAMbuHjFiEcgkhG$$un8JlJV5ZZMDsgI-MuXct"
          }, {
            "id" : "ZTJV2FhRXa5dIXZzPLvT1",
            "source" : "WkF13FJP47SAJu2erpr2R$$pn9cps3mFpGtJdCVTqm64",
            "sourcePort" : "QnmLkCSBn-6Xpj6qGAV6a$$i5WujfoT4QKjkQqojZyy3",
            "target" : "O5iYjYvtetlkN_VIe-Nc8$$GtJoqzNF3hwf2aOSSf5tl",
            "targetPort" : "W9vQ05wkhTZsKnFQP6SRH$$ZsXuaWWKmxsH0PVQBHbo5"
          }, {
            "id" : "n1AkjJRshcVXpf5rt-mYy",
            "source" : "G7TfYQ-ffInciWOIWvm6P$$-_6ol--JdGKJVoBVo7ZLs",
            "sourcePort" : "JB_WOqcjToKisL1d_YN0k$$NhhnTr-cHzFsoB6HyJezj",
            "target" : "O5iYjYvtetlkN_VIe-Nc8$$GtJoqzNF3hwf2aOSSf5tl",
            "targetPort" : "wcxdc_od5A0pkjZbG-VJF$$F86rXohW_vetcVo4CGdBr"
          }, {
            "id" : "VCn3gma5XYVqEylPY0MjZ",
            "source" : "nquPg4JjtkPSjIIUyI4_P$$DbcWN8lNh5s2ELyj3nR-s",
            "sourcePort" : "PQC_jvuPhPV1H5CYmtYi4$$QWxevIlpPY2CB1PLyDrtt",
            "target" : "O5iYjYvtetlkN_VIe-Nc8$$GtJoqzNF3hwf2aOSSf5tl",
            "targetPort" : "cHvGfrj_zcfI0pnID-ZmX$$gK9Ncp9OrQaE_3x5BGjWF"
          }, {
            "id" : "ZX0FutOBW6X1p0j0takzM",
            "source" : "HNAHlSM-690ia1DJFnu1C$$bBPC6X_HdolgVX9t2QkZ2",
            "sourcePort" : "8BQ4BLrlP6NDYO0XGG-GM$$jt-I3wFRx_gyeYZx1m68z",
            "target" : "PSjnamLS1FM5_FIspetSu$$QYr9yD3oSAspcwFsqZ6eK",
            "targetPort" : "vG0jRQwCurV7chyPdHUrF$$tC9OtQCF04SKmREHgoUp8"
          }, {
            "id" : "Op0e7gx6FtbVAwYrMornq",
            "source" : "5gThBXkKp-t5CQBrW_ST_$$Y1JHqoDpweTtY8w0zEndU",
            "sourcePort" : "UJNbx4pA4aHC0eHI8EXIg$$X5IH9SvB_HInFoft5yGy_",
            "target" : "PSjnamLS1FM5_FIspetSu$$QYr9yD3oSAspcwFsqZ6eK",
            "targetPort" : "juo0_Vt7ZaGJuNlHqZdvN$$oFOHzlh6lrkolig5bx186"
          }, {
            "id" : "8L3g9nuQiUNPfAtCXuQO-",
            "source" : "jqBxWyjtLBWYzX8ppuiUy$$7AqnS3ZEwc5OhQdfBNHkL",
            "sourcePort" : "pSzkntVBew5HbHBTpkNh_$$1QR_qvfsrs84C_AR3vRKv",
            "target" : "PSjnamLS1FM5_FIspetSu$$QYr9yD3oSAspcwFsqZ6eK",
            "targetPort" : "mqxrMoi53VTs-Ib4G2e90$$T7B7u9_LPJ28CRymbnD0N"
          }, {
            "id" : "84myHBrruLlANyHPy3KLV",
            "source" : "MVbC274wpcdYGuekfKvmn$$lin6XeXYpbujnnDfYlXcF",
            "sourcePort" : "Vfv8SrFBiMe2JHmOKZo8_$$EM7RWZifxKk_v-IJvFwA3",
            "target" : "PSjnamLS1FM5_FIspetSu$$QYr9yD3oSAspcwFsqZ6eK",
            "targetPort" : "16kWokzo5FhGqV0SBgVTd$$dYsyPgrxdT0a9KzoSKErT"
          }, {
            "id" : "6UIAZyK7WG6ls2FgwO2z1",
            "source" : "B9fu4hGmWdqqVSsSvxkhj$$NLB04CaE_Z-IeRiHErz_G",
            "sourcePort" : "SON8q2blqTekdMkevDaTR$$oALjBD9Jn3Ht6jjsfuBK5",
            "target" : "PSjnamLS1FM5_FIspetSu$$QYr9yD3oSAspcwFsqZ6eK",
            "targetPort" : "Ru_AZZbB7WoufCGBjRSIe$$3whgTuXJAIlBiHqisDHNe"
          }, {
            "id" : "KXN2mp2qb28t6V9bNckzm",
            "source" : "Oo6Y8wD3mx-PlSrFqq6lH$$dz4vFgiZmMiGqWyW5oqvX",
            "sourcePort" : "DV3aCLMpypKvjBjCRCOmM$$9Bp-IHityMtlM7JsGJf3B",
            "target" : "PSjnamLS1FM5_FIspetSu$$QYr9yD3oSAspcwFsqZ6eK",
            "targetPort" : "zBpDhKWV42SrTQ9rWmuS7$$0DshKpqYvNANDDTV6HkDv"
          }, {
            "id" : "iRyqFLXFZ3uzlZOGo5LOt",
            "source" : "dseDWgmpuMTcUVaKdMQls$$w4eETefOECtfDSBAFN5K3",
            "sourcePort" : "lQjULqSv_CjvaVZq2poWM$$yzVbyZzcy0WuvDKDcGXvU",
            "target" : "PSjnamLS1FM5_FIspetSu$$QYr9yD3oSAspcwFsqZ6eK",
            "targetPort" : "UHy6wUT8-Yo1io_Z_YgEV$$zfm-aypGb7KUFU1nmyOgl"
          }, {
            "id" : "ZM9sfCtSuTy439_6kyJNw",
            "source" : "O5iYjYvtetlkN_VIe-Nc8$$GtJoqzNF3hwf2aOSSf5tl",
            "sourcePort" : "_jGa9Le2yeHPNnPeee9w9$$Rhj3hVRNhQJ6npk4fm5-z",
            "target" : "YPXoFoeQ3eVi_CpdrT_bR$$ZchDcr-ctywAA-CxLXqce",
            "targetPort" : "7WtLbdBsJnqR9HbegcpKC$$U8D180spr3Sh57WKB_WGn"
          }, {
            "id" : "8I83xehfAn4hlGH2ryhLI",
            "source" : "PSjnamLS1FM5_FIspetSu$$QYr9yD3oSAspcwFsqZ6eK",
            "sourcePort" : "0cGT9JjAint4pioM2PkkD$$-ineqKxNY10aeGIDA1FZ6",
            "target" : "YPXoFoeQ3eVi_CpdrT_bR$$ZchDcr-ctywAA-CxLXqce",
            "targetPort" : "ZV54vAiZP1BKwLuw-LPM3$$IccQfR_PRO9zUpmpG7Jc8"
          }, {
            "id" : "SAw6OEdl3hUop3R-kgKzn",
            "source" : "YPXoFoeQ3eVi_CpdrT_bR$$ZchDcr-ctywAA-CxLXqce",
            "sourcePort" : "k4qtRR9_6FDkN2Fnk8K1I$$kv0NQD-mXjNF_g8PzPJmB",
            "target" : "71Gc_B_k9tV7FI21IXsJv$$__2aMVBkYsmDADaJQk7FZ",
            "targetPort" : "lZ6TI5ceSkTU2WdzV6NNh$$X0gpW3nx1fb3hnmEYccXk"
          } ],
          "processes" : {
            "jqBxWyjtLBWYzX8ppuiUy$$7AqnS3ZEwc5OhQdfBNHkL" : {
              "id" : "jqBxWyjtLBWYzX8ppuiUy$$7AqnS3ZEwc5OhQdfBNHkL",
              "component" : "Source",
              "metadata" : {
                "label" : "source_to_standard_vocab_map_2",
                "slug" : "source_to_standard_vocab_map_2",
                "x" : -200,
                "y" : 2440,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ ],
                "outputs" : [ {
                  "id" : "pSzkntVBew5HbHBTpkNh_$$1QR_qvfsrs84C_AR3vRKv",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "datasetId" : "datasets/source_to_standard_vocab_map"
              }
            },
            "xSq7OUxF50fqhKyl3LGN_$$9HW0JKGBJehx_36mNhKwA" : {
              "id" : "xSq7OUxF50fqhKyl3LGN_$$9HW0JKGBJehx_36mNhKwA",
              "component" : "Source",
              "metadata" : {
                "label" : "source_to_standard_vocab_map_1_1",
                "slug" : "source_to_standard_vocab_map_1_1",
                "x" : -200,
                "y" : 1560,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ ],
                "outputs" : [ {
                  "id" : "_ehvAMgiUETUgxhDIaXo-$$J4GGOrH8cMZIbkJAO48ko",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "datasetId" : "datasets/source_to_standard_vocab_map"
              }
            },
            "ig2bBoYFVM2--cL-zoNmr$$ruua-ptE-D_ddnv46eCcp" : {
              "id" : "ig2bBoYFVM2--cL-zoNmr$$ruua-ptE-D_ddnv46eCcp",
              "component" : "Source",
              "metadata" : {
                "label" : "procedures_1",
                "slug" : "procedures_1",
                "x" : -200,
                "y" : 1420,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ ],
                "outputs" : [ {
                  "id" : "CTwL-MBAgEMhurjQ-AoKr$$1TJQ0in9xvUC-LdjHczTq",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "datasetId" : "datasets/l0_bronze_layer_procedures"
              }
            },
            "YPXoFoeQ3eVi_CpdrT_bR$$ZchDcr-ctywAA-CxLXqce" : {
              "id" : "YPXoFoeQ3eVi_CpdrT_bR$$ZchDcr-ctywAA-CxLXqce",
              "component" : "SetOperation",
              "metadata" : {
                "label" : "SetOperation_2",
                "slug" : "SetOperation_2",
                "x" : 440,
                "y" : 2060,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "7WtLbdBsJnqR9HbegcpKC$$U8D180spr3Sh57WKB_WGn",
                  "slug" : "in0",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "person_id",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "measurement_concept_id",
                      "type" : "long",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "measurement_date",
                      "type" : "date",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "measurement_datetime",
                      "type" : "timestamp",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "measurement_time",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "measurement_type_concept_id",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "operator_concept_id",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "value_as_number",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "value_as_concept_id",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "unit_concept_id",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "range_low",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "range_high",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "provider_id",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "visit_occurrence_id",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "visit_detail_id",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "measurement_source_value",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "measurement_source_concept_id",
                      "type" : "long",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "unit_source_value",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "value_source_value",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                }, {
                  "id" : "ZV54vAiZP1BKwLuw-LPM3$$IccQfR_PRO9zUpmpG7Jc8",
                  "slug" : "in1",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "person_id",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "measurement_concept_id",
                      "type" : "long",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "measurement_date",
                      "type" : "date",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "measurement_datetime",
                      "type" : "timestamp",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "measurement_time",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "MEASUREMENT_TYPE_CONCEPT_ID",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "OPERATOR_CONCEPT_ID",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "value_as_number",
                      "type" : "float",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "value_as_concept_id",
                      "type" : "long",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "unit_concept_id",
                      "type" : "long",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "RANGE_LOW",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "RANGE_HIGH",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "provider_id",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "visit_occurrence_id",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "visit_detail_id",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "measurement_source_value",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "measurement_source_concept_id",
                      "type" : "long",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "unit_source_value",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "value_source_value",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "k4qtRR9_6FDkN2Fnk8K1I$$kv0NQD-mXjNF_g8PzPJmB",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "operationType" : "unionAll",
                "allowMissingColumns" : false
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/SetOperation",
                "projectName" : "ProphecySparkBasicsPython"
              }
            },
            "Oo6Y8wD3mx-PlSrFqq6lH$$dz4vFgiZmMiGqWyW5oqvX" : {
              "id" : "Oo6Y8wD3mx-PlSrFqq6lH$$dz4vFgiZmMiGqWyW5oqvX",
              "component" : "Source",
              "metadata" : {
                "label" : "final_visit_ids_3",
                "slug" : "final_visit_ids_3",
                "x" : -200,
                "y" : 2860,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ ],
                "outputs" : [ {
                  "id" : "DV3aCLMpypKvjBjCRCOmM$$9Bp-IHityMtlM7JsGJf3B",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "datasetId" : "datasets/final_visit_ids"
              }
            },
            "dseDWgmpuMTcUVaKdMQls$$w4eETefOECtfDSBAFN5K3" : {
              "id" : "dseDWgmpuMTcUVaKdMQls$$w4eETefOECtfDSBAFN5K3",
              "component" : "Source",
              "metadata" : {
                "label" : "person_4",
                "slug" : "person_4",
                "x" : -200,
                "y" : 3020,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ ],
                "outputs" : [ {
                  "id" : "lQjULqSv_CjvaVZq2poWM$$yzVbyZzcy0WuvDKDcGXvU",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "datasetId" : "datasets/person"
              }
            },
            "WkF13FJP47SAJu2erpr2R$$pn9cps3mFpGtJdCVTqm64" : {
              "id" : "WkF13FJP47SAJu2erpr2R$$pn9cps3mFpGtJdCVTqm64",
              "component" : "Source",
              "metadata" : {
                "label" : "source_to_source_vocab_map_1_1",
                "slug" : "source_to_source_vocab_map_1_1",
                "x" : -200,
                "y" : 1700,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ ],
                "outputs" : [ {
                  "id" : "QnmLkCSBn-6Xpj6qGAV6a$$i5WujfoT4QKjkQqojZyy3",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "datasetId" : "datasets/source_to_source_vocab_map"
              }
            },
            "O5iYjYvtetlkN_VIe-Nc8$$GtJoqzNF3hwf2aOSSf5tl" : {
              "id" : "O5iYjYvtetlkN_VIe-Nc8$$GtJoqzNF3hwf2aOSSf5tl",
              "component" : "Join",
              "metadata" : {
                "label" : "join_multiple_dataframes_1",
                "slug" : "join_multiple_dataframes_1",
                "x" : 120,
                "y" : 1740,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "deLXe9s5EXLGTxHCNGgrc$$pbBKK0jrrDnds9JuxCZR2",
                  "slug" : "pr",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "DATE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "PATIENT",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "ENCOUNTER",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "CODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "DESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "COST",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "REASONCODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "REASONDESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                }, {
                  "id" : "p8xlB5sAMbuHjFiEcgkhG$$un8JlJV5ZZMDsgI-MuXct",
                  "slug" : "srctostdvm",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "SOURCE_CODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_CONCEPT_ID",
                      "type" : "long",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_CODE_DESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_VOCABULARY_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_DOMAIN_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_CONCEPT_CLASS_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_VALID_START_DATE",
                      "type" : "date",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_VALID_END_DATE",
                      "type" : "date",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_INVALID_REASON",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_CONCEPT_ID",
                      "type" : "long",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_CONCEPT_NAME",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_VOCABULARY_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_DOMAIN_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_CONCEPT_CLASS_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_INVALID_REASON",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_STANDARD_CONCEPT",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                }, {
                  "id" : "W9vQ05wkhTZsKnFQP6SRH$$ZsXuaWWKmxsH0PVQBHbo5",
                  "slug" : "srctosrcvm",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "SOURCE_CODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_CONCEPT_ID",
                      "type" : "long",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_CODE_DESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_VOCABULARY_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_DOMAIN_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_CONCEPT_CLASS_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_VALID_START_DATE",
                      "type" : "date",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_VALID_END_DATE",
                      "type" : "date",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_INVALID_REASON",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_CONCEPT_ID",
                      "type" : "long",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_CONCEPT_NAME",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_VOCABULARY_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_DOMAIN_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_CONCEPT_CLASS_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_INVALID_REASON",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_STANDARD_CONCEPT",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                }, {
                  "id" : "wcxdc_od5A0pkjZbG-VJF$$F86rXohW_vetcVo4CGdBr",
                  "slug" : "fv",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "encounter_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "VISIT_OCCURRENCE_ID_NEW",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                }, {
                  "id" : "cHvGfrj_zcfI0pnID-ZmX$$gK9Ncp9OrQaE_3x5BGjWF",
                  "slug" : "p",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "person_id",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "gender_concept_id",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "YEAR_OF_BIRTH",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "MONTH_OF_BIRTH",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "DAY_OF_BIRTH",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "BIRTH_DATETIME",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "RACE_CONCEPT_ID",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "ETHNICITY_CONCEPT_ID",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "LOCATION_ID",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "PROVIDER_ID",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "CARE_SITE_ID",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "PERSON_SOURCE_VALUE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "GENDER_SOURCE_VALUE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "GENDER_SOURCE_CONCEPT_ID",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "RACE_SOURCE_VALUE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "RACE_SOURCE_CONCEPT_ID",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "ETHNICITY_SOURCE_VALUE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "ETHNICITY_SOURCE_CONCEPT_ID",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "_jGa9Le2yeHPNnPeee9w9$$Rhj3hVRNhQJ6npk4fm5-z",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "conditions" : [ {
                  "alias" : "srctostdvm",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "srctostdvm.SOURCE_CODE = pr.CODE\nAND srctostdvm.TARGET_DOMAIN_ID = 'Measurement'\nAND srctostdvm.SOURCE_VOCABULARY_ID = 'SNOMED'\nAND srctostdvm.TARGET_STANDARD_CONCEPT = 'S'\nAND (srctostdvm.TARGET_INVALID_REASON IS NULL or srctostdvm.TARGET_INVALID_REASON = '')\n"
                  },
                  "joinType" : "inner"
                }, {
                  "alias" : "srctosrcvm",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "srctosrcvm.SOURCE_CODE = pr.CODE\nAND srctosrcvm.SOURCE_VOCABULARY_ID = 'SNOMED'"
                  },
                  "joinType" : "left_outer"
                }, {
                  "alias" : "fv",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "fv.encounter_id = pr.ENCOUNTER"
                  },
                  "joinType" : "left_outer"
                }, {
                  "alias" : "p",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "p.PERSON_SOURCE_VALUE = pr.PATIENT"
                  },
                  "joinType" : "inner"
                } ],
                "expressions" : [ {
                  "target" : "person_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "p.person_id"
                  },
                  "description" : "",
                  "_row_id" : "c_41"
                }, {
                  "target" : "measurement_concept_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "coalesce(srctostdvm.TARGET_CONCEPT_ID, 0)"
                  },
                  "description" : "",
                  "_row_id" : "c_42"
                }, {
                  "target" : "measurement_date",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "cast(pr.DATE as date)"
                  },
                  "description" : "",
                  "_row_id" : "c_43"
                }, {
                  "target" : "measurement_datetime",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "cast(pr.DATE as timestamp)"
                  },
                  "description" : "",
                  "_row_id" : "c_44"
                }, {
                  "target" : "measurement_time",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "cast(pr.date as string)"
                  },
                  "description" : "",
                  "_row_id" : "c_45"
                }, {
                  "target" : "measurement_type_concept_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "5001"
                  },
                  "description" : "",
                  "_row_id" : "c_50"
                }, {
                  "target" : "operator_concept_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "0"
                  },
                  "description" : "",
                  "_row_id" : "c_51"
                }, {
                  "target" : "value_as_number",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "cast(null as integer)"
                  },
                  "description" : "",
                  "_row_id" : "c_52"
                }, {
                  "target" : "value_as_concept_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "0"
                  },
                  "description" : "",
                  "_row_id" : "c_53"
                }, {
                  "target" : "unit_concept_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "0"
                  },
                  "description" : "",
                  "_row_id" : "c_54"
                }, {
                  "target" : "range_low",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "cast(null as integer)"
                  },
                  "description" : "",
                  "_row_id" : "c_55"
                }, {
                  "target" : "range_high",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "cast(null as integer)"
                  },
                  "description" : "",
                  "_row_id" : "c_56"
                }, {
                  "target" : "provider_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "0"
                  },
                  "description" : "",
                  "_row_id" : "c_57"
                }, {
                  "target" : "visit_occurrence_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "fv.VISIT_OCCURRENCE_ID_NEW"
                  },
                  "description" : "",
                  "_row_id" : "c_58"
                }, {
                  "target" : "visit_detail_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "0"
                  },
                  "description" : "",
                  "_row_id" : "c_59"
                }, {
                  "target" : "measurement_source_value",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "pr.CODE"
                  },
                  "description" : "",
                  "_row_id" : "c_60"
                }, {
                  "target" : "measurement_source_concept_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "coalesce(srctosrcvm.SOURCE_CONCEPT_ID, 0)"
                  },
                  "description" : "",
                  "_row_id" : "c_61"
                }, {
                  "target" : "unit_source_value",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "cast(null as string)"
                  },
                  "description" : "",
                  "_row_id" : "c_62"
                }, {
                  "target" : "value_source_value",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "cast(null as string)"
                  },
                  "description" : "",
                  "_row_id" : "c_63"
                } ],
                "hints" : [ {
                  "id" : "deLXe9s5EXLGTxHCNGgrc$$pbBKK0jrrDnds9JuxCZR2",
                  "alias" : "pr",
                  "hintType" : "none",
                  "propagateColumns" : false
                }, {
                  "id" : "p8xlB5sAMbuHjFiEcgkhG$$un8JlJV5ZZMDsgI-MuXct",
                  "alias" : "srctostdvm",
                  "hintType" : "none",
                  "propagateColumns" : false
                }, {
                  "id" : "W9vQ05wkhTZsKnFQP6SRH$$ZsXuaWWKmxsH0PVQBHbo5",
                  "alias" : "srctosrcvm",
                  "hintType" : "none",
                  "propagateColumns" : false
                }, {
                  "id" : "wcxdc_od5A0pkjZbG-VJF$$F86rXohW_vetcVo4CGdBr",
                  "alias" : "fv",
                  "hintType" : "none",
                  "propagateColumns" : false
                }, {
                  "id" : "cHvGfrj_zcfI0pnID-ZmX$$gK9Ncp9OrQaE_3x5BGjWF",
                  "alias" : "p",
                  "hintType" : "none",
                  "propagateColumns" : false
                } ],
                "allIn1" : null,
                "activeTab" : "expressions",
                "columnsSelector" : [ "p8xlB5sAMbuHjFiEcgkhG$$un8JlJV5ZZMDsgI-MuXct##TARGET_INVALID_REASON", "W9vQ05wkhTZsKnFQP6SRH$$ZsXuaWWKmxsH0PVQBHbo5##SOURCE_CODE", "cHvGfrj_zcfI0pnID-ZmX$$gK9Ncp9OrQaE_3x5BGjWF##PERSON_SOURCE_VALUE", "p8xlB5sAMbuHjFiEcgkhG$$un8JlJV5ZZMDsgI-MuXct##TARGET_STANDARD_CONCEPT", "wcxdc_od5A0pkjZbG-VJF$$F86rXohW_vetcVo4CGdBr##encounter_id", "p8xlB5sAMbuHjFiEcgkhG$$un8JlJV5ZZMDsgI-MuXct##SOURCE_VOCABULARY_ID", "p8xlB5sAMbuHjFiEcgkhG$$un8JlJV5ZZMDsgI-MuXct##TARGET_DOMAIN_ID", "W9vQ05wkhTZsKnFQP6SRH$$ZsXuaWWKmxsH0PVQBHbo5##SOURCE_VOCABULARY_ID", "deLXe9s5EXLGTxHCNGgrc$$pbBKK0jrrDnds9JuxCZR2##CODE", "deLXe9s5EXLGTxHCNGgrc$$pbBKK0jrrDnds9JuxCZR2##PATIENT", "deLXe9s5EXLGTxHCNGgrc$$pbBKK0jrrDnds9JuxCZR2##ENCOUNTER", "p8xlB5sAMbuHjFiEcgkhG$$un8JlJV5ZZMDsgI-MuXct##SOURCE_CODE", "wcxdc_od5A0pkjZbG-VJF$$F86rXohW_vetcVo4CGdBr##VISIT_OCCURRENCE_ID_NEW", "p8xlB5sAMbuHjFiEcgkhG$$un8JlJV5ZZMDsgI-MuXct##TARGET_CONCEPT_ID", "cHvGfrj_zcfI0pnID-ZmX$$gK9Ncp9OrQaE_3x5BGjWF##person_id", "deLXe9s5EXLGTxHCNGgrc$$pbBKK0jrrDnds9JuxCZR2##DATE", "W9vQ05wkhTZsKnFQP6SRH$$ZsXuaWWKmxsH0PVQBHbo5##SOURCE_CONCEPT_ID", "deLXe9s5EXLGTxHCNGgrc$$pbBKK0jrrDnds9JuxCZR2##CODE" ],
                "allIn0" : null,
                "whereClause" : null,
                "headAlias" : "pr"
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Join",
                "projectName" : "ProphecySparkBasicsPython"
              }
            },
            "B9fu4hGmWdqqVSsSvxkhj$$NLB04CaE_Z-IeRiHErz_G" : {
              "id" : "B9fu4hGmWdqqVSsSvxkhj$$NLB04CaE_Z-IeRiHErz_G",
              "component" : "Source",
              "metadata" : {
                "label" : "source_to_standard_vocab_map_4",
                "slug" : "source_to_standard_vocab_map_4",
                "x" : -200,
                "y" : 2720,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ ],
                "outputs" : [ {
                  "id" : "SON8q2blqTekdMkevDaTR$$oALjBD9Jn3Ht6jjsfuBK5",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "datasetId" : "datasets/source_to_standard_vocab_map"
              }
            },
            "nquPg4JjtkPSjIIUyI4_P$$DbcWN8lNh5s2ELyj3nR-s" : {
              "id" : "nquPg4JjtkPSjIIUyI4_P$$DbcWN8lNh5s2ELyj3nR-s",
              "component" : "Source",
              "metadata" : {
                "label" : "person_4_1",
                "slug" : "person_4_1",
                "x" : -200,
                "y" : 1980,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ ],
                "outputs" : [ {
                  "id" : "PQC_jvuPhPV1H5CYmtYi4$$QWxevIlpPY2CB1PLyDrtt",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "datasetId" : "datasets/person"
              }
            },
            "MVbC274wpcdYGuekfKvmn$$lin6XeXYpbujnnDfYlXcF" : {
              "id" : "MVbC274wpcdYGuekfKvmn$$lin6XeXYpbujnnDfYlXcF",
              "component" : "Source",
              "metadata" : {
                "label" : "source_to_standard_vocab_map_3",
                "slug" : "source_to_standard_vocab_map_3",
                "x" : -200,
                "y" : 2580,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ ],
                "outputs" : [ {
                  "id" : "Vfv8SrFBiMe2JHmOKZo8_$$EM7RWZifxKk_v-IJvFwA3",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "datasetId" : "datasets/source_to_standard_vocab_map"
              }
            },
            "G7TfYQ-ffInciWOIWvm6P$$-_6ol--JdGKJVoBVo7ZLs" : {
              "id" : "G7TfYQ-ffInciWOIWvm6P$$-_6ol--JdGKJVoBVo7ZLs",
              "component" : "Source",
              "metadata" : {
                "label" : "final_visit_ids_3_1",
                "slug" : "final_visit_ids_3_1",
                "x" : -200,
                "y" : 1840,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ ],
                "outputs" : [ {
                  "id" : "JB_WOqcjToKisL1d_YN0k$$NhhnTr-cHzFsoB6HyJezj",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "datasetId" : "datasets/final_visit_ids"
              }
            },
            "PSjnamLS1FM5_FIspetSu$$QYr9yD3oSAspcwFsqZ6eK" : {
              "id" : "PSjnamLS1FM5_FIspetSu$$QYr9yD3oSAspcwFsqZ6eK",
              "component" : "Join",
              "metadata" : {
                "label" : "join_multiple_dataframes",
                "slug" : "join_multiple_dataframes",
                "x" : 100,
                "y" : 2440,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "vG0jRQwCurV7chyPdHUrF$$tC9OtQCF04SKmREHgoUp8",
                  "slug" : "o",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "DATE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "PATIENT",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "ENCOUNTER",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "CODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "DESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "VALUE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "UNITS",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TYPE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                }, {
                  "id" : "juo0_Vt7ZaGJuNlHqZdvN$$oFOHzlh6lrkolig5bx186",
                  "slug" : "srctostdvm",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "SOURCE_CODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_CONCEPT_ID",
                      "type" : "long",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_CODE_DESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_VOCABULARY_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_DOMAIN_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_CONCEPT_CLASS_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_VALID_START_DATE",
                      "type" : "date",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_VALID_END_DATE",
                      "type" : "date",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_INVALID_REASON",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_CONCEPT_ID",
                      "type" : "long",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_CONCEPT_NAME",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_VOCABULARY_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_DOMAIN_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_CONCEPT_CLASS_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_INVALID_REASON",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_STANDARD_CONCEPT",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                }, {
                  "id" : "mqxrMoi53VTs-Ib4G2e90$$T7B7u9_LPJ28CRymbnD0N",
                  "slug" : "srcmap1",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "SOURCE_CODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_CONCEPT_ID",
                      "type" : "long",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_CODE_DESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_VOCABULARY_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_DOMAIN_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_CONCEPT_CLASS_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_VALID_START_DATE",
                      "type" : "date",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_VALID_END_DATE",
                      "type" : "date",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_INVALID_REASON",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_CONCEPT_ID",
                      "type" : "long",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_CONCEPT_NAME",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_VOCABULARY_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_DOMAIN_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_CONCEPT_CLASS_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_INVALID_REASON",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_STANDARD_CONCEPT",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                }, {
                  "id" : "16kWokzo5FhGqV0SBgVTd$$dYsyPgrxdT0a9KzoSKErT",
                  "slug" : "srcmap2",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "SOURCE_CODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_CONCEPT_ID",
                      "type" : "long",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_CODE_DESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_VOCABULARY_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_DOMAIN_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_CONCEPT_CLASS_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_VALID_START_DATE",
                      "type" : "date",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_VALID_END_DATE",
                      "type" : "date",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_INVALID_REASON",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_CONCEPT_ID",
                      "type" : "long",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_CONCEPT_NAME",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_VOCABULARY_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_DOMAIN_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_CONCEPT_CLASS_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_INVALID_REASON",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_STANDARD_CONCEPT",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                }, {
                  "id" : "Ru_AZZbB7WoufCGBjRSIe$$3whgTuXJAIlBiHqisDHNe",
                  "slug" : "srctosrcvm",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "SOURCE_CODE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_CONCEPT_ID",
                      "type" : "long",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_CODE_DESCRIPTION",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_VOCABULARY_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_DOMAIN_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_CONCEPT_CLASS_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_VALID_START_DATE",
                      "type" : "date",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_VALID_END_DATE",
                      "type" : "date",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "SOURCE_INVALID_REASON",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_CONCEPT_ID",
                      "type" : "long",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_CONCEPT_NAME",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_VOCABULARY_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_DOMAIN_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_CONCEPT_CLASS_ID",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_INVALID_REASON",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "TARGET_STANDARD_CONCEPT",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                }, {
                  "id" : "zBpDhKWV42SrTQ9rWmuS7$$0DshKpqYvNANDDTV6HkDv",
                  "slug" : "fv",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "encounter_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "VISIT_OCCURRENCE_ID_NEW",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                }, {
                  "id" : "UHy6wUT8-Yo1io_Z_YgEV$$zfm-aypGb7KUFU1nmyOgl",
                  "slug" : "p",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "person_id",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "gender_concept_id",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "YEAR_OF_BIRTH",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "MONTH_OF_BIRTH",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "DAY_OF_BIRTH",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "BIRTH_DATETIME",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "RACE_CONCEPT_ID",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "ETHNICITY_CONCEPT_ID",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "LOCATION_ID",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "PROVIDER_ID",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "CARE_SITE_ID",
                      "type" : "integer",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "PERSON_SOURCE_VALUE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "GENDER_SOURCE_VALUE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "GENDER_SOURCE_CONCEPT_ID",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "RACE_SOURCE_VALUE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "RACE_SOURCE_CONCEPT_ID",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "ETHNICITY_SOURCE_VALUE",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "ETHNICITY_SOURCE_CONCEPT_ID",
                      "type" : "integer",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "0cGT9JjAint4pioM2PkkD$$-ineqKxNY10aeGIDA1FZ6",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "conditions" : [ {
                  "alias" : "srctostdvm",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "srctostdvm.SOURCE_CODE = o.CODE\nAND srctostdvm.TARGET_DOMAIN_ID = 'Measurement'\nAND srctostdvm.SOURCE_VOCABULARY_ID = 'LOINC'\nAND srctostdvm.TARGET_STANDARD_CONCEPT = 'S'\nAND (srctostdvm.TARGET_INVALID_REASON IS NULL OR srctostdvm.TARGET_INVALID_REASON = '')"
                  },
                  "joinType" : "inner"
                }, {
                  "alias" : "srcmap1",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "srcmap1.SOURCE_CODE = o.UNITS\nAND srcmap1.TARGET_VOCABULARY_ID = 'UCUM'\nAND srcmap1.TARGET_STANDARD_CONCEPT = 'S'\nAND (srcmap1.TARGET_INVALID_REASON IS NULL OR srcmap1.TARGET_INVALID_REASON = '')"
                  },
                  "joinType" : "left_outer"
                }, {
                  "alias" : "srcmap2",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "srcmap2.SOURCE_CODE = o.VALUE\nAND srcmap2.TARGET_DOMAIN_ID = 'Meas value'\nAND srcmap2.TARGET_STANDARD_CONCEPT = 'S'\nAND (srcmap2.TARGET_INVALID_REASON IS NULL OR srcmap2.TARGET_INVALID_REASON = '')"
                  },
                  "joinType" : "left_outer"
                }, {
                  "alias" : "srctosrcvm",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "srctosrcvm.SOURCE_CODE = o.CODE\nAND srctosrcvm.SOURCE_VOCABULARY_ID = 'LOINC'"
                  },
                  "joinType" : "left_outer"
                }, {
                  "alias" : "fv",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "fv.encounter_id = o.ENCOUNTER"
                  },
                  "joinType" : "left_outer"
                }, {
                  "alias" : "p",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "p.PERSON_SOURCE_VALUE = o.PATIENT"
                  },
                  "joinType" : "inner"
                } ],
                "expressions" : [ {
                  "target" : "person_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "p.person_id"
                  },
                  "description" : "",
                  "_row_id" : "c_69"
                }, {
                  "target" : "measurement_concept_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "coalesce(srctostdvm.TARGET_CONCEPT_ID, 0)"
                  },
                  "description" : "",
                  "_row_id" : "c_70"
                }, {
                  "target" : "measurement_date",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "cast(o.DATE as date)"
                  },
                  "description" : "",
                  "_row_id" : "c_71"
                }, {
                  "target" : "measurement_datetime",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "cast(o.DATE as timestamp)"
                  },
                  "description" : "",
                  "_row_id" : "c_72"
                }, {
                  "target" : "measurement_time",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "cast(o.DATE as string)"
                  },
                  "description" : "",
                  "_row_id" : "c_73"
                }, {
                  "target" : "MEASUREMENT_TYPE_CONCEPT_ID",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "5001"
                  },
                  "description" : "",
                  "_row_id" : "c_76"
                }, {
                  "target" : "OPERATOR_CONCEPT_ID",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "0"
                  },
                  "description" : "",
                  "_row_id" : "c_77"
                }, {
                  "target" : "value_as_number",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "nanvl(cast(o.VALUE as float), null)"
                  },
                  "description" : "",
                  "_row_id" : "c_78"
                }, {
                  "target" : "value_as_concept_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "coalesce(srcmap2.target_concept_id, 0)"
                  },
                  "description" : "",
                  "_row_id" : "c_79"
                }, {
                  "target" : "unit_concept_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "coalesce(srcmap1.TARGET_CONCEPT_ID, 0)"
                  },
                  "description" : "",
                  "_row_id" : "c_80"
                }, {
                  "target" : "RANGE_LOW",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "cast(null as integer)"
                  },
                  "description" : "",
                  "_row_id" : "c_81"
                }, {
                  "target" : "RANGE_HIGH",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "cast(null as integer)"
                  },
                  "description" : "",
                  "_row_id" : "c_82"
                }, {
                  "target" : "provider_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "0"
                  },
                  "description" : "",
                  "_row_id" : "c_83"
                }, {
                  "target" : "visit_occurrence_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "fv.VISIT_OCCURRENCE_ID_NEW"
                  },
                  "description" : "",
                  "_row_id" : "c_84"
                }, {
                  "target" : "visit_detail_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "0"
                  },
                  "description" : "",
                  "_row_id" : "c_85"
                }, {
                  "target" : "measurement_source_value",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "o.CODE"
                  },
                  "description" : "",
                  "_row_id" : "c_86"
                }, {
                  "target" : "measurement_source_concept_id",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "coalesce(srctosrcvm.SOURCE_CONCEPT_ID, 0)"
                  },
                  "description" : "",
                  "_row_id" : "c_87"
                }, {
                  "target" : "unit_source_value",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "o.UNITS"
                  },
                  "description" : "",
                  "_row_id" : "c_88"
                }, {
                  "target" : "value_source_value",
                  "expression" : {
                    "format" : "sql",
                    "expression" : "o.VALUE"
                  },
                  "description" : "",
                  "_row_id" : "c_89"
                } ],
                "hints" : [ {
                  "id" : "vG0jRQwCurV7chyPdHUrF$$tC9OtQCF04SKmREHgoUp8",
                  "alias" : "o",
                  "hintType" : "none",
                  "propagateColumns" : false
                }, {
                  "id" : "juo0_Vt7ZaGJuNlHqZdvN$$oFOHzlh6lrkolig5bx186",
                  "alias" : "srctostdvm",
                  "hintType" : "none",
                  "propagateColumns" : false
                }, {
                  "id" : "mqxrMoi53VTs-Ib4G2e90$$T7B7u9_LPJ28CRymbnD0N",
                  "alias" : "srcmap1",
                  "hintType" : "none",
                  "propagateColumns" : false
                }, {
                  "id" : "16kWokzo5FhGqV0SBgVTd$$dYsyPgrxdT0a9KzoSKErT",
                  "alias" : "srcmap2",
                  "hintType" : "none",
                  "propagateColumns" : false
                }, {
                  "id" : "Ru_AZZbB7WoufCGBjRSIe$$3whgTuXJAIlBiHqisDHNe",
                  "alias" : "srctosrcvm",
                  "hintType" : "none",
                  "propagateColumns" : false
                }, {
                  "id" : "zBpDhKWV42SrTQ9rWmuS7$$0DshKpqYvNANDDTV6HkDv",
                  "alias" : "fv",
                  "hintType" : "none",
                  "propagateColumns" : false
                }, {
                  "id" : "UHy6wUT8-Yo1io_Z_YgEV$$zfm-aypGb7KUFU1nmyOgl",
                  "alias" : "p",
                  "hintType" : "none",
                  "propagateColumns" : false
                } ],
                "allIn1" : null,
                "activeTab" : "expressions",
                "columnsSelector" : [ "16kWokzo5FhGqV0SBgVTd$$dYsyPgrxdT0a9KzoSKErT##SOURCE_CODE", "vG0jRQwCurV7chyPdHUrF$$tC9OtQCF04SKmREHgoUp8##VALUE", "mqxrMoi53VTs-Ib4G2e90$$T7B7u9_LPJ28CRymbnD0N##TARGET_INVALID_REASON", "vG0jRQwCurV7chyPdHUrF$$tC9OtQCF04SKmREHgoUp8##UNITS", "vG0jRQwCurV7chyPdHUrF$$tC9OtQCF04SKmREHgoUp8##ENCOUNTER", "mqxrMoi53VTs-Ib4G2e90$$T7B7u9_LPJ28CRymbnD0N##SOURCE_CODE", "16kWokzo5FhGqV0SBgVTd$$dYsyPgrxdT0a9KzoSKErT##TARGET_STANDARD_CONCEPT", "Ru_AZZbB7WoufCGBjRSIe$$3whgTuXJAIlBiHqisDHNe##SOURCE_VOCABULARY_ID", "zBpDhKWV42SrTQ9rWmuS7$$0DshKpqYvNANDDTV6HkDv##encounter_id", "juo0_Vt7ZaGJuNlHqZdvN$$oFOHzlh6lrkolig5bx186##TARGET_DOMAIN_ID", "UHy6wUT8-Yo1io_Z_YgEV$$zfm-aypGb7KUFU1nmyOgl##PERSON_SOURCE_VALUE", "vG0jRQwCurV7chyPdHUrF$$tC9OtQCF04SKmREHgoUp8##PATIENT", "Ru_AZZbB7WoufCGBjRSIe$$3whgTuXJAIlBiHqisDHNe##SOURCE_CODE", "16kWokzo5FhGqV0SBgVTd$$dYsyPgrxdT0a9KzoSKErT##TARGET_DOMAIN_ID", "juo0_Vt7ZaGJuNlHqZdvN$$oFOHzlh6lrkolig5bx186##SOURCE_VOCABULARY_ID", "juo0_Vt7ZaGJuNlHqZdvN$$oFOHzlh6lrkolig5bx186##SOURCE_CODE", "mqxrMoi53VTs-Ib4G2e90$$T7B7u9_LPJ28CRymbnD0N##TARGET_STANDARD_CONCEPT", "mqxrMoi53VTs-Ib4G2e90$$T7B7u9_LPJ28CRymbnD0N##TARGET_VOCABULARY_ID", "16kWokzo5FhGqV0SBgVTd$$dYsyPgrxdT0a9KzoSKErT##TARGET_INVALID_REASON", "juo0_Vt7ZaGJuNlHqZdvN$$oFOHzlh6lrkolig5bx186##TARGET_STANDARD_CONCEPT", "juo0_Vt7ZaGJuNlHqZdvN$$oFOHzlh6lrkolig5bx186##TARGET_INVALID_REASON", "vG0jRQwCurV7chyPdHUrF$$tC9OtQCF04SKmREHgoUp8##CODE", "vG0jRQwCurV7chyPdHUrF$$tC9OtQCF04SKmREHgoUp8##UNITS", "juo0_Vt7ZaGJuNlHqZdvN$$oFOHzlh6lrkolig5bx186##TARGET_CONCEPT_ID", "zBpDhKWV42SrTQ9rWmuS7$$0DshKpqYvNANDDTV6HkDv##VISIT_OCCURRENCE_ID_NEW", "UHy6wUT8-Yo1io_Z_YgEV$$zfm-aypGb7KUFU1nmyOgl##person_id", "Ru_AZZbB7WoufCGBjRSIe$$3whgTuXJAIlBiHqisDHNe##SOURCE_CONCEPT_ID", "mqxrMoi53VTs-Ib4G2e90$$T7B7u9_LPJ28CRymbnD0N##TARGET_CONCEPT_ID", "vG0jRQwCurV7chyPdHUrF$$tC9OtQCF04SKmREHgoUp8##VALUE", "vG0jRQwCurV7chyPdHUrF$$tC9OtQCF04SKmREHgoUp8##CODE", "16kWokzo5FhGqV0SBgVTd$$dYsyPgrxdT0a9KzoSKErT##TARGET_CONCEPT_ID", "vG0jRQwCurV7chyPdHUrF$$tC9OtQCF04SKmREHgoUp8##DATE" ],
                "allIn0" : null,
                "whereClause" : null,
                "headAlias" : "o"
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Join",
                "projectName" : "ProphecySparkBasicsPython"
              }
            },
            "HNAHlSM-690ia1DJFnu1C$$bBPC6X_HdolgVX9t2QkZ2" : {
              "id" : "HNAHlSM-690ia1DJFnu1C$$bBPC6X_HdolgVX9t2QkZ2",
              "component" : "Source",
              "metadata" : {
                "label" : "observations",
                "slug" : "observations",
                "x" : -200,
                "y" : 2160,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ ],
                "outputs" : [ {
                  "id" : "8BQ4BLrlP6NDYO0XGG-GM$$jt-I3wFRx_gyeYZx1m68z",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "datasetId" : "datasets/l0_bronze_layer_observations"
              }
            },
            "5gThBXkKp-t5CQBrW_ST_$$Y1JHqoDpweTtY8w0zEndU" : {
              "id" : "5gThBXkKp-t5CQBrW_ST_$$Y1JHqoDpweTtY8w0zEndU",
              "component" : "Source",
              "metadata" : {
                "label" : "source_to_standard_vocab_map_1",
                "slug" : "source_to_standard_vocab_map_1",
                "x" : -200,
                "y" : 2300,
                "phase" : 0,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ ],
                "outputs" : [ {
                  "id" : "UJNbx4pA4aHC0eHI8EXIg$$X5IH9SvB_HInFoft5yGy_",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "datasetId" : "datasets/source_to_standard_vocab_map"
              }
            }
          }
        },
        "b2Hj8DzcoYFNA_Zl0yZpt$$kzavWGosUm8nKthUxoGJb" : {
          "id" : "b2Hj8DzcoYFNA_Zl0yZpt$$kzavWGosUm8nKthUxoGJb",
          "component" : "Reformat",
          "metadata" : {
            "label" : "measurement_data_by_person_id",
            "slug" : "measurement_data_by_person_id",
            "x" : 160,
            "y" : 1520,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD",
              "slug" : "Subgraph_1",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "measurement_concept_id",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "measurement_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "measurement_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "measurement_time",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "measurement_type_concept_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "operator_concept_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "value_as_number",
                  "type" : "float",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "value_as_concept_id",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "unit_concept_id",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "range_low",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "range_high",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "provider_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "visit_occurrence_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "visit_detail_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "measurement_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "measurement_source_concept_id",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "unit_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "value_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "1v-eyMoge4xIQyULlqkcV$$Zpr43uVdEs-xnbS0lNxe8",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "measurement_id",
              "expression" : {
                "format" : "sql",
                "expression" : "row_number() OVER (PARTITION BY 1 ORDER BY person_id)"
              },
              "description" : ""
            }, {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "measurement_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "measurement_concept_id"
              },
              "description" : ""
            }, {
              "target" : "measurement_date",
              "expression" : {
                "format" : "sql",
                "expression" : "measurement_date"
              },
              "description" : ""
            }, {
              "target" : "measurement_datetime",
              "expression" : {
                "format" : "sql",
                "expression" : "measurement_datetime"
              },
              "description" : ""
            }, {
              "target" : "measurement_time",
              "expression" : {
                "format" : "sql",
                "expression" : "measurement_time"
              },
              "description" : ""
            }, {
              "target" : "measurement_type_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "measurement_type_concept_id"
              },
              "description" : ""
            }, {
              "target" : "operator_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "operator_concept_id"
              },
              "description" : ""
            }, {
              "target" : "value_as_number",
              "expression" : {
                "format" : "sql",
                "expression" : "value_as_number"
              },
              "description" : ""
            }, {
              "target" : "value_as_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "value_as_concept_id"
              },
              "description" : ""
            }, {
              "target" : "unit_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "unit_concept_id"
              },
              "description" : ""
            }, {
              "target" : "range_low",
              "expression" : {
                "format" : "sql",
                "expression" : "range_low"
              },
              "description" : ""
            }, {
              "target" : "range_high",
              "expression" : {
                "format" : "sql",
                "expression" : "range_high"
              },
              "description" : ""
            }, {
              "target" : "provider_id",
              "expression" : {
                "format" : "sql",
                "expression" : "provider_id"
              },
              "description" : ""
            }, {
              "target" : "visit_occurrence_id",
              "expression" : {
                "format" : "sql",
                "expression" : "visit_occurrence_id"
              },
              "description" : ""
            }, {
              "target" : "visit_detail_id",
              "expression" : {
                "format" : "sql",
                "expression" : "visit_detail_id"
              },
              "description" : ""
            }, {
              "target" : "measurement_source_value",
              "expression" : {
                "format" : "sql",
                "expression" : "measurement_source_value"
              },
              "description" : ""
            }, {
              "target" : "measurement_source_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "measurement_source_concept_id"
              },
              "description" : ""
            }, {
              "target" : "unit_source_value",
              "expression" : {
                "format" : "sql",
                "expression" : "unit_source_value"
              },
              "description" : ""
            }, {
              "target" : "value_source_value",
              "expression" : {
                "format" : "sql",
                "expression" : "value_source_value"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD##measurement_datetime", "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD##range_high", "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD##measurement_source_value", "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD##value_source_value", "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD##range_low", "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD##unit_concept_id", "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD##value_as_number", "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD##visit_detail_id", "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD##value_as_concept_id", "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD##provider_id", "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD##visit_occurrence_id", "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD##operator_concept_id", "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD##measurement_date", "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD##measurement_concept_id", "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD##unit_source_value", "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD##measurement_type_concept_id", "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD##measurement_source_concept_id", "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD##person_id", "mb580nCud8OyKrppEO-ml$$oi469G_32KLUNmNWMIcvD##measurement_time" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "5cPFdlCCT_5aLZXRPi3i9$$Sh3W-kQEyM6hawYAMijyR" : {
          "id" : "5cPFdlCCT_5aLZXRPi3i9$$Sh3W-kQEyM6hawYAMijyR",
          "component" : "Target",
          "metadata" : {
            "label" : "measurement",
            "slug" : "measurement",
            "x" : 320,
            "y" : 1520,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Q_ICLAncct8Dvzn4umPik$$hskQt4uaYjpD6RBLWIK6G",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "measurement_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "measurement_concept_id",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "measurement_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "measurement_datetime",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "measurement_time",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "measurement_type_concept_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "operator_concept_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "value_as_number",
                  "type" : "float",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "value_as_concept_id",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "unit_concept_id",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "range_low",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "range_high",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "provider_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "visit_occurrence_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "visit_detail_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "measurement_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "measurement_source_concept_id",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "unit_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "value_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/measurement"
          }
        }
      }
    },
    "HQYHLPISNElFpy8EEYfIr$$YCPtDCZxRxkWjGQNQ28KY" : {
      "id" : "HQYHLPISNElFpy8EEYfIr$$YCPtDCZxRxkWjGQNQ28KY",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "assign_all_visit_ids_table",
        "slug" : "assign_all_visit_ids_table",
        "x" : 0,
        "y" : 620,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : { },
      "connections" : [ {
        "id" : "UTuRK_KP82WYLGuYH8Qj5$$BsbdJg2k2uUCjmnSnqGdw",
        "source" : "G5KugOzFKQ1Wx_p3t9BWm$$rwNHReFep301qgP55t2at",
        "sourcePort" : "gFKYQtBUhwDpIgo9nydxv$$hMnkNdGQX_BpMGZMAkl9_",
        "target" : "o9NBItB8OIx3YkWFcaBPd$$Ir0IfhKwGKiEzPxdxegWu",
        "targetPort" : "jce0nKEnNLGBmxJNxSAaV$$ekuhSUX3G40TcVSsSiYs_"
      }, {
        "id" : "gxKf_unhpifDnlbIYxiv9$$pHrALrouyPdP0iDUKgqjx",
        "source" : "LiLm_1h7927judhb7lohL$$iXpwT_MvJaSGdPoXoYNoZ",
        "sourcePort" : "ta9GfIIBwMGM8rrO0ehFt$$Z7DcAjTghOsi5AN543_Mq",
        "target" : "o9NBItB8OIx3YkWFcaBPd$$Ir0IfhKwGKiEzPxdxegWu",
        "targetPort" : "AvCNViTc4fd89px-RRb9K$$f5GzBoq-64xJnDdFZogRG"
      }, {
        "id" : "DHRdYTP5v5giS522L0Nw3",
        "source" : "o9NBItB8OIx3YkWFcaBPd$$Ir0IfhKwGKiEzPxdxegWu",
        "sourcePort" : "Vnod2XVkS1dy0heEC6S3x$$xkEHmtG_QqHGVOt2sOKxg",
        "target" : "I4vwBD_5gVR47xiuT8RIl$$DUgW53q7kEnftXg_EmhG5",
        "targetPort" : "dnKbIrGxJM9VP6x3z7YIg$$e5pz7aMcVUFnD9X6RiEGn"
      } ],
      "processes" : {
        "G5KugOzFKQ1Wx_p3t9BWm$$rwNHReFep301qgP55t2at" : {
          "id" : "G5KugOzFKQ1Wx_p3t9BWm$$rwNHReFep301qgP55t2at",
          "component" : "Source",
          "metadata" : {
            "label" : "all_visits_1",
            "slug" : "all_visits_1",
            "x" : -360,
            "y" : 400,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "gFKYQtBUhwDpIgo9nydxv$$hMnkNdGQX_BpMGZMAkl9_",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/all_visits"
          }
        },
        "LiLm_1h7927judhb7lohL$$iXpwT_MvJaSGdPoXoYNoZ" : {
          "id" : "LiLm_1h7927judhb7lohL$$iXpwT_MvJaSGdPoXoYNoZ",
          "component" : "Source",
          "metadata" : {
            "label" : "encounters_6",
            "slug" : "encounters_6",
            "x" : -360,
            "y" : 260,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "ta9GfIIBwMGM8rrO0ehFt$$Z7DcAjTghOsi5AN543_Mq",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/l0_bronze_layer_encounters"
          }
        },
        "I4vwBD_5gVR47xiuT8RIl$$DUgW53q7kEnftXg_EmhG5" : {
          "id" : "I4vwBD_5gVR47xiuT8RIl$$DUgW53q7kEnftXg_EmhG5",
          "component" : "Target",
          "metadata" : {
            "label" : "assign_all_visit_ids",
            "slug" : "assign_all_visit_ids",
            "x" : 100,
            "y" : 320,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "dnKbIrGxJM9VP6x3z7YIg$$e5pz7aMcVUFnD9X6RiEGn",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_source_value",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "date_service",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "date_service_end",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "encounterclass",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_TYPE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_START_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_END_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID_NEW",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_COST",
                  "type" : "double",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/assign_all_visit_ids"
          }
        },
        "o9NBItB8OIx3YkWFcaBPd$$Ir0IfhKwGKiEzPxdxegWu" : {
          "id" : "o9NBItB8OIx3YkWFcaBPd$$Ir0IfhKwGKiEzPxdxegWu",
          "component" : "Join",
          "metadata" : {
            "label" : "join_multiple_inputs",
            "slug" : "join_multiple_inputs",
            "x" : -140,
            "y" : 320,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "comment" : "Integrates patient encounter data with visit records to provide a comprehensive view of healthcare interactions, including costs associated with each visit.",
            "autoUpdateComment" : true
          },
          "ports" : {
            "inputs" : [ {
              "id" : "AvCNViTc4fd89px-RRb9K$$f5GzBoq-64xJnDdFZogRG",
              "slug" : "E",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "Id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "START",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "STOP",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PATIENT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROVIDER",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ENCOUNTERCLASS",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "COST",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "REASONCODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "REASONDESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "jce0nKEnNLGBmxJNxSAaV$$ekuhSUX3G40TcVSsSiYs_",
              "slug" : "AV",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "patient",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "encounterclass",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_START_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_END_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "visit_occurrence_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Vnod2XVkS1dy0heEC6S3x$$xkEHmtG_QqHGVOt2sOKxg",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "conditions" : [ {
              "alias" : "AV",
              "expression" : {
                "format" : "sql",
                "expression" : "AV.patient = E.PATIENT and E.START >= AV.VISIT_START_DATE and E.START <= AV.VISIT_END_DATE"
              },
              "joinType" : "inner"
            } ],
            "expressions" : [ {
              "target" : "encounter_id",
              "expression" : {
                "format" : "sql",
                "expression" : "E.Id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "person_source_value",
              "expression" : {
                "format" : "sql",
                "expression" : "E.PATIENT"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "date_service",
              "expression" : {
                "format" : "sql",
                "expression" : "E.START"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "date_service_end",
              "expression" : {
                "format" : "sql",
                "expression" : "E.STOP"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "encounterclass",
              "expression" : {
                "format" : "sql",
                "expression" : "E.ENCOUNTERCLASS"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "VISIT_TYPE",
              "expression" : {
                "format" : "sql",
                "expression" : "AV.encounterclass"
              },
              "description" : "",
              "_row_id" : "c_330"
            }, {
              "target" : "VISIT_START_DATE",
              "expression" : {
                "format" : "sql",
                "expression" : "AV.VISIT_START_DATE"
              },
              "description" : "",
              "_row_id" : "c_331"
            }, {
              "target" : "VISIT_END_DATE",
              "expression" : {
                "format" : "sql",
                "expression" : "AV.VISIT_END_DATE"
              },
              "description" : "",
              "_row_id" : "c_332"
            }, {
              "target" : "VISIT_OCCURRENCE_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "AV.visit_occurrence_id"
              },
              "description" : "",
              "_row_id" : "c_333"
            }, {
              "target" : "VISIT_OCCURRENCE_ID_NEW",
              "expression" : {
                "format" : "sql",
                "expression" : "CASE\n    WHEN E.ENCOUNTERCLASS = 'inpatient' AND AV.encounterclass = 'inpatient' THEN AV.visit_occurrence_id\n    WHEN E.ENCOUNTERCLASS in ('emergency', 'urgent') THEN\n    (\n        CASE\n            WHEN AV.encounterclass = 'inpatient' AND E.START > AV.VISIT_START_DATE THEN AV.visit_occurrence_id\n            WHEN AV.encounterclass in ('emergency', 'urgent') AND E.START = AV.VISIT_START_DATE THEN AV.visit_occurrence_id\n            ELSE NULL\n        END\n    )\n    WHEN E.ENCOUNTERCLASS in ('ambulatory', 'wellness', 'outpatient') THEN\n    (\n        CASE\n            WHEN AV.encounterclass = 'inpatient' AND E.START >= AV.VISIT_START_DATE THEN AV.visit_occurrence_id\n            WHEN AV.encounterclass in ('ambulatory', 'wellness', 'outpatient') THEN AV.visit_occurrence_id\n            ELSE NULL\n        END\n    )\n    ELSE NULL\nEND"
              },
              "description" : "",
              "_row_id" : "c_334"
            }, {
              "target" : "VISIT_OCCURRENCE_COST",
              "expression" : {
                "format" : "sql",
                "expression" : "CAST(100 AS DOUBLE)"
              },
              "description" : "",
              "_row_id" : "c_175"
            } ],
            "hints" : [ {
              "id" : "AvCNViTc4fd89px-RRb9K$$f5GzBoq-64xJnDdFZogRG",
              "alias" : "E",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "jce0nKEnNLGBmxJNxSAaV$$ekuhSUX3G40TcVSsSiYs_",
              "alias" : "AV",
              "hintType" : "none",
              "propagateColumns" : false
            } ],
            "allIn1" : null,
            "activeTab" : "expressions",
            "columnsSelector" : [ "AvCNViTc4fd89px-RRb9K$$f5GzBoq-64xJnDdFZogRG##PATIENT", "jce0nKEnNLGBmxJNxSAaV$$ekuhSUX3G40TcVSsSiYs_##patient", "AvCNViTc4fd89px-RRb9K$$f5GzBoq-64xJnDdFZogRG##START", "jce0nKEnNLGBmxJNxSAaV$$ekuhSUX3G40TcVSsSiYs_##VISIT_START_DATE", "jce0nKEnNLGBmxJNxSAaV$$ekuhSUX3G40TcVSsSiYs_##VISIT_END_DATE", "AvCNViTc4fd89px-RRb9K$$f5GzBoq-64xJnDdFZogRG##Id", "AvCNViTc4fd89px-RRb9K$$f5GzBoq-64xJnDdFZogRG##PATIENT", "jce0nKEnNLGBmxJNxSAaV$$ekuhSUX3G40TcVSsSiYs_##encounterclass", "AvCNViTc4fd89px-RRb9K$$f5GzBoq-64xJnDdFZogRG##STOP", "jce0nKEnNLGBmxJNxSAaV$$ekuhSUX3G40TcVSsSiYs_##VISIT_START_DATE", "AvCNViTc4fd89px-RRb9K$$f5GzBoq-64xJnDdFZogRG##START", "jce0nKEnNLGBmxJNxSAaV$$ekuhSUX3G40TcVSsSiYs_##visit_occurrence_id", "jce0nKEnNLGBmxJNxSAaV$$ekuhSUX3G40TcVSsSiYs_##VISIT_END_DATE", "AvCNViTc4fd89px-RRb9K$$f5GzBoq-64xJnDdFZogRG##ENCOUNTERCLASS" ],
            "allIn0" : null,
            "whereClause" : null,
            "headAlias" : "E"
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Join",
            "projectName" : "ProphecySparkBasicsPython"
          }
        }
      }
    },
    "wy_o2ITT4PQgwdcXhE0D9$$7VHyB3e2hfaz-mwB3oJot" : {
      "id" : "wy_o2ITT4PQgwdcXhE0D9$$7VHyB3e2hfaz-mwB3oJot",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "visit_occurrence_insert",
        "slug" : "visit_occurrence_insert",
        "x" : 0,
        "y" : 1100,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : { },
      "connections" : [ {
        "id" : "peVNcIPtQ5zb0fsPKNXVu$$BmBxJ0yBRVvzKDmWU4s5B",
        "source" : "vI8KxsEFyWzeQu_j9YyZv$$_02k4woDsVLSiq-Q-ANNu",
        "sourcePort" : "kszsVFC7PYf3MWHfbmahK$$RsrXI7tF9I6vxCVABaddW",
        "target" : "3D1MlFgdn3txc3Mhzh3pe$$0atBXqlcJwNr0mfdccuiz",
        "targetPort" : "b22HvqK-JbNL9Xy0Eun6D$$WWID4lUMJQMA0A-UvLwvn"
      }, {
        "id" : "kiSL62JgauMYZojm0n65c",
        "source" : "quMj5b_sJPofBraudBhK_$$FuTgo47uTs55XKsbNofD8",
        "sourcePort" : "fQuT6nCAAB38ytjtn8Ln8$$8a1pJG11thHyogzcX7m4G",
        "target" : "xL3awpulymoCZwtRjnqpW$$M9lx1vLFv16eh1r9NqnaI",
        "targetPort" : "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU"
      }, {
        "id" : "l9wiqs-W8GJnSgTScc_5J",
        "source" : "3D1MlFgdn3txc3Mhzh3pe$$0atBXqlcJwNr0mfdccuiz",
        "sourcePort" : "l2HwZ_vtfLvoqPd1CBAsL$$B9Gal5G0n5Dp-hhB9ABPY",
        "target" : "xL3awpulymoCZwtRjnqpW$$M9lx1vLFv16eh1r9NqnaI",
        "targetPort" : "z3o2qqQQjxvCmPcGYPwG4$$jBRG9ZpNMU1KB8RUd3gxa"
      }, {
        "id" : "vJ4Hctw5ViJRUZ49rRadk",
        "source" : "PeVLM5LPPm0F4NjYYXy7L$$il-esfRsF_GcRfvnkFIpx",
        "sourcePort" : "4W6gBZoLE73k53UASFkRb$$LB3ObAgL_Mg-7H1LIg3Vc",
        "target" : "xL3awpulymoCZwtRjnqpW$$M9lx1vLFv16eh1r9NqnaI",
        "targetPort" : "J93wRUg425iqNM3wE2vVf$$96uDKI7KLVEpkcceRzW85"
      }, {
        "id" : "CTPLUTmSOiZ9YRbTCCLm0$$ZOJoPU-XpU5GJWT3Z_fsO",
        "source" : "xL3awpulymoCZwtRjnqpW$$M9lx1vLFv16eh1r9NqnaI",
        "sourcePort" : "2UvzfOUHEDjA2Qpwr1Lnv$$0HipmpZn_gI41ru6Ws0Dl",
        "target" : "w7avDFtPkvpCB2MbLIHOt$$-vGEIOPrw7Xn_716MTQJe",
        "targetPort" : "HsLOAJPQcgPh0lJzOBSSb$$eexl4H3DRHGchuzppGCe0"
      }, {
        "id" : "DIbOZyrLDzW6JNBEW83uW$$WeBNxCugprzE-d1rXjKcN",
        "source" : "w7avDFtPkvpCB2MbLIHOt$$-vGEIOPrw7Xn_716MTQJe",
        "sourcePort" : "E23tPY8ZtRVYYiPM-oOfO$$Hyk0XxWr_QDkCnSa2-iI8",
        "target" : "4u9oXEvBs-giEnS6MnuX2$$gnqJI7NFuJO-52HILFZF2",
        "targetPort" : "KOlk_dI49eaxK47w8FacE$$zCy8pA90vW-bivxQ5gamp"
      } ],
      "processes" : {
        "4u9oXEvBs-giEnS6MnuX2$$gnqJI7NFuJO-52HILFZF2" : {
          "id" : "4u9oXEvBs-giEnS6MnuX2$$gnqJI7NFuJO-52HILFZF2",
          "component" : "Target",
          "metadata" : {
            "label" : "visit_occurence",
            "slug" : "visit_occurence",
            "x" : 600,
            "y" : 1320,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "KOlk_dI49eaxK47w8FacE$$zCy8pA90vW-bivxQ5gamp",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "VISIT_OCCURRENCE_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_START_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_START_DATETIME",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_END_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_END_DATETIME",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_TYPE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROVIDER_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CARE_SITE_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ADMITTING_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ADMITTING_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DISCHARGE_TO_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DISCHARGE_TO_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PRECEDING_VISIT_OCCURRENCE_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/visit_occurence"
          }
        },
        "vI8KxsEFyWzeQu_j9YyZv$$_02k4woDsVLSiq-Q-ANNu" : {
          "id" : "vI8KxsEFyWzeQu_j9YyZv$$_02k4woDsVLSiq-Q-ANNu",
          "component" : "Source",
          "metadata" : {
            "label" : "final_visit_ids_1",
            "slug" : "final_visit_ids_1",
            "x" : -200,
            "y" : 1320,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "kszsVFC7PYf3MWHfbmahK$$RsrXI7tF9I6vxCVABaddW",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/final_visit_ids"
          }
        },
        "w7avDFtPkvpCB2MbLIHOt$$-vGEIOPrw7Xn_716MTQJe" : {
          "id" : "w7avDFtPkvpCB2MbLIHOt$$-vGEIOPrw7Xn_716MTQJe",
          "component" : "Reformat",
          "metadata" : {
            "label" : "visits_projection",
            "slug" : "visits_projection",
            "x" : 400,
            "y" : 1320,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "HsLOAJPQcgPh0lJzOBSSb$$eexl4H3DRHGchuzppGCe0",
              "slug" : "join_multiple_dataframes",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "patient",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "encounterclass",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_START_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_END_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "visit_occurrence_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID_NEW",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "gender_concept_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "YEAR_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "MONTH_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DAY_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "BIRTH_DATETIME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "LOCATION_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROVIDER_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CARE_SITE_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PERSON_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "E23tPY8ZtRVYYiPM-oOfO$$Hyk0XxWr_QDkCnSa2-iI8",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "VISIT_OCCURRENCE_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "visit_occurrence_id"
              },
              "description" : ""
            }, {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "person_id"
              },
              "description" : ""
            }, {
              "target" : "VISIT_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "CASE lower(encounterclass)\n    WHEN 'ambulatory' THEN 9202\n    WHEN 'emergency' THEN 9203\n    WHEN 'inpatient' THEN 9201\n    WHEN 'wellness' THEN 9202\n    WHEN 'urgentcare' THEN 9203\n    WHEN 'outpatient' THEN 9202\n    ELSE 0\nEND"
              },
              "description" : ""
            }, {
              "target" : "VISIT_START_DATE",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(VISIT_START_DATE as date)"
              },
              "description" : ""
            }, {
              "target" : "VISIT_START_DATETIME",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(VISIT_START_DATE as timestamp)"
              },
              "description" : ""
            }, {
              "target" : "VISIT_END_DATE",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(VISIT_END_DATE as date)"
              },
              "description" : ""
            }, {
              "target" : "VISIT_END_DATETIME",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(VISIT_END_DATE as timestamp)"
              },
              "description" : ""
            }, {
              "target" : "VISIT_TYPE_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "44818517"
              },
              "description" : ""
            }, {
              "target" : "PROVIDER_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "target" : "CARE_SITE_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(null as integer)"
              },
              "description" : ""
            }, {
              "target" : "VISIT_SOURCE_VALUE",
              "expression" : {
                "format" : "sql",
                "expression" : "encounter_id"
              },
              "description" : ""
            }, {
              "target" : "VISIT_SOURCE_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "target" : "ADMITTING_SOURCE_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "target" : "ADMITTING_SOURCE_VALUE",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(null as string)"
              },
              "description" : ""
            }, {
              "target" : "DISCHARGE_TO_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "target" : "DISCHARGE_TO_SOURCE_VALUE",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(null as string)"
              },
              "description" : ""
            }, {
              "target" : "PRECEDING_VISIT_OCCURRENCE_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "lag(visit_occurrence_id) over (partition by person_id order by VISIT_START_DATE)"
              },
              "description" : ""
            } ],
            "importString" : "",
            "activeTab" : "expressions",
            "columnsSelector" : [ "HsLOAJPQcgPh0lJzOBSSb$$eexl4H3DRHGchuzppGCe0##encounter_id", "HsLOAJPQcgPh0lJzOBSSb$$eexl4H3DRHGchuzppGCe0##VISIT_START_DATE", "HsLOAJPQcgPh0lJzOBSSb$$eexl4H3DRHGchuzppGCe0##person_id", "HsLOAJPQcgPh0lJzOBSSb$$eexl4H3DRHGchuzppGCe0##VISIT_END_DATE", "HsLOAJPQcgPh0lJzOBSSb$$eexl4H3DRHGchuzppGCe0##encounterclass", "HsLOAJPQcgPh0lJzOBSSb$$eexl4H3DRHGchuzppGCe0##visit_occurrence_id" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "PeVLM5LPPm0F4NjYYXy7L$$il-esfRsF_GcRfvnkFIpx" : {
          "id" : "PeVLM5LPPm0F4NjYYXy7L$$il-esfRsF_GcRfvnkFIpx",
          "component" : "Source",
          "metadata" : {
            "label" : "all_visits_2",
            "slug" : "all_visits_2",
            "x" : 0,
            "y" : 1120,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "4W6gBZoLE73k53UASFkRb$$LB3ObAgL_Mg-7H1LIg3Vc",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/all_visits"
          }
        },
        "3D1MlFgdn3txc3Mhzh3pe$$0atBXqlcJwNr0mfdccuiz" : {
          "id" : "3D1MlFgdn3txc3Mhzh3pe$$0atBXqlcJwNr0mfdccuiz",
          "component" : "Deduplicate",
          "metadata" : {
            "label" : "by_visit_occurrence_id_new",
            "slug" : "by_visit_occurrence_id_new",
            "x" : 0,
            "y" : 1320,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "b22HvqK-JbNL9Xy0Eun6D$$WWID4lUMJQMA0A-UvLwvn",
              "slug" : "final_visit_ids_1",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID_NEW",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "l2HwZ_vtfLvoqPd1CBAsL$$B9Gal5G0n5Dp-hhB9ABPY",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "dedupColumns" : [ {
              "colName" : "VISIT_OCCURRENCE_ID_NEW"
            } ],
            "dedupType" : "any",
            "columnsSelector" : [ "b22HvqK-JbNL9Xy0Eun6D$$WWID4lUMJQMA0A-UvLwvn##VISIT_OCCURRENCE_ID_NEW" ],
            "orders" : [ ],
            "useOrderBy" : false
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Deduplicate",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "xL3awpulymoCZwtRjnqpW$$M9lx1vLFv16eh1r9NqnaI" : {
          "id" : "xL3awpulymoCZwtRjnqpW$$M9lx1vLFv16eh1r9NqnaI",
          "component" : "Join",
          "metadata" : {
            "label" : "join_multiple_dataframes",
            "slug" : "join_multiple_dataframes",
            "x" : 200,
            "y" : 1320,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "J93wRUg425iqNM3wE2vVf$$96uDKI7KLVEpkcceRzW85",
              "slug" : "av",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "patient",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "encounterclass",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_START_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_END_DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "visit_occurrence_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "z3o2qqQQjxvCmPcGYPwG4$$jBRG9ZpNMU1KB8RUd3gxa",
              "slug" : "fv",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID_NEW",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU",
              "slug" : "p",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "gender_concept_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "YEAR_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "MONTH_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DAY_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "BIRTH_DATETIME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "LOCATION_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROVIDER_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CARE_SITE_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PERSON_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "2UvzfOUHEDjA2Qpwr1Lnv$$0HipmpZn_gI41ru6Ws0Dl",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "conditions" : [ {
              "alias" : "fv",
              "expression" : {
                "format" : "sql",
                "expression" : "av.visit_occurrence_id = fv.VISIT_OCCURRENCE_ID_NEW"
              },
              "joinType" : "inner"
            }, {
              "alias" : "p",
              "expression" : {
                "format" : "sql",
                "expression" : "p.PERSON_SOURCE_VALUE = av.patient"
              },
              "joinType" : "inner"
            } ],
            "expressions" : [ {
              "target" : "encounter_id",
              "expression" : {
                "format" : "sql",
                "expression" : "av.encounter_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "patient",
              "expression" : {
                "format" : "sql",
                "expression" : "av.patient"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "encounterclass",
              "expression" : {
                "format" : "sql",
                "expression" : "av.encounterclass"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "VISIT_START_DATE",
              "expression" : {
                "format" : "sql",
                "expression" : "av.VISIT_START_DATE"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "VISIT_END_DATE",
              "expression" : {
                "format" : "sql",
                "expression" : "av.VISIT_END_DATE"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "visit_occurrence_id",
              "expression" : {
                "format" : "sql",
                "expression" : "av.visit_occurrence_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "VISIT_OCCURRENCE_ID_NEW",
              "expression" : {
                "format" : "sql",
                "expression" : "fv.VISIT_OCCURRENCE_ID_NEW"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "p.person_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "gender_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "p.gender_concept_id"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "YEAR_OF_BIRTH",
              "expression" : {
                "format" : "sql",
                "expression" : "p.YEAR_OF_BIRTH"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "MONTH_OF_BIRTH",
              "expression" : {
                "format" : "sql",
                "expression" : "p.MONTH_OF_BIRTH"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "DAY_OF_BIRTH",
              "expression" : {
                "format" : "sql",
                "expression" : "p.DAY_OF_BIRTH"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "BIRTH_DATETIME",
              "expression" : {
                "format" : "sql",
                "expression" : "p.BIRTH_DATETIME"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "RACE_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "p.RACE_CONCEPT_ID"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "ETHNICITY_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "p.ETHNICITY_CONCEPT_ID"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "LOCATION_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "p.LOCATION_ID"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "PROVIDER_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "p.PROVIDER_ID"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "CARE_SITE_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "p.CARE_SITE_ID"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "PERSON_SOURCE_VALUE",
              "expression" : {
                "format" : "sql",
                "expression" : "p.PERSON_SOURCE_VALUE"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "GENDER_SOURCE_VALUE",
              "expression" : {
                "format" : "sql",
                "expression" : "p.GENDER_SOURCE_VALUE"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "GENDER_SOURCE_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "p.GENDER_SOURCE_CONCEPT_ID"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "RACE_SOURCE_VALUE",
              "expression" : {
                "format" : "sql",
                "expression" : "p.RACE_SOURCE_VALUE"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "RACE_SOURCE_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "p.RACE_SOURCE_CONCEPT_ID"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "ETHNICITY_SOURCE_VALUE",
              "expression" : {
                "format" : "sql",
                "expression" : "p.ETHNICITY_SOURCE_VALUE"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "ETHNICITY_SOURCE_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "p.ETHNICITY_SOURCE_CONCEPT_ID"
              },
              "description" : "",
              "_row_id" : null
            } ],
            "hints" : [ {
              "id" : "J93wRUg425iqNM3wE2vVf$$96uDKI7KLVEpkcceRzW85",
              "alias" : "av",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "z3o2qqQQjxvCmPcGYPwG4$$jBRG9ZpNMU1KB8RUd3gxa",
              "alias" : "fv",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU",
              "alias" : "p",
              "hintType" : "none",
              "propagateColumns" : false
            } ],
            "allIn1" : null,
            "activeTab" : "expressions",
            "columnsSelector" : [ "J93wRUg425iqNM3wE2vVf$$96uDKI7KLVEpkcceRzW85##visit_occurrence_id", "z3o2qqQQjxvCmPcGYPwG4$$jBRG9ZpNMU1KB8RUd3gxa##VISIT_OCCURRENCE_ID_NEW", "J93wRUg425iqNM3wE2vVf$$96uDKI7KLVEpkcceRzW85##patient", "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU##PERSON_SOURCE_VALUE", "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU##GENDER_SOURCE_VALUE", "J93wRUg425iqNM3wE2vVf$$96uDKI7KLVEpkcceRzW85##VISIT_END_DATE", "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU##RACE_SOURCE_CONCEPT_ID", "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU##CARE_SITE_ID", "J93wRUg425iqNM3wE2vVf$$96uDKI7KLVEpkcceRzW85##encounter_id", "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU##GENDER_SOURCE_CONCEPT_ID", "J93wRUg425iqNM3wE2vVf$$96uDKI7KLVEpkcceRzW85##encounterclass", "z3o2qqQQjxvCmPcGYPwG4$$jBRG9ZpNMU1KB8RUd3gxa##VISIT_OCCURRENCE_ID_NEW", "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU##MONTH_OF_BIRTH", "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU##DAY_OF_BIRTH", "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU##ETHNICITY_SOURCE_VALUE", "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU##RACE_SOURCE_VALUE", "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU##person_id", "J93wRUg425iqNM3wE2vVf$$96uDKI7KLVEpkcceRzW85##visit_occurrence_id", "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU##LOCATION_ID", "J93wRUg425iqNM3wE2vVf$$96uDKI7KLVEpkcceRzW85##patient", "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU##BIRTH_DATETIME", "J93wRUg425iqNM3wE2vVf$$96uDKI7KLVEpkcceRzW85##VISIT_START_DATE", "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU##gender_concept_id", "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU##PROVIDER_ID", "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU##RACE_CONCEPT_ID", "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU##ETHNICITY_SOURCE_CONCEPT_ID", "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU##YEAR_OF_BIRTH", "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU##ETHNICITY_CONCEPT_ID", "QzjZ6pS406DRDEadJ8FOb$$rMG6xAZliJGiq_AJwzANU##PERSON_SOURCE_VALUE" ],
            "allIn0" : null,
            "whereClause" : null,
            "headAlias" : "av"
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Join",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "quMj5b_sJPofBraudBhK_$$FuTgo47uTs55XKsbNofD8" : {
          "id" : "quMj5b_sJPofBraudBhK_$$FuTgo47uTs55XKsbNofD8",
          "component" : "Source",
          "metadata" : {
            "label" : "person_2",
            "slug" : "person_2",
            "x" : 0,
            "y" : 1520,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "fQuT6nCAAB38ytjtn8Ln8$$8a1pJG11thHyogzcX7m4G",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/person"
          }
        }
      }
    },
    "4rvs3Yn5C5LwFDVnP6ILT$$k7Bxv6vvr0DMKBIsL3dTU" : {
      "id" : "4rvs3Yn5C5LwFDVnP6ILT$$k7Bxv6vvr0DMKBIsL3dTU",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "person_insert",
        "slug" : "person_insert",
        "x" : 0,
        "y" : 780,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : { },
      "connections" : [ {
        "id" : "5oaKnhtO8VNANvBtk5uhw$$WspY5Bb1oj5aulN6gBNaO",
        "source" : "AtRZHOgceaTA7IZDXLkWv$$zHAi-jomhvP7YJyidHarZ",
        "sourcePort" : "Bl5Gb7KfD6y8BSrpXkHYD$$Qg8DzG5a7txTg2120Yd9o",
        "target" : "2p3BPPwOjvNXsF0hemtgC$$iu81x-U8hnPVcw2D4avxi",
        "targetPort" : "AHDQDMs64XQzavHpsDjVM$$WRLYOms-cFiNCzSrTQvMt"
      }, {
        "id" : "bGEUVIlG8cUXJcLy-o9kc$$etIxLR-h7xmCWb5mvMy_Y",
        "source" : "2p3BPPwOjvNXsF0hemtgC$$iu81x-U8hnPVcw2D4avxi",
        "sourcePort" : "z30FRzm0VIk3ZHNYFZDL3$$hdX3NX2kB2hwZjv98mTkn",
        "target" : "hsUHFVJGXGkXerJ8sMdsB$$ZqVkbaOJTK8WxSfRbX1Qr",
        "targetPort" : "mgP-0FAkLRmj9noYxrCFM$$LJC7sR1URsOQFQ8OO7Ui-"
      }, {
        "id" : "mIaxSmSjrTOtgHkZa6kWt$$z19Ct8MDu4M4AdEUIT3gB",
        "source" : "hsUHFVJGXGkXerJ8sMdsB$$ZqVkbaOJTK8WxSfRbX1Qr",
        "sourcePort" : "cz5pel587uHpg2WQDbmDL$$LiwsG8hWHT_SzFawvdTf9",
        "target" : "8vmET165TNW5AaFHl7X0w$$vNUCTev7v8uWYyhfX0_L-",
        "targetPort" : "5ugm8c_5H2b_jvmWYJOkC$$mwgzqMWGPL3lYty3aUQuH"
      } ],
      "processes" : {
        "AtRZHOgceaTA7IZDXLkWv$$zHAi-jomhvP7YJyidHarZ" : {
          "id" : "AtRZHOgceaTA7IZDXLkWv$$zHAi-jomhvP7YJyidHarZ",
          "component" : "Source",
          "metadata" : {
            "label" : "patients",
            "slug" : "patients",
            "x" : -360,
            "y" : 480,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "Bl5Gb7KfD6y8BSrpXkHYD$$Qg8DzG5a7txTg2120Yd9o",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/l0_bronze_layer_patients"
          }
        },
        "hsUHFVJGXGkXerJ8sMdsB$$ZqVkbaOJTK8WxSfRbX1Qr" : {
          "id" : "hsUHFVJGXGkXerJ8sMdsB$$ZqVkbaOJTK8WxSfRbX1Qr",
          "component" : "Reformat",
          "metadata" : {
            "label" : "reformat_data",
            "slug" : "reformat_data",
            "x" : -40,
            "y" : 480,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "mgP-0FAkLRmj9noYxrCFM$$LJC7sR1URsOQFQ8OO7Ui-",
              "slug" : "filter_gender_not_null",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "Id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "BIRTHDATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DEATHDATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SSN",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DRIVERS",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PASSPORT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PREFIX",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "FIRST",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "LAST",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SUFFIX",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "MAIDEN",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "MARITAL",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "BIRTHPLACE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ADDRESS",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CITY",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "STATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ZIP",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "cz5pel587uHpg2WQDbmDL$$LiwsG8hWHT_SzFawvdTf9",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
            "expressions" : [ {
              "target" : "person_id",
              "expression" : {
                "format" : "sql",
                "expression" : "row_number() OVER (\n  PARTITION BY\n    1\n  ORDER BY\n    Id\n)"
              },
              "description" : ""
            }, {
              "target" : "gender_concept_id",
              "expression" : {
                "format" : "sql",
                "expression" : "CASE upper(GENDER) \n  WHEN 'M' THEN 8507\n  WHEN 'F' THEN 8532\nEND"
              },
              "description" : ""
            }, {
              "target" : "YEAR_OF_BIRTH",
              "expression" : {
                "format" : "sql",
                "expression" : "year(BIRTHDATE)"
              },
              "description" : ""
            }, {
              "target" : "MONTH_OF_BIRTH",
              "expression" : {
                "format" : "sql",
                "expression" : "month(BIRTHDATE)"
              },
              "description" : ""
            }, {
              "target" : "DAY_OF_BIRTH",
              "expression" : {
                "format" : "sql",
                "expression" : "day(BIRTHDATE)"
              },
              "description" : ""
            }, {
              "target" : "BIRTH_DATETIME",
              "expression" : {
                "format" : "sql",
                "expression" : "BIRTHDATE"
              },
              "description" : ""
            }, {
              "target" : "RACE_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "CASE upper(RACE)\n    when 'WHITE' then 8527\n    when 'BLACK' then 8516\n    when 'ASIAN' then 8515\n    else 0\nEND"
              },
              "description" : ""
            }, {
              "target" : "ETHNICITY_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "CASE\n    WHEN upper(RACE) = 'HISPANIC' then 38003563\n    else 0\nEND"
              },
              "description" : ""
            }, {
              "target" : "LOCATION_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(NULL as integer)"
              },
              "description" : ""
            }, {
              "target" : "PROVIDER_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "target" : "CARE_SITE_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(NULL as integer)"
              },
              "description" : ""
            }, {
              "target" : "PERSON_SOURCE_VALUE",
              "expression" : {
                "format" : "sql",
                "expression" : "Id"
              },
              "description" : ""
            }, {
              "target" : "GENDER_SOURCE_VALUE",
              "expression" : {
                "format" : "sql",
                "expression" : "GENDER"
              },
              "description" : ""
            }, {
              "target" : "GENDER_SOURCE_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "target" : "RACE_SOURCE_VALUE",
              "expression" : {
                "format" : "sql",
                "expression" : "RACE"
              },
              "description" : ""
            }, {
              "target" : "RACE_SOURCE_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "target" : "ETHNICITY_SOURCE_VALUE",
              "expression" : {
                "format" : "sql",
                "expression" : "ETHNICITY"
              },
              "description" : ""
            }, {
              "target" : "ETHNICITY_SOURCE_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            } ],
            "importString" : "person_id,``row_number() OVER (\n  PARTITION BY\n    Id\n  ORDER BY\n    Id\n)``\ngender_concept_id,``CASE upper(GENDER) \n  WHEN 'M' THEN 8507\n  WHEN 'F' THEN 8532\nEND``\nYEAR_OF_BIRTH,year(BIRTHDATE)\nMONTH_OF_BIRTH,month(BIRTHDATE)\nDAY_OF_BIRTH,day(BIRTHDATE)\nBIRTH_DATETIME,BIRTHDATE\nRACE_CONCEPT_ID,``CASE upper(RACE)\n    when 'WHITE' then 8527\n    when 'BLACK' then 8516\n    when 'ASIAN' then 8515\n    else 0\nEND``\nETHNICITY_CONCEPT_ID,``CASE\n    WHEN upper(RACE) = 'HISPANIC' then 38003563\n    else 0\nEND``",
            "activeTab" : "expressions",
            "columnsSelector" : [ "mgP-0FAkLRmj9noYxrCFM$$LJC7sR1URsOQFQ8OO7Ui-##BIRTHDATE", "mgP-0FAkLRmj9noYxrCFM$$LJC7sR1URsOQFQ8OO7Ui-##RACE", "mgP-0FAkLRmj9noYxrCFM$$LJC7sR1URsOQFQ8OO7Ui-##ETHNICITY", "mgP-0FAkLRmj9noYxrCFM$$LJC7sR1URsOQFQ8OO7Ui-##Id", "mgP-0FAkLRmj9noYxrCFM$$LJC7sR1URsOQFQ8OO7Ui-##GENDER" ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "2p3BPPwOjvNXsF0hemtgC$$iu81x-U8hnPVcw2D4avxi" : {
          "id" : "2p3BPPwOjvNXsF0hemtgC$$iu81x-U8hnPVcw2D4avxi",
          "component" : "Filter",
          "metadata" : {
            "label" : "filter_gender_not_null",
            "slug" : "filter_gender_not_null",
            "x" : -200,
            "y" : 480,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "AHDQDMs64XQzavHpsDjVM$$WRLYOms-cFiNCzSrTQvMt",
              "slug" : "patients",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "Id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "BIRTHDATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DEATHDATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SSN",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DRIVERS",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PASSPORT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PREFIX",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "FIRST",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "LAST",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SUFFIX",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "MAIDEN",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "MARITAL",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "BIRTHPLACE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ADDRESS",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CITY",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "STATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ZIP",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "z30FRzm0VIk3ZHNYFZDL3$$hdX3NX2kB2hwZjv98mTkn",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ "AHDQDMs64XQzavHpsDjVM$$WRLYOms-cFiNCzSrTQvMt##GENDER" ],
            "condition" : {
              "format" : "sql",
              "expression" : "GENDER is not null"
            }
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Filter",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "8vmET165TNW5AaFHl7X0w$$vNUCTev7v8uWYyhfX0_L-" : {
          "id" : "8vmET165TNW5AaFHl7X0w$$vNUCTev7v8uWYyhfX0_L-",
          "component" : "Target",
          "metadata" : {
            "label" : "person",
            "slug" : "person",
            "x" : 160,
            "y" : 480,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "5ugm8c_5H2b_jvmWYJOkC$$mwgzqMWGPL3lYty3aUQuH",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "gender_concept_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "YEAR_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "MONTH_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DAY_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "BIRTH_DATETIME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "LOCATION_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROVIDER_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CARE_SITE_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PERSON_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/person"
          }
        }
      }
    },
    "c4VEHV00YWQev0JqIZOqO$$Q7EfditgGY3vChlcoSrG6" : {
      "id" : "c4VEHV00YWQev0JqIZOqO$$Q7EfditgGY3vChlcoSrG6",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "procedure_occurrence_insert",
        "slug" : "procedure_occurrence_insert",
        "x" : 0,
        "y" : 1580,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : { },
      "connections" : [ {
        "id" : "W68nsEXh9LXlaDHj3eawn",
        "source" : "e4kjOeMKQpTDWg6gq2lVp$$ZpTWgbiwGq3Yro3DiTS3g",
        "sourcePort" : "s4CniTeGJLdCrbzjIwsiG$$BAWleUra_gD8ZSb6hobew",
        "target" : "uAsTstRnV2NIIK6ww2_0m$$5pODT53kr7imbHVoL0Dqs",
        "targetPort" : "HGK9eDi5lR64IPFIHf-9C$$KLs3dfIuamCB0BRer6NGD"
      }, {
        "id" : "SGKaSwEAsVzdX-pN4X-pc",
        "source" : "XgV_zuzT_Oyu7OT4sZDQe$$RSO1wCcsDy-gUFWFTpQtH",
        "sourcePort" : "AQbVOTo8KHX9ReWlRQQtH$$28VDKhemJ8bDrcrdh5JYT",
        "target" : "uAsTstRnV2NIIK6ww2_0m$$5pODT53kr7imbHVoL0Dqs",
        "targetPort" : "r64WzFV2gxzb6E9x_8GvE$$3k1wzZYumle2o-ptbnNth"
      }, {
        "id" : "cVNhYEPgAkNNj50Oo-ADa",
        "source" : "9pFet-WRlWkm1Upn1rKhP$$zA1VKBkLDX2Flv_TC3cx4",
        "sourcePort" : "JzHbQTNvAOt3V3zvYHTsd$$iwZ5Fag9Nn7SzFEfyPcQR",
        "target" : "uAsTstRnV2NIIK6ww2_0m$$5pODT53kr7imbHVoL0Dqs",
        "targetPort" : "hV344T4n936UgcbA5Bk1B$$-6kOzaDINcFZrh3wVutiP"
      }, {
        "id" : "PVtb_9d9dKV8qDB9mlWw4",
        "source" : "yjCie8elAQuan1r-jRbm0$$y0APlh2-XTFOkaEFKMfVl",
        "sourcePort" : "uW_JO62di6J1HAm_zXgMh$$73PL8Y01eVNY1hEtrdNOl",
        "target" : "uAsTstRnV2NIIK6ww2_0m$$5pODT53kr7imbHVoL0Dqs",
        "targetPort" : "m_Xv-1Y45q-jev6daFObl$$29T1d0Si5xsQTSoiWIP9-"
      }, {
        "id" : "84Ofjlo-t3Nz9tYwCuxW9",
        "source" : "m3kSi7CyYmdR9FYPn8rNA$$H9mE2O4AmTHqtG8DR3ZNF",
        "sourcePort" : "LZM4YYluxFr8OyTvQowYW$$W2IkkrhTLdQM1CDeaKRss",
        "target" : "uAsTstRnV2NIIK6ww2_0m$$5pODT53kr7imbHVoL0Dqs",
        "targetPort" : "_lm1wFM1pklotIYq0-G_b$$TkeZVsMqCCWJCQIamc-w4"
      }, {
        "id" : "G33ybDtyKjQ-5rsnPViyF$$Ii77QdtL6S9vPABuzwrR1",
        "source" : "uAsTstRnV2NIIK6ww2_0m$$5pODT53kr7imbHVoL0Dqs",
        "sourcePort" : "zte_C6W7FRQ6XynO8S_I-$$QrIFmtx0T8gKsy92uRiZF",
        "target" : "Ml66k8izucSxRp8UZazf9$$Uy2DY2ZI1d1oSbokZQIUQ",
        "targetPort" : "ScC26xX1mvdtWXkBrvKl6$$xGnApjVGwXh-VDAXTCzSk"
      } ],
      "processes" : {
        "m3kSi7CyYmdR9FYPn8rNA$$H9mE2O4AmTHqtG8DR3ZNF" : {
          "id" : "m3kSi7CyYmdR9FYPn8rNA$$H9mE2O4AmTHqtG8DR3ZNF",
          "component" : "Source",
          "metadata" : {
            "label" : "person_5",
            "slug" : "person_5",
            "x" : 0,
            "y" : 2180,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "LZM4YYluxFr8OyTvQowYW$$W2IkkrhTLdQM1CDeaKRss",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/person"
          }
        },
        "uAsTstRnV2NIIK6ww2_0m$$5pODT53kr7imbHVoL0Dqs" : {
          "id" : "uAsTstRnV2NIIK6ww2_0m$$5pODT53kr7imbHVoL0Dqs",
          "component" : "Join",
          "metadata" : {
            "label" : "join_with_multiple_inputs",
            "slug" : "join_with_multiple_inputs",
            "x" : 300,
            "y" : 1940,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "HGK9eDi5lR64IPFIHf-9C$$KLs3dfIuamCB0BRer6NGD",
              "slug" : "pr",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "DATE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PATIENT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ENCOUNTER",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "COST",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "REASONCODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "REASONDESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "r64WzFV2gxzb6E9x_8GvE$$3k1wzZYumle2o-ptbnNth",
              "slug" : "srctostdvm",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "SOURCE_CODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CODE_DESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VALID_START_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VALID_END_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_NAME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_STANDARD_CONCEPT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "hV344T4n936UgcbA5Bk1B$$-6kOzaDINcFZrh3wVutiP",
              "slug" : "srctosrcvm",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "SOURCE_CODE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CODE_DESCRIPTION",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VALID_START_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_VALID_END_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "SOURCE_INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_NAME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_VOCABULARY_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_DOMAIN_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_CONCEPT_CLASS_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_INVALID_REASON",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "TARGET_STANDARD_CONCEPT",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "m_Xv-1Y45q-jev6daFObl$$29T1d0Si5xsQTSoiWIP9-",
              "slug" : "fv",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "encounter_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID_NEW",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "_lm1wFM1pklotIYq0-G_b$$TkeZVsMqCCWJCQIamc-w4",
              "slug" : "p",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "person_id",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "gender_concept_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "YEAR_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "MONTH_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "DAY_OF_BIRTH",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "BIRTH_DATETIME",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "LOCATION_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROVIDER_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "CARE_SITE_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PERSON_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "GENDER_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "RACE_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ETHNICITY_SOURCE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "zte_C6W7FRQ6XynO8S_I-$$QrIFmtx0T8gKsy92uRiZF",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "conditions" : [ {
              "alias" : "srctostdvm",
              "expression" : {
                "format" : "sql",
                "expression" : "srctostdvm.SOURCE_CODE = pr.CODE\nAND srctostdvm.TARGET_DOMAIN_ID = 'Procedure'\nAND srctostdvm.SOURCE_VOCABULARY_ID = 'SNOMED'\nAND srctostdvm.TARGET_STANDARD_CONCEPT = 'S'\nAND (srctostdvm.TARGET_INVALID_REASON IS NULL OR srctostdvm.TARGET_INVALID_REASON = '')"
              },
              "joinType" : "inner"
            }, {
              "alias" : "srctosrcvm",
              "expression" : {
                "format" : "sql",
                "expression" : "srctosrcvm.SOURCE_CODE = pr.CODE\nAND srctosrcvm.SOURCE_VOCABULARY_ID = 'SNOMED'"
              },
              "joinType" : "left_outer"
            }, {
              "alias" : "fv",
              "expression" : {
                "format" : "sql",
                "expression" : "fv.encounter_id = pr.ENCOUNTER"
              },
              "joinType" : "left_outer"
            }, {
              "alias" : "p",
              "expression" : {
                "format" : "sql",
                "expression" : "p.PERSON_SOURCE_VALUE = pr.PATIENT"
              },
              "joinType" : "inner"
            } ],
            "expressions" : [ {
              "_row_id" : "c_186",
              "target" : "PROCEDURE_OCCURRENCE_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "row_number() OVER (PARTITION BY 1 ORDER BY p.person_id)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_187",
              "target" : "PERSON_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "p.person_id"
              },
              "description" : ""
            }, {
              "_row_id" : "c_188",
              "target" : "PROCEDURE_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "coalesce(srctostdvm.TARGET_CONCEPT_ID, 0)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_189",
              "target" : "PROCEDURE_DATE",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(pr.DATE as date)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_190",
              "target" : "PROCEDURE_DATETIME",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(pr.DATE as timestamp)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_191",
              "target" : "PROCEDURE_TYPE_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "38000275"
              },
              "description" : ""
            }, {
              "_row_id" : "c_192",
              "target" : "MODIFIER_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "_row_id" : "c_193",
              "target" : "QUANTITY",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(null as integer)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_194",
              "target" : "PROVIDER_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "_row_id" : "c_195",
              "target" : "VISIT_OCCURRENCE_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "fv.VISIT_OCCURRENCE_ID_NEW"
              },
              "description" : ""
            }, {
              "_row_id" : "c_196",
              "target" : "VISIT_DETAIL_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "0"
              },
              "description" : ""
            }, {
              "_row_id" : "c_197",
              "target" : "PROCEDURE_SOURCE_VALUE",
              "expression" : {
                "format" : "sql",
                "expression" : "pr.CODE"
              },
              "description" : ""
            }, {
              "_row_id" : "c_198",
              "target" : "PROCEDURE_SOURCE_CONCEPT_ID",
              "expression" : {
                "format" : "sql",
                "expression" : "coalesce(srctosrcvm.SOURCE_CONCEPT_ID, 0)"
              },
              "description" : ""
            }, {
              "_row_id" : "c_199",
              "target" : "MODIFIER_SOURCE_VALUE",
              "expression" : {
                "format" : "sql",
                "expression" : "cast(null as string)"
              },
              "description" : ""
            } ],
            "hints" : [ {
              "id" : "HGK9eDi5lR64IPFIHf-9C$$KLs3dfIuamCB0BRer6NGD",
              "alias" : "pr",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "r64WzFV2gxzb6E9x_8GvE$$3k1wzZYumle2o-ptbnNth",
              "alias" : "srctostdvm",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "hV344T4n936UgcbA5Bk1B$$-6kOzaDINcFZrh3wVutiP",
              "alias" : "srctosrcvm",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "m_Xv-1Y45q-jev6daFObl$$29T1d0Si5xsQTSoiWIP9-",
              "alias" : "fv",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "_lm1wFM1pklotIYq0-G_b$$TkeZVsMqCCWJCQIamc-w4",
              "alias" : "p",
              "hintType" : "none",
              "propagateColumns" : false
            } ],
            "allIn1" : null,
            "activeTab" : "expressions",
            "columnsSelector" : [ "hV344T4n936UgcbA5Bk1B$$-6kOzaDINcFZrh3wVutiP##SOURCE_VOCABULARY_ID", "hV344T4n936UgcbA5Bk1B$$-6kOzaDINcFZrh3wVutiP##SOURCE_CODE", "HGK9eDi5lR64IPFIHf-9C$$KLs3dfIuamCB0BRer6NGD##CODE", "r64WzFV2gxzb6E9x_8GvE$$3k1wzZYumle2o-ptbnNth##SOURCE_VOCABULARY_ID", "HGK9eDi5lR64IPFIHf-9C$$KLs3dfIuamCB0BRer6NGD##ENCOUNTER", "r64WzFV2gxzb6E9x_8GvE$$3k1wzZYumle2o-ptbnNth##SOURCE_CODE", "HGK9eDi5lR64IPFIHf-9C$$KLs3dfIuamCB0BRer6NGD##PATIENT", "_lm1wFM1pklotIYq0-G_b$$TkeZVsMqCCWJCQIamc-w4##PERSON_SOURCE_VALUE", "r64WzFV2gxzb6E9x_8GvE$$3k1wzZYumle2o-ptbnNth##TARGET_STANDARD_CONCEPT", "m_Xv-1Y45q-jev6daFObl$$29T1d0Si5xsQTSoiWIP9-##encounter_id", "r64WzFV2gxzb6E9x_8GvE$$3k1wzZYumle2o-ptbnNth##TARGET_INVALID_REASON", "r64WzFV2gxzb6E9x_8GvE$$3k1wzZYumle2o-ptbnNth##TARGET_DOMAIN_ID", "m_Xv-1Y45q-jev6daFObl$$29T1d0Si5xsQTSoiWIP9-##VISIT_OCCURRENCE_ID_NEW", "HGK9eDi5lR64IPFIHf-9C$$KLs3dfIuamCB0BRer6NGD##DATE", "HGK9eDi5lR64IPFIHf-9C$$KLs3dfIuamCB0BRer6NGD##CODE", "hV344T4n936UgcbA5Bk1B$$-6kOzaDINcFZrh3wVutiP##SOURCE_CONCEPT_ID", "_lm1wFM1pklotIYq0-G_b$$TkeZVsMqCCWJCQIamc-w4##person_id", "r64WzFV2gxzb6E9x_8GvE$$3k1wzZYumle2o-ptbnNth##TARGET_CONCEPT_ID" ],
            "allIn0" : null,
            "whereClause" : null,
            "headAlias" : "pr"
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.34&projectSubscriptionProjectId=12654&path=gems/Join",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "Ml66k8izucSxRp8UZazf9$$Uy2DY2ZI1d1oSbokZQIUQ" : {
          "id" : "Ml66k8izucSxRp8UZazf9$$Uy2DY2ZI1d1oSbokZQIUQ",
          "component" : "Target",
          "metadata" : {
            "label" : "procedure_occurence",
            "slug" : "procedure_occurence",
            "x" : 500,
            "y" : 1960,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "ScC26xX1mvdtWXkBrvKl6$$xGnApjVGwXh-VDAXTCzSk",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "PROCEDURE_OCCURRENCE_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PERSON_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROCEDURE_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROCEDURE_DATE",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROCEDURE_DATETIME",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROCEDURE_TYPE_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "MODIFIER_CONCEPT_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "QUANTITY",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROVIDER_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_OCCURRENCE_ID",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "VISIT_DETAIL_ID",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROCEDURE_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "PROCEDURE_SOURCE_CONCEPT_ID",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "MODIFIER_SOURCE_VALUE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/procedure_occurence"
          }
        },
        "yjCie8elAQuan1r-jRbm0$$y0APlh2-XTFOkaEFKMfVl" : {
          "id" : "yjCie8elAQuan1r-jRbm0$$y0APlh2-XTFOkaEFKMfVl",
          "component" : "Source",
          "metadata" : {
            "label" : "final_visit_ids_4",
            "slug" : "final_visit_ids_4",
            "x" : 0,
            "y" : 2040,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "uW_JO62di6J1HAm_zXgMh$$73PL8Y01eVNY1hEtrdNOl",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/final_visit_ids"
          }
        },
        "XgV_zuzT_Oyu7OT4sZDQe$$RSO1wCcsDy-gUFWFTpQtH" : {
          "id" : "XgV_zuzT_Oyu7OT4sZDQe$$RSO1wCcsDy-gUFWFTpQtH",
          "component" : "Source",
          "metadata" : {
            "label" : "source_to_standard_vocab_map_5",
            "slug" : "source_to_standard_vocab_map_5",
            "x" : 0,
            "y" : 1740,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "AQbVOTo8KHX9ReWlRQQtH$$28VDKhemJ8bDrcrdh5JYT",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/source_to_standard_vocab_map"
          }
        },
        "9pFet-WRlWkm1Upn1rKhP$$zA1VKBkLDX2Flv_TC3cx4" : {
          "id" : "9pFet-WRlWkm1Upn1rKhP$$zA1VKBkLDX2Flv_TC3cx4",
          "component" : "Source",
          "metadata" : {
            "label" : "source_to_source_vocab_map_1",
            "slug" : "source_to_source_vocab_map_1",
            "x" : 0,
            "y" : 1880,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "JzHbQTNvAOt3V3zvYHTsd$$iwZ5Fag9Nn7SzFEfyPcQR",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/source_to_source_vocab_map"
          }
        },
        "e4kjOeMKQpTDWg6gq2lVp$$ZpTWgbiwGq3Yro3DiTS3g" : {
          "id" : "e4kjOeMKQpTDWg6gq2lVp$$ZpTWgbiwGq3Yro3DiTS3g",
          "component" : "Source",
          "metadata" : {
            "label" : "procedures",
            "slug" : "procedures",
            "x" : 0,
            "y" : 1600,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "s4CniTeGJLdCrbzjIwsiG$$BAWleUra_gD8ZSb6hobew",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/l0_bronze_layer_procedures"
          }
        }
      }
    }
  },
  "ports" : {
    "inputs" : [ ],
    "outputs" : [ ],
    "selectedInputFields" : [ ],
    "isCustomOutputSchema" : false,
    "autoUpdateOnRun" : false
  }
}